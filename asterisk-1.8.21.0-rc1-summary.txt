                                Release Summary

                             asterisk-1.8.21.0-rc1

                                Date: 2013-01-30

                           <asteriskteam@digium.com>

     ----------------------------------------------------------------------

                               Table of Contents

    1. Summary
    2. Contributors
    3. Closed Issues
    4. Other Changes
    5. Diffstat

     ----------------------------------------------------------------------

                                    Summary

                                 [Back to Top]

   This release includes only bug fixes. The changes included were made only
   to address problems that have been identified in this release series.
   Users should be able to safely upgrade to this version if this release
   series is already in use. Users considering upgrading from a previous
   release series are strongly encouraged to review the UPGRADE.txt document
   as well as the CHANGES document for information about upgrading to this
   release series.

   The data in this summary reflects changes that have been made since the
   previous release, asterisk-1.8.20.0.

     ----------------------------------------------------------------------

                                  Contributors

                                 [Back to Top]

   This table lists the people who have submitted code, those that have
   tested patches, as well as those that reported issues on the issue tracker
   that were resolved in this release. For coders, the number is how many of
   their patches (of any size) were committed into this release. For testers,
   the number is the number of times their name was listed as assisting with
   testing a patch. Finally, for reporters, the number is the number of
   issues that they reported that were closed by commits that went into this
   release.

     Coders                   Testers                  Reporters              
   23 rmudgett              3 elguero                2 dkerr                  
   8 mjordan                2 Deepak Lohani          2 jbigelow               
   6 kmoore                 2 Jonas Falck            1 bklang                 
   4 dlee                   2 Kayode                 1 bootc                  
   3 elguero                2 mjordan                1 brhunt                 
   3 mmichelson             2 rmudgett               1 call                   
   2 dkerr                  2 Thomas Sevestre        1 challado               
   2 igorg                  1 Alexander Heinz        1 chesse                 
   2 jonax                  1 benjamin               1 coreyfarrell           
   2 jrose                  1 Bryan Hunt             1 eelcob                 
   2 roeften                1 call                   1 erichill               
   1 bootc                  1 Chris Warr             1 jhirsch                
   1 Christian Hesse        1 Christian Hesse        1 jmce                   
   1 Corey Farrell          1 Danny Nicholas         1 jmillan                
   1 Eelco Brolman          1 David van Geyn         1 joel_vandal            
   1 Eric Hill              1 eliafino               1 kmoore                 
   1 Jakob Hirsch           1 Eric Hill              1 lexus350               
   1 jcolp                  1 Jamuel Starkey         1 menschentier           
   1 lathama                1 Joel Vandal            1 ovi                    
   1 newtonr                1 kaldemar               1 rmudgett               
   1 Nikolay Ilduganov      1 Nikolay Ilduganov      1 roeften                
   1 qwell                                           1 rudolfasd              
   1 russell                                         1 saghul                 
   1 seanbright                                      1 snuffy                 
   1 snuffy                                          1 srt                    
   1 Stefan Reuter                                   1 t-o                    
   1 Thomas Omerzu                                   1 thomas987              
   1 wdoekes                                         1 tootai                 
                                                     1 wcselby                
                                                     1 xhienne                

     ----------------------------------------------------------------------

                                 Closed Issues

                                 [Back to Top]

   This is a list of all issues from the issue tracker that were closed by
   changes that went into this release.

  Category: Addons/chan_mobile

   ASTERISK-16357: chan_mobile unable to connect to cellphone
   Revision: 379342
   Reporter: challado
   Testers: Alexander Heinz, Nikolay Ilduganov, benjamin, eliafino, David van
   Geyn
   Coders: Nikolay Ilduganov

   ASTERISK-16822: Channel Variable SMSSRC not set properly
   Revision: 379178
   Reporter: menschentier
   Testers: Jonas Falck
   Coders: jonax, roeften

   ASTERISK-19153: [patch] - Sms sender is not parsed correctly in incoming
   sms
   Revision: 379178
   Reporter: roeften
   Testers: Jonas Falck
   Coders: jonax, roeften

  Category: Applications/SLA

   ASTERISK-20440: [patch] No ringback towards SLAstation on outbound trunk
   call.
   Revision: 379825
   Reporter: dkerr
   Coders: dkerr

   ASTERISK-20462: [patch] Trunk not hungup if SLA Station hangs up before
   answer
   Revision: 379825
   Reporter: dkerr
   Coders: dkerr

  Category: Applications/app_confbridge

   ASTERISK-16640: ConfBridge crashes when leave simultaneously
   Revision: 379091
   Reporter: thomas987
   Coders: mjordan

  Category: Applications/app_meetme

   ASTERISK-20440: [patch] No ringback towards SLAstation on outbound trunk
   call.
   Revision: 379825
   Reporter: dkerr
   Coders: dkerr

   ASTERISK-20462: [patch] Trunk not hungup if SLA Station hangs up before
   answer
   Revision: 379825
   Reporter: dkerr
   Coders: dkerr

  Category: Applications/app_minivm

   ASTERISK-18697: [minivm] Crash in MinivmNotify
   Revision: 379608
   Reporter: bootc
   Testers: Chris Warr
   Coders: bootc

  Category: Applications/app_queue

   ASTERISK-20743: Queue Log - All Calls End With COMPLETECALLER When h
   Extension Is Present
   Revision: 378514
   Reporter: call
   Testers: call, elguero
   Coders: elguero

   ASTERISK-20801: Non-SIP queue members get no calls when ringinuse=no.
   Revision: 378036
   Reporter: rmudgett
   Coders: rmudgett

  Category: Bridges/Softmix

   ASTERISK-16640: ConfBridge crashes when leave simultaneously
   Revision: 379091
   Reporter: thomas987
   Coders: mjordan

   ASTERISK-16835: Segfault when shutting down and ongoing traffic to
   ConfBridge application
   Revision: 379091
   Reporter: saghul
   Coders: mjordan

  Category: Channels/chan_misdn

   ASTERISK-15456: [patch] chan_misdn does not set INVALID_EXTEN
   Revision: 379145
   Reporter: t-o
   Coders: Thomas Omerzu

  Category: Channels/chan_sip/General

   ASTERISK-20653: Asterisk allows Session-Expires below 90 in a 200 OK
   Revision: 377623
   Reporter: kmoore
   Coders: kmoore

   ASTERISK-20805: SIP Notify message has incorrect IP address in FROM field
   Revision: 378554
   Reporter: brhunt
   Testers: Bryan Hunt, elguero
   Coders: elguero

  Category: Channels/chan_sip/Interoperability

   ASTERISK-20837: [patch] build_route fails to parse Record-Route headers
   longer than 255 characters
   Revision: 379392
   Reporter: coreyfarrell
   Coders: Corey Farrell

  Category: Channels/chan_sip/SRTP

   ASTERISK-20499: Crash in libsrtp srtp_unprotect_rtcp when SIP channel is
   bridged with non-optimizing Local channel
   Revision: 378591
   Reporter: tootai
   Coders: jrose

   ASTERISK-20849: SDP crypto attribute is not well formed in the SDP ANSWER
   Revision: 380347
   Reporter: jmillan
   Coders: dlee

  Category: Channels/chan_sip/T.38

   ASTERISK-20897: case sensitive match against T.38 params causes
   T38MaxBitRate to be negotiated at 2400 baud instead of 14400
   Revision: 380458
   Reporter: erichill
   Testers: Eric Hill
   Coders: Eric Hill

  Category: Channels/chan_unistim

   ASTERISK-20417: Nortel transfer problem
   Revision: 377557
   Reporter: rudolfasd
   Coders: igorg

  Category: Codecs/codec_ilbc

   ASTERISK-20914: Segfault when iLBC voice frame is interpolated in a jitter
   buffer due to codec_ilbc's improper manipulation of datalen
   Revision: 379718
   Reporter: jmce
   Coders: mjordan

  Category: Core/BuildSystem

   ASTERISK-20980: [patch] ./configure fails with ptlib 2.10.9
   Revision: 380297
   Reporter: srt
   Coders: Stefan Reuter

   ASTERISK-21006: unsupported host os "linux-gnueabihf"
   Revision: 380520
   Reporter: chesse
   Testers: Christian Hesse
   Coders: Christian Hesse

  Category: Core/Channels

   ASTERISK-18975: Manager Redirect action on bridged channel pair causes
   intermittent hangup on second channel
   Revision: 378356
   Reporter: bklang
   Testers: rmudgett, Thomas Sevestre, Deepak Lohani, Kayode
   Coders: rmudgett

  Category: Core/General

   ASTERISK-16835: Segfault when shutting down and ongoing traffic to
   ConfBridge application
   Revision: 379091
   Reporter: saghul
   Coders: mjordan

   ASTERISK-20826: Replace last few tabs with spaces in causes.h
   Revision: 378733
   Reporter: snuffy
   Coders: snuffy

   ASTERISK-20945: "Unable to connect to remote asterisk" message on service
   asterisk start, even though service is running
   Revision: 379760
   Reporter: wcselby
   Testers: elguero, Jamuel Starkey, kaldemar, Danny Nicholas, mjordan
   Coders: elguero, mjordan

  Category: Core/Jitterbuffer

   ASTERISK-20914: Segfault when iLBC voice frame is interpolated in a jitter
   buffer due to codec_ilbc's improper manipulation of datalen
   Revision: 379718
   Reporter: jmce
   Coders: mjordan

  Category: Core/ManagerInterface

   ASTERISK-19948: Asterisk 1.8 manager redirect command fails when
   redirecting multiple channels currently bridged together via dial command.
   Revision: 378356
   Reporter: lexus350
   Testers: rmudgett, Thomas Sevestre, Deepak Lohani, Kayode
   Coders: rmudgett

  Category: Core/Portability

   ASTERISK-16854: [patch] roundf causing asterisk to fail to compile
   Revision: 379547
   Reporter: ovi
   Coders: wdoekes

  Category: Core/RTP

   ASTERISK-20772: Loop bug in ast_rtp_lookup_mime_multiple2()
   [main/rtp_engine.c]
   Revision: 378776
   Reporter: xhienne
   Coders: dlee

  Category: Resources/res_calendar_icalendar

   ASTERISK-21012: Memory Leak on res_calendar (icalendar)
   Revision: 380451
   Reporter: joel_vandal
   Testers: Joel Vandal
   Coders: mjordan

  Category: Resources/res_rtp_asterisk

   ASTERISK-20906: DTMF in SIP not working after HOLD / UNHOLD
   Revision: 378967
   Reporter: eelcob
   Coders: Eelco Brolman

  Category: Utilities/astcanary

   ASTERISK-20947: astcanary exits immediately because of wrong pid argument
   Revision: 379509
   Reporter: jhirsch
   Testers: mjordan
   Coders: Jakob Hirsch

     ----------------------------------------------------------------------

                      Commits Not Associated with an Issue

                                 [Back to Top]

   This is a list of all changes that went into this release that did not
   directly close an issue from the issue tracker. The commits may have been
   marked as being related to an issue. If that is the case, the issue
   numbers are listed here, as well.

   +------------------------------------------------------------------------+
   | Revision | Author     | Summary                       | Issues         |
   |          |            |                               | Referenced     |
   |----------+------------+-------------------------------+----------------|
   | 377591   | igorg      | Fix codec mismatch            | ASTERISK-20183 |
   |----------+------------+-------------------------------+----------------|
   | 377655   | kmoore     | Ensure ReceiveFax provides a  |                |
   |          |            | CED tone via T.38             |                |
   |----------+------------+-------------------------------+----------------|
   | 377688   | rmudgett   | Cleanup astdb on exit.        | ASTERISK-20649 |
   |----------+------------+-------------------------------+----------------|
   | 377704   | rmudgett   | Cleanup dnsmgr on exit.       | ASTERISK-20649 |
   |----------+------------+-------------------------------+----------------|
   | 377708   | rmudgett   | Cleanup event on exit.        | ASTERISK-20649 |
   |----------+------------+-------------------------------+----------------|
   | 377712   | rmudgett   | Cleanup frame on exit.        | ASTERISK-20649 |
   |----------+------------+-------------------------------+----------------|
   | 377740   | rmudgett   | Cleanup indications on exit.  | ASTERISK-20649 |
   |----------+------------+-------------------------------+----------------|
   | 377771   | rmudgett   | Cleanup logger on exit.       | ASTERISK-20649 |
   |----------+------------+-------------------------------+----------------|
   | 377806   | rmudgett   | Cleanup pbx on exit.          | ASTERISK-20649 |
   |----------+------------+-------------------------------+----------------|
   | 377837   | rmudgett   | Cleanup taskprocessor on      | ASTERISK-20649 |
   |          |            | exit.                         |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Fix crash that can occur if   |                |
   | 377840   | mmichelson | CLI registration fails for an |                |
   |          |            | aliased command.              |                |
   |----------+------------+-------------------------------+----------------|
   | 377847   | rmudgett   | Cleanup udptl on exit.        | ASTERISK-20649 |
   |----------+------------+-------------------------------+----------------|
   | 377881   | rmudgett   | Cleanup CLI commands on exit  | ASTERISK-20649 |
   |          |            | for several files.            |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Incremented                   |                |
   | 377922   | newtonr    | EXTRA_SOUNDS_VERSION in       |                |
   |          |            | sounds/Makefile to 1.4.12 for |                |
   |          |            | new Extra Sounds releases     |                |
   |----------+------------+-------------------------------+----------------|
   | 377946   | kmoore     | Ensure Min-SE is included in  |                |
   |          |            | outbound INVITEs              |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Make chan_local module        |                |
   | 378088   | rmudgett   | references tied to local_pvt  |                |
   |          |            | lifetime.                     |                |
   |----------+------------+-------------------------------+----------------|
   | 378092   | rmudgett   | Fix potential double free     |                |
   |          |            | when unloading a module.      |                |
   |----------+------------+-------------------------------+----------------|
   | 378119   | kmoore     | Add test events for time      |                |
   |          |            | limit-related hangups         |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Adjust RTP instance's         |                |
   | 378147   | mmichelson | available_formats callback to |                |
   |          |            | return the correct type.      |                |
   |----------+------------+-------------------------------+----------------|
   | 378164   | rmudgett   | Give the causes[] a struct    |                |
   |          |            | name.                         |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Ensure chan_sip rejects       |                |
   | 378217   | kmoore     | encrypted streams without     |                |
   |          |            | crypto info                   |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Resolve crashes due to large  |                |
   | 378269   | mjordan    | stack allocations when using  | ASTERISK-20658 |
   |          |            | TCP                           |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Prevent exhaustion of system  |                |
   | 378303   | mjordan    | resources through             | ASTERISK-20175 |
   |          |            | exploitation of event cache   |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Prevent crashes from          |                |
   | 378375   | mjordan    | occurring when reading from   | ASTERISK-20658 |
   |          |            | data sources with large       |                |
   |          |            | values                        |                |
   |----------+------------+-------------------------------+----------------|
   | 378427   | rmudgett   | chan_agent: Fix               |                |
   |          |            | agent_indicate() locking.     |                |
   |----------+------------+-------------------------------+----------------|
   | 378455   | kmoore     | Add missing test event        |                |
   |----------+------------+-------------------------------+----------------|
   | 378456   | rmudgett   | chan_agent: Misc code         |                |
   |          |            | cleanup.                      |                |
   |----------+------------+-------------------------------+----------------|
   | 378486   | rmudgett   | chan_agent: Fix wrapup time   |                |
   |          |            | wait response.                |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | app_queue: Fix multiple calls |                |
   | 378663   | rmudgett   | to a queue member that is in  | ASTERISK-16115 |
   |          |            | only one queue.               |                |
   |----------+------------+-------------------------------+----------------|
   | 378933   | dlee       | Fix XML encoding of 'identity |                |
   |          |            | display' in NOTIFY messages.  |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Fix XML encoding of 'identity |                |
   | 379001   | dlee       | display' in NOTIFY messages,  |                |
   |          |            | continued.                    |                |
   |----------+------------+-------------------------------+----------------|
   | 379226   | rmudgett   | chan_misdn: Fix compile       | ASTERISK-15456 |
   |          |            | error.                        |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Reduce number of packages     |                |
   | 379276   | qwell      | install_prereq installs on    |                |
   |          |            | Debian systems.               |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Further fix misinformation in |                |
   | 379310   | mmichelson | the description of manager    |                |
   |          |            | MailboxStatus command.        |                |
   |----------+------------+-------------------------------+----------------|
   | 379645   | lathama    | Add LDAP libraries to install | ASTERISK-20886 |
   |          |            | script                        |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Attempt to be more helpful    |                |
   | 379963   | rmudgett   | when using a bad ao2 object   |                |
   |          |            | pointer.                      |                |
   |----------+------------+-------------------------------+----------------|
   | 380210   | russell    | Change cleanup ordering in    |                |
   |          |            | filestream destructor.        |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | Correct the number of         |                |
   | 380254   | seanbright | available call numbers in     |                |
   |          |            | IAX2.                         |                |
   |----------+------------+-------------------------------+----------------|
   |          |            | chan_agent: Prevent multiple  |                |
   | 380364   | rmudgett   | channels from logging in as   |                |
   |          |            | the same agent.               |                |
   +------------------------------------------------------------------------+

     ----------------------------------------------------------------------

                                Diffstat Results

                                 [Back to Top]

   This is a summary of the changes to the source code that went into this
   release that was generated using the diffstat utility.

 UPGRADE.txt                           |   10
 addons/chan_mobile.c                  |    3
 apps/app_confbridge.c                 |    4
 apps/app_meetme.c                     |  821 +++++++++++++++++++---------------
 apps/app_minivm.c                     |    1
 apps/app_queue.c                      |  187 +++++--
 autoconf/ast_check_pwlib.m4           |    2
 bridges/bridge_softmix.c              |    5
 channels/chan_agent.c                 |  480 ++++++++-----------
 channels/chan_dahdi.c                 |    7
 channels/chan_iax2.c                  |   41 -
 channels/chan_local.c                 |   43 +
 channels/chan_misdn.c                 |    3
 channels/chan_sip.c                   |  264 ++++++++--
 channels/chan_skinny.c                |   16
 channels/chan_unistim.c               |   22
 channels/iax2.h                       |    8
 channels/sip/include/reqresp_parser.h |   11
 channels/sip/include/sip.h            |    1
 channels/sip/reqresp_parser.c         |   53 ++
 channels/sip/sdp_crypto.c             |   28 -
 codecs/codec_ilbc.c                   |   16
 configure.ac                          |    4
 contrib/init.d/rc.archlinux.asterisk  |    2
 contrib/init.d/rc.debian.asterisk     |    2
 contrib/init.d/rc.gentoo.asterisk     |    2
 contrib/init.d/rc.mandriva.asterisk   |    2
 contrib/init.d/rc.redhat.asterisk     |    2
 contrib/init.d/rc.slackware.asterisk  |    2
 contrib/init.d/rc.suse.asterisk       |    2
 contrib/scripts/install_prereq        |   10
 contrib/scripts/safe_asterisk         |    2
 funcs/func_devstate.c                 |    6
 funcs/func_realtime.c                 |   17
 include/asterisk/autoconfig.h.in      |   16
 include/asterisk/causes.h             |   10
 include/asterisk/channel.h            |   13
 include/asterisk/compat.h             |    8
 include/asterisk/devicestate.h        |   16
 include/asterisk/event_defs.h         |    8
 include/asterisk/rtp_engine.h         |    2
 include/asterisk/utils.h              |   20
 main/aoc.c                            |    5
 main/asterisk.c                       |    7
 main/astobj2.c                        |   13
 main/cel.c                            |    1
 main/channel.c                        |   17
 main/config.c                         |   11
 main/data.c                           |    2
 main/db.c                             |   65 ++
 main/devicestate.c                    |   51 +-
 main/dnsmgr.c                         |   23
 main/event.c                          |    3
 main/features.c                       |    7
 main/file.c                           |   21
 main/frame.c                          |    6
 main/http.c                           |   26 -
 main/image.c                          |    6
 main/indications.c                    |   15
 main/loader.c                         |   28 -
 main/logger.c                         |   12
 main/manager.c                        |  141 ++++-
 main/pbx.c                            |   22
 main/rtp_engine.c                     |    2
 main/strcompat.c                      |   16
 main/stun.c                           |    6
 main/taskprocessor.c                  |    2
 main/timing.c                         |   10
 main/udptl.c                          |   14
 main/utils.c                          |   63 ++
 res/res_calendar.c                    |    8
 res/res_calendar_icalendar.c          |    5
 res/res_clialiases.c                  |    5
 res/res_fax.c                         |    3
 res/res_jabber.c                      |   66 +-
 res/res_rtp_asterisk.c                |    6
 res/res_srtp.c                        |   15
 sounds/Makefile                       |    4
 tests/test_xml_escape.c               |  118 ++++
 79 files changed, 2002 insertions(+), 995 deletions(-)

     ----------------------------------------------------------------------
