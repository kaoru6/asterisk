2008-10-03 - Russell Bryant <russell@digium.com>

	* Asterisk 1.6.1-beta1 Released

2008-10-02 19:31 +0000 [r145960-145964]  Russell Bryant <russell@digium.com>

	* CHANGES, /: Merged revisions 145962 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r145962 |
	  russell | 2008-10-02 14:30:45 -0500 (Thu, 02 Oct 2008) | 2 lines
	  The 'P' command for ExternalIVR was also added in 1.6.0 ........

	* CHANGES, /: Merged revisions 145959 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r145959 |
	  russell | 2008-10-02 14:27:37 -0500 (Thu, 02 Oct 2008) | 2 lines
	  TCP support for ExternalIVR went in to 1.6.1, not 1.6.0 ........

2008-10-02 15:30 +0000 [r145781]  Sean Bright <sean.bright@gmail.com>

	* /, configure, configure.ac: Merged revisions 145771 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r145771 | seanbright | 2008-10-02 11:28:48 -0400 (Thu, 02 Oct
	  2008) | 1 line This is much cleaner, methinks. ........

2008-10-02 15:19 +0000 [r145754]  Tilghman Lesher <tlesher@digium.com>

	* res/res_odbc.c, /: Merged revisions 145752 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r145752 | tilghman | 2008-10-02 10:17:16 -0500 (Thu, 02 Oct 2008)
	  | 10 lines Merged revisions 145751 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r145751 | tilghman | 2008-10-02 10:13:21 -0500 (Thu, 02 Oct 2008)
	  | 3 lines Some sanity checks that may have led to prior crashes,
	  found by codefreeze-lap (murf) on IRC. Also some cleanup of
	  incorrectly-used constants. ........ ................

2008-10-01 23:54 +0000 [r145694]  Sean Bright <sean.bright@gmail.com>

	* /, configure, configure.ac: Merged revisions 145692 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r145692 | seanbright | 2008-10-01 19:48:16 -0400 (Wed, 01 Oct
	  2008) | 7 lines Try a test compile using the GMime library. Some
	  distros install gmime-config in the base package instead of the
	  -devel package. Now we print a notice and disable GMime support
	  instead of bombing during the main compilation. (closes issue
	  #13583) Reported by: arkadia ........

2008-10-01 22:24 +0000 [r145557-145609]  Mark Michelson <mmichelson@digium.com>

	* /, main/features.c: Merged revisions 145606 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r145606 |
	  mmichelson | 2008-10-01 17:23:50 -0500 (Wed, 01 Oct 2008) | 11
	  lines Okay, this should really do it now. While I did manage to
	  fix blind transfers with my last commit here, I also caused an
	  unwanted side-effect. That is, only the first priority of the 'h'
	  extension would be executed when a blind transfer occurred
	  instead of all priorities. Essentially, my last commit corrected
	  the return value of ast_bridge_call. However, the implementation
	  still was not 100% correct. Now it is. ........

	* /, main/features.c: Merged revisions 145579 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r145579 |
	  mmichelson | 2008-10-01 16:33:11 -0500 (Wed, 01 Oct 2008) | 4
	  lines if (!(x) == 0) is the same as if (x). ........

	* /, main/features.c: Merged revisions 145553 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r145553 |
	  mmichelson | 2008-10-01 16:06:26 -0500 (Wed, 01 Oct 2008) | 13
	  lines The logic surrounding the return value of
	  ast_spawn_extension within ast_bridge_call was reversed. This
	  problem was observed when a blind transfer placed from the callee
	  channel of a test call failed. While the problem I am solving
	  here is exactly the same as what was reported in issue #13584,
	  the difference is that this fix I am applying is trunk-only.
	  Issue #13584 was reported against the 1.4 branch, and my tests of
	  1.4's blind transfers appear to work fine. ........

2008-10-01 17:33 +0000 [r145517]  Leif Madsen <lmadsen@digium.com>

	* contrib/scripts/realtime_pgsql.sql, /: Merged revisions 145487
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r145487 | lmadsen | 2008-10-01 13:26:20 -0400
	  (Wed, 01 Oct 2008) | 12 lines Merged revisions 145479 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r145479 | lmadsen | 2008-10-01 13:18:30 -0400 (Wed, 01 Oct 2008)
	  | 6 lines Update the realtime_pgsql.sql script to create the
	  setinterfacevar column. (closes issue #13549) Reported by: fiddur
	  ........ ................

2008-10-01 15:45 +0000 [r145430]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_sms.c: Merged revisions 145428 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r145428 |
	  tilghman | 2008-10-01 10:44:06 -0500 (Wed, 01 Oct 2008) | 7 lines
	  Initializing buffer prevents a segfault when arguments are
	  incomplete. (closes issue #13471) Reported by: alecdavis Patches:
	  20080916__bug13471.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: alecdavis ........

2008-09-30 22:26 +0000 [r145262]  Jeff Peeler <jpeeler@digium.com>

	* /, channels/chan_sip.c: Merged revisions 145249 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r145249 |
	  jpeeler | 2008-09-30 17:21:19 -0500 (Tue, 30 Sep 2008) | 6 lines
	  (closes issue #13337) Reported by: pj Tested by: pj Set transport
	  to SIP_TRANSPORT_UDP mode if not specified which fixes calls to
	  get_transport returning UNKNOWN. ........

2008-09-27 16:49 +0000 [r144993]  Kevin P. Fleming <kpfleming@digium.com>

	* main/ast_expr2.c, Makefile, agi/Makefile, utils/Makefile,
	  include/asterisk/astmm.h, main/ast_expr2f.c, pbx/pbx_ael.c,
	  utils/ael_main.c, main/astmm.c, main/stdtime/localtime.c,
	  utils/extconf.c, main/ast_expr2.fl, include/asterisk.h, /,
	  main/Makefile, main/ast_expr2.y, Makefile.moddir_rules,
	  utils/astman.c: Merged revisions 144949-144951 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r144949 | kpfleming | 2008-09-27 10:52:56 -0500 (Sat, 27 Sep
	  2008) | 17 lines Merged revisions 144924-144925 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r144924 | kpfleming | 2008-09-27 10:00:48 -0500 (Sat, 27 Sep
	  2008) | 6 lines improve header inclusion process in a few small
	  ways: - it is no longer necessary to forcibly include
	  asterisk/autoconfig.h; every module already includes asterisk.h
	  as its first header (even before system headers), which serves
	  the same purpose - astmm.h is now included by asterisk.h when
	  needed, instead of being forced by the Makefile; this means
	  external modules will build properly against installed headers
	  with MALLOC_DEBUG enabled - simplify the usage of some of these
	  headers in the AEL-related stuff in the utils directory ........
	  r144925 | kpfleming | 2008-09-27 10:13:30 -0500 (Sat, 27 Sep
	  2008) | 2 lines fix some minor issues with rev 144924 ........
	  ................ r144950 | kpfleming | 2008-09-27 11:10:33 -0500
	  (Sat, 27 Sep 2008) | 2 lines fix bugs caused by r144949 when
	  MALLOC_DEBUG is defined ................ r144951 | kpfleming |
	  2008-09-27 11:17:43 -0500 (Sat, 27 Sep 2008) | 1 line remove
	  incorrect comment ................

2008-09-27 01:08 +0000 [r144881]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_queue.c, channels/chan_dahdi.c, /: Merged revisions
	  144879 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r144879 |
	  mvanbaak | 2008-09-27 02:49:24 +0200 (Sat, 27 Sep 2008) | 2 lines
	  fix a couple of CLI commands that did not have a help
	  description. ........

2008-09-26 23:16 +0000 [r144832]  Joshua Colp <jcolp@digium.com>

	* /, configs/rtp.conf.sample: Merged revisions 144829 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r144829 | file | 2008-09-26 20:12:13 -0300 (Fri, 26 Sep 2008) | 2
	  lines Update documentation to include default setting. This is
	  for you jtodd! ........

2008-09-26 18:09 +0000 [r144484-144684]  Steve Murphy <murf@digium.com>

	* /, pbx/pbx_lua.c: Merged revisions 144681 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r144681 |
	  murf | 2008-09-26 12:02:06 -0600 (Fri, 26 Sep 2008) | 14 lines
	  (closes issue #13564) Reported by: mnicholson Patches:
	  pbx_lua9.diff uploaded by mnicholson (license 96) Many thanks to
	  Matt for his upgrade to the lua dialplan option! the Description
	  from the bug: This patch adds a stack trace to errors encountered
	  while executing lua extensions. The patch also handles out of
	  memory errors reported by lua. ........

	* main/pbx.c, /: Merged revisions 144678 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r144678 | murf | 2008-09-26 11:50:35 -0600 (Fri, 26 Sep 2008) |
	  20 lines Merged revisions 144677 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r144677 | murf | 2008-09-26 11:47:13 -0600 (Fri, 26 Sep 2008) |
	  12 lines (closes issue #13563) Reported by: mnicholson Patches:
	  found1.diff uploaded by mnicholson (license 96) This patch was
	  mainly meant to apply to trunk and 1.6.x, but I'm applying it to
	  1.4 also, which should be a perfectly harmless fix to the vast
	  majority of users who are not using external switches, but the
	  few who might be affected will not have to go to the pain of
	  filing a bug report. ........ ................

	* utils/build-extensions-conf.lua (removed), /: Merged revisions
	  144635 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r144635 |
	  murf | 2008-09-26 10:51:30 -0600 (Fri, 26 Sep 2008) | 1 line Matt
	  suggests we remove utils/build-extensions-conf.lua, as per bug
	  12961, it is no longer necessary. ........

	* channels/chan_oss.c, apps/app_playback.c, main/pbx.c, /,
	  funcs/func_cut.c: Merged revisions 144569 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r144569 |
	  murf | 2008-09-25 16:21:28 -0600 (Thu, 25 Sep 2008) | 14 lines
	  (closes issue #13557) Reported by: nickpeirson The user attached
	  a patch, but the license is not yet recorded. I took the liberty
	  of finding and replacing ALL index() calls with strchr() calls,
	  and that involves more than just main/pbx.c; chan_oss,
	  app_playback, func_cut also had calls to index(), and I changed
	  them out. 1.4 had no references to index() at all. ........

	* /, pbx/pbx_lua.c: Merged revisions 144563 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r144563 |
	  murf | 2008-09-25 15:54:11 -0600 (Thu, 25 Sep 2008) | 7 lines
	  (closes issue #13559) Reported by: mnicholson Patches:
	  pbx_lua8.diff uploaded by mnicholson (license 96) ........

	* include/asterisk/hashtab.h, /, pbx/pbx_lua.c,
	  configs/extensions.lua.sample: Merged revisions 144523 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r144523 | murf | 2008-09-25 15:18:12 -0600 (Thu, 25 Sep
	  2008) | 13 lines I added a little verbage to hashtab for the
	  hashtab_destroy func. It was pretty sparsely documented. This
	  update fleshes out the pbx_lua module, to add the switch
	  statements to the extensions in the extensions.lua file, as well
	  as removing them when the module is unloaded. Many thanks to Matt
	  Nicholson for his fine contribution! ........

	* /, pbx/pbx_lua.c: Merged revisions 144482 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r144482 |
	  murf | 2008-09-25 11:51:11 -0600 (Thu, 25 Sep 2008) | 14 lines
	  (closes issue #13558) Reported by: mnicholson Considering that
	  the example extensions.lua used nothing but ["12345"] notation,
	  and that the resulting error message: [Sep 24 17:01:16]
	  ERROR[12393]: pbx_lua.c:1204 exec: Error executing lua extension:
	  attempt to call a nil value is not very informative as to the
	  nature of the problem, I think this bug fix is a big win!
	  ........

2008-09-23 23:36 +0000 [r144151]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 144149 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r144149 |
	  mmichelson | 2008-09-23 18:33:33 -0500 (Tue, 23 Sep 2008) | 3
	  lines Fix a conflict in flag values ........

2008-09-23 17:00 +0000 [r144069]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 144067 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r144067 | murf | 2008-09-23 10:52:32 -0600 (Tue, 23 Sep 2008) |
	  37 lines Merged revisions 144066 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r144066 | murf | 2008-09-23 10:41:49 -0600 (Tue, 23 Sep 2008) |
	  29 lines (closes issue #13489) Reported by: DougUDI Tested by:
	  murf (closes issue #13490) Reported by: seanbright Tested by:
	  murf (closes issue #13467) Reported by: edantie Tested by: murf,
	  edantie, DougUDI This crash happens because we are unsafely
	  handling old pointers. The channel whose cdr is being handled,
	  has been hung up and destroyed already. I reorganized the code a
	  bit, and tried not to lose the fork-cdr-chain concepts of the
	  previous code. I now verify that the 'previous' channel (the
	  channel we had when the bridge was started), still exists, by
	  looking it up by name in the channel list. I also do not try to
	  reset the CDR's of channels involved in bridges. Testing shows it
	  solves the crash problem, and should not negatively impact
	  previous fixes involving CDR's generated during/after blind
	  transfers. (The reason we need to reset the CDR's on the
	  "beginning" channels in the first place). ........
	  ................

2008-09-23 15:39 +0000 [r144027]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 144025 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r144025 |
	  mmichelson | 2008-09-23 10:37:00 -0500 (Tue, 23 Sep 2008) | 16
	  lines When a promiscuous redirect contained both a user and host
	  portion in the Contact URI and specifies a transport, the parsing
	  done in parse_moved_contact resulted in a malformed URI. This
	  commit fixes the parsing so that a proper Dial string may be
	  formed when the forwarded call is placed. (closes issue #13523)
	  Reported by: mattdarnell Patches: 13523v2.patch uploaded by
	  putnopvut (license 60) Tested by: mattdarnell ........

2008-09-22 22:52 +0000 [r143906]  Sean Bright <sean.bright@gmail.com>

	* /, formats/format_pcm.c: Merged revisions 143904 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r143904 | seanbright | 2008-09-22 18:50:07 -0400
	  (Mon, 22 Sep 2008) | 16 lines Merged revisions 143903 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143903 | seanbright | 2008-09-22 18:49:00 -0400 (Mon, 22 Sep
	  2008) | 8 lines Use the advertised header size in .au files
	  instead of just assuming they are 24 bytes (the minimum). (closes
	  issue #13450) Reported by: jamessan Patches: pcm-header.diff
	  uploaded by jamessan (license 246) ........ ................

2008-09-21 10:06 +0000 [r143839-143845]  Michiel van Baak <michiel@vanbaak.info>

	* /, doc/tex/privacy.tex: Merged revisions 143843 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r143843 |
	  mvanbaak | 2008-09-21 11:53:01 +0200 (Sun, 21 Sep 2008) | 3 lines
	  fix privacymanager example so it shows how to use the
	  PRIVACYMRGSTATUS variable ........

	* /, doc/tex/privacy.tex: Merged revisions 143840 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r143840 |
	  mvanbaak | 2008-09-21 11:31:54 +0200 (Sun, 21 Sep 2008) | 3 lines
	  document the new context argument for privacymanager so people
	  can do pattern matching on the input ........

	* /, doc/tex/privacy.tex: Merged revisions 143837 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r143837 |
	  mvanbaak | 2008-09-21 11:27:08 +0200 (Sun, 21 Sep 2008) | 2 lines
	  fix privacy documentation. We no longer do priority jumping +101
	  ........

2008-09-20 00:55 +0000 [r143739]  Sean Bright <sean.bright@gmail.com>

	* /, contrib/scripts/vmail.cgi: Merged revisions 143737 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r143737 | seanbright | 2008-09-19 20:52:20 -0400
	  (Fri, 19 Sep 2008) | 17 lines Merged revisions 143736 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143736 | seanbright | 2008-09-19 20:50:10 -0400 (Fri, 19 Sep
	  2008) | 9 lines Make vmail.cgi work with mailboxes defined in
	  users.conf, too. (closes issue #13187) Reported by: netvoice
	  Patches: 20080911__bug13187.diff.txt uploaded by Corydon76
	  (license 14) (Slightly modified to take alchamist's comments on
	  mantis into account) Tested by: msales, alchamist, seanbright
	  ........ ................

2008-09-19 15:49 +0000 [r143611]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_agent.c: Merged revisions 143609 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r143609 | mmichelson | 2008-09-19 10:43:28 -0500 (Fri, 19 Sep
	  2008) | 11 lines We should only unsubscribe to the device state
	  event subscription if we have previously subscribed. Otherwise a
	  segfault will occur. (closes issue #13476) Reported by: jonnt
	  Patches: 13476.patch uploaded by putnopvut (license 60) Tested
	  by: jonnt ........

2008-09-18 23:55 +0000 [r143561]  Steve Murphy <murf@digium.com>

	* /, channels/chan_sip.c: Merged revisions 143559 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r143559 | murf | 2008-09-18 17:41:33 -0600 (Thu, 18 Sep 2008) | 9
	  lines Merged revisions 143534 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143534 | murf | 2008-09-18 16:11:51 -0600 (Thu, 18 Sep 2008) | 1
	  line A micro-fix, in sip_park_thread, where d is freed before the
	  func is done using it. ........ ................

2008-09-17 20:59 +0000 [r143407]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 143405 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r143405 | tilghman | 2008-09-17 15:57:58 -0500
	  (Wed, 17 Sep 2008) | 13 lines Merged revisions 143404 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143404 | tilghman | 2008-09-17 15:55:47 -0500 (Wed, 17 Sep 2008)
	  | 6 lines When callerid is blank, we want to use "unknown caller"
	  in those cases, too. (closes issue #13486) Reported by: tomo1657
	  Patches: 20080917__bug13486.diff.txt uploaded by Corydon76
	  (license 14) ........ ................

2008-09-17 18:30 +0000 [r143349]  Mark Michelson <mmichelson@digium.com>

	* main/rtp.c, /: Merged revisions 143340 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r143340 | mmichelson | 2008-09-17 13:26:35 -0500 (Wed, 17 Sep
	  2008) | 14 lines Merged revisions 143337 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143337 | mmichelson | 2008-09-17 13:24:15 -0500 (Wed, 17 Sep
	  2008) | 6 lines Allow for "G.729" if offered in an SDP even
	  though it is not RFC 3551 compliant. Some Cisco switches will
	  send this in an SDP, and it doesn't hurt to be able to accept
	  this. ........ ................

2008-09-15 21:33 +0000 [r143143]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 143141 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r143141 | tilghman | 2008-09-15 16:31:36 -0500
	  (Mon, 15 Sep 2008) | 13 lines Merged revisions 143140 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143140 | tilghman | 2008-09-15 16:29:32 -0500 (Mon, 15 Sep 2008)
	  | 6 lines Set the raw formats at the same time as the other
	  formats. (closes issue #13240) Reported by: jvandal Patches:
	  20080813__bug13240.diff.txt uploaded by Corydon76 (license 14)
	  ........ ................

2008-09-14 22:24 +0000 [r143086]  Michiel van Baak <michiel@vanbaak.info>

	* /, channels/chan_skinny.c: Merged revisions 143082 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r143082 | mvanbaak | 2008-09-15 00:16:34 +0200 (Mon, 15 Sep 2008)
	  | 11 lines plug a couple of memleaks in chan_skinny. (closes
	  issue #13452) Reported by: pj Patches: memleak5.diff uploaded by
	  wedhorn (license 30) Tested by: wedhorn, pj, mvanbaak (closes
	  issue #13294) Reported by: pj ........

2008-09-13 13:58 +0000 [r143033]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_iax2.c, channels/iax2-parser.c, apps/app_dial.c, /:
	  Merged revisions 143031 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r143031 |
	  tilghman | 2008-09-13 08:54:15 -0500 (Sat, 13 Sep 2008) | 8 lines
	  Repair IAXVAR implementation so that it works again (regression?)
	  (closes issue #13354) Reported by: adomjan Patches:
	  20080828__bug13354.diff.txt uploaded by Corydon76 (license 14)
	  20080829__bug13354__1.6.0.diff.txt uploaded by Corydon76 (license
	  14) Tested by: Corydon76, adomjan ........

2008-09-12 22:25 +0000 [r142935]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_local.c, /: Merged revisions 142929 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r142929 | jpeeler | 2008-09-12 17:24:13 -0500
	  (Fri, 12 Sep 2008) | 14 lines Merged revisions 142927 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142927 | jpeeler | 2008-09-12 17:22:28 -0500 (Fri, 12 Sep 2008)
	  | 6 lines (closes issue #12965) Reported by: rlsutton2 Prevents
	  local channels from playing MOH at each other which was causing
	  ast_generic_bridge to loop much faster. ........ ................

2008-09-12 20:52 +0000 [r142743-142868]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c, configs/sip.conf.sample: Merged revisions
	  142866 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142866 | tilghman | 2008-09-12 15:49:46 -0500 (Fri, 12 Sep 2008)
	  | 18 lines Merged revisions 142865 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142865 | tilghman | 2008-09-12 15:37:18 -0500 (Fri, 12 Sep 2008)
	  | 11 lines Create rules for disallowing contacts at certain
	  addresses, which may improve the security of various
	  installations. As this does not change any default behavior, it
	  is not classified as a direct security fix for anything within
	  Asterisk, but may help PBX admins better secure their SIP
	  servers. (closes issue #11776) Reported by: ibc Patches:
	  20080829__bug11776.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: Corydon76, blitzrage ........ ................

	* /, main/app.c: Merged revisions 142748 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r142748 |
	  tilghman | 2008-09-12 11:54:44 -0500 (Fri, 12 Sep 2008) | 3 lines
	  When checking for an encoded character, make sure the string
	  isn't blank, first. (Closes issue #13470) ........

	* apps/app_voicemail.c, /: Merged revisions 142745 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r142745 | tilghman | 2008-09-12 11:38:55 -0500
	  (Fri, 12 Sep 2008) | 12 lines Merged revisions 142744 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142744 | tilghman | 2008-09-12 11:38:02 -0500 (Fri, 12 Sep 2008)
	  | 4 lines Missing merge from 1.2 fixes errant exit on DTMF, only
	  when language is Italian (cf commit 34242) (Closes issue #7353)
	  ........ ................

	* /, main/file.c: Merged revisions 142741 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142741 | tilghman | 2008-09-12 11:29:01 -0500 (Fri, 12 Sep 2008)
	  | 12 lines Merged revisions 142740 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142740 | tilghman | 2008-09-12 11:27:32 -0500 (Fri, 12 Sep 2008)
	  | 4 lines Don't return a free'd pointer, when a file cannot be
	  opened. (closes issue #13462) Reported by: wackysalut ........
	  ................

2008-09-12 05:03 +0000 [r142632-142678]  Steve Murphy <murf@digium.com>

	* apps/app_queue.c, apps/app_dial.c, main/pbx.c, /,
	  main/features.c, include/asterisk/channel.h: Merged revisions
	  142676 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142676 | murf | 2008-09-11 22:50:48 -0600 (Thu, 11 Sep 2008) |
	  40 lines Merged revisions 142675 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142675 | murf | 2008-09-11 22:29:34 -0600 (Thu, 11 Sep 2008) |
	  29 lines Tested by: sergee, murf, chris-mac, andrew, KNK This is
	  a "second attempt" to restore the previous "endbeforeh" behavior
	  in 1.4 and up. In order to capture information concerning all the
	  legs of transfers in all their infinite combinations, I was
	  forced to this particular solution by a chain of logical
	  necessities, the first being that I was not allowed to rewrite
	  the CDR mechanism from the ground up! This change basically
	  leaves the original machinery alone, which allows IVR and local
	  channel type situations to generate CDR's as normal, but a
	  channel flag can be set to suppress the normal running of the h
	  exten. That flag would be set by the code that runs the h exten
	  from the ast_bridge_call routine, to prevent the h exten from
	  being run twice. Also, a flag in the ast_bridge_config struct
	  passed into ast_bridge_call can be used to suppress the running
	  of the h exten in that routine. This would happen, for instance,
	  if you use the 'g' option in the Dial app. Running this routine
	  'early' allows not only the CDR() func to be used in the h
	  extension for reading CDR variables, but also allows them to be
	  modified before the CDR is posted to the backends. While I dearly
	  hope that this patch overcomes all problems, and introduces no
	  new problems, reality suggests that surely someone will have
	  problems. In this case, please re-open 13251 (or 13289), and
	  we'll see if we can't fix any remaining issues. ** trunk note:
	  some code to suppress the h exten being run from app_queue was
	  added; for the 'continue' option available only in trunk/1.6.x.
	  ........ ................

	* /, main/features.c: Merged revisions 142576 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142576 | murf | 2008-09-11 17:12:53 -0600 (Thu, 11 Sep 2008) |
	  28 lines Merged revisions 142575 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142575 | murf | 2008-09-11 16:55:49 -0600 (Thu, 11 Sep 2008) |
	  20 lines (closes issue #13364) Reported by: mdu113 Well,
	  fundamentally, the problems revealed in 13364 are because of the
	  ForkCDR call that is done before the dial. When the bridge is in
	  place, it's dealing with the first (and wrong) cdr in the list.
	  So, I wrote a little func to zip down to the first non-locked cdr
	  in the chain, and thru-out the ast_bridge_call, these results are
	  used instead of raw chan->cdr and peer->cdr pointers. This
	  shouldn't affect anyone who isn't forking cdrs before a dial, and
	  should correct the cdr's of those that do. So, this change ends
	  up correcting the dstchannel and userfield; the disposition was
	  fixed by a previous patch, it was OK coming into this problem.
	  ........ ................

2008-09-10 22:18 +0000 [r142478]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 142475 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142475 | murf | 2008-09-10 16:11:27 -0600 (Wed, 10 Sep 2008) |
	  38 lines Merged revisions 142474 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142474 | murf | 2008-09-10 15:58:17 -0600 (Wed, 10 Sep 2008) |
	  30 lines (closes issue #12318) Reported by: krtorio I made a
	  small change to the code that handles local channel situations.
	  In that code, I copy the answer time from the peer cdr, to the
	  bridge_cdr, but I wasn't also copying the disposition from the
	  peer cdr. So, Now I copy the disposition, and I've tested against
	  these cases: 1. phone 1 never answers the phone; no cdr is
	  generated at all. this should show up as a manager command
	  failure or something. 2. phone 2 never answers. CDR is generated,
	  says NO ANSWER 3. phone 2 is busy. CDR is generated, says BUSY 4.
	  phone 2 answers: CDR is generated, times are correct; disposition
	  is ANSWERED, which is correct. The start time is the time that
	  the manager dialed the first phone. The answer time is the time
	  the second phone picks up. I purposely left the cid and src
	  fields blank; since this call really originates from the manager,
	  there is no 'easy' data to put in these fields. If you feel
	  strongly that these fields should be filled in, re-open this bug
	  and I'll dig further. ........ ................

2008-09-10 19:14 +0000 [r142419]  Sean Bright <sean.bright@gmail.com>

	* /, configure, acinclude.m4: Merged revisions 142417 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r142417 | seanbright | 2008-09-10 15:09:03 -0400
	  (Wed, 10 Sep 2008) | 17 lines Merged revisions 142416 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142416 | seanbright | 2008-09-10 15:05:46 -0400 (Wed, 10 Sep
	  2008) | 9 lines Fix detection of PWLIB and OpenH323 version when
	  spacing in the headers isn't consistent. (closes issue #13426)
	  Reported by: bamby Patches: detect_openh323.diff uploaded by
	  bamby (license 430) (Modified by me to use sed instead of tr)
	  ........ ................

2008-09-10 16:57 +0000 [r142361]  Tilghman Lesher <tlesher@digium.com>

	* sounds/Makefile, /: Merged revisions 142359 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142359 | tilghman | 2008-09-10 11:55:31 -0500 (Wed, 10 Sep 2008)
	  | 10 lines Merged revisions 142358 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142358 | tilghman | 2008-09-10 11:54:29 -0500 (Wed, 10 Sep 2008)
	  | 2 lines Publish new extra sounds version. ........
	  ................

2008-09-10 16:42 +0000 [r142357]  Russell Bryant <russell@digium.com>

	* main/sched.c, /: Merged revisions 142355 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142355 | russell | 2008-09-10 11:41:55 -0500 (Wed, 10 Sep 2008)
	  | 15 lines Merged revisions 142354 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142354 | russell | 2008-09-10 11:39:53 -0500 (Wed, 10 Sep 2008)
	  | 7 lines It is a normal situation that a task gets put in the
	  scheduler that should run as soon as possible. Accept "0" as an
	  acceptable time to run, and also treat negative as "run now", and
	  don't print a debug message about it. (inspired by a message
	  asking about the "request to schedule in the past" debug message
	  on the -dev list) ........ ................

2008-09-09 19:18 +0000 [r142082-142221]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 142219 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142219 | mmichelson | 2008-09-09 14:16:30 -0500 (Tue, 09 Sep
	  2008) | 22 lines Merged revisions 142218 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142218 | mmichelson | 2008-09-09 14:15:28 -0500 (Tue, 09 Sep
	  2008) | 14 lines Make sure that the branch sent in CANCEL
	  requests matches the branch of the INVITE it is cancelling.
	  (closes issue #13381) Reported by: atca_pres Patches:
	  13381v2.patch uploaded by putnopvut (license 60) Tested by:
	  atca_pres (closes issue #13198) Reported by: rickead2000 Tested
	  by: rickead2000 ........ ................

	* apps/app_queue.c: Merging Revision 142090 from 1.6.0.

	* /, channels/chan_sip.c: Merged revisions 142080 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142080 | mmichelson | 2008-09-09 11:20:41 -0500 (Tue, 09 Sep
	  2008) | 29 lines Merged revisions 142079 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142079 | mmichelson | 2008-09-09 11:19:17 -0500 (Tue, 09 Sep
	  2008) | 21 lines When determining if codecs used by SIP peers
	  allow the media to be natively bridged, use the jointcapability
	  instead of the peercapability. It seems that the intent of using
	  the peercapability was to expand the choice of codecs for the
	  call to increase the chances of being able to native bridge the
	  channels. The problem is that if a codec were settled on for the
	  native bridge and that wasn't a codec that was configured to be
	  used by Asterisk for that peer, then Asterisk would send a
	  REINVITE with no codecs in the SDP which is a bug no matter how
	  you slice it. (closes issue #13076) Reported by: ramonpeek
	  Patches: 13076.patch uploaded by putnopvut (license 60) Tested
	  by: tbelder ........ ................

2008-09-09 15:46 +0000 [r142066]  Russell Bryant <russell@digium.com>

	* /, main/features.c: Merged revisions 142064 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r142064 | russell | 2008-09-09 10:44:10 -0500 (Tue, 09 Sep 2008)
	  | 13 lines Merged revisions 142063 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142063 | russell | 2008-09-09 10:40:24 -0500 (Tue, 09 Sep 2008)
	  | 5 lines Ensure that the stored CDR reference is still valid
	  after the bridge before poking at it. Also, keep the channel
	  locked while messing with this CDR. (fixes crashes reported in
	  issue #13409) ........ ................

2008-09-09 12:34 +0000 [r141997-142001]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 141998 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r141998 |
	  mmichelson | 2008-09-09 07:32:38 -0500 (Tue, 09 Sep 2008) | 7
	  lines Use ast_debug for debug messages. I was wondering why debug
	  messages weren't showing up when I had set the debug level high
	  for just app_queue.c. It's because we were only checking the
	  global option_debug variable instead of using the awesome macro
	  which checks both the global and file-specific value ........

	* channels/chan_oss.c, /: Merged revisions 141995 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r141995 |
	  mmichelson | 2008-09-09 05:20:58 -0500 (Tue, 09 Sep 2008) | 8
	  lines Fix a memory leak in chan_oss (closes issue #13311)
	  Reported by: eliel Patches: chan_oss.c.patch uploaded by eliel
	  (license 64) ........

2008-09-09 01:51 +0000 [r141951-141952]  Russell Bryant <russell@digium.com>

	* main/pbx.c, /: Merged revisions 141807 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r141807 | russell | 2008-09-08 16:05:01 -0500 (Mon, 08 Sep 2008)
	  | 15 lines Merged revisions 141806 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141806 | russell | 2008-09-08 16:02:36 -0500 (Mon, 08 Sep 2008)
	  | 7 lines When doing an async goto, detect if the channel is
	  already in the middle of a masquerade. This can happen when
	  chan_local is trying to optimize itself out. If this happens,
	  fail the async goto instead of bursting into flames. (closes
	  issue #13435) Reported by: geoff2010 ........ ................

	* main/channel.c, /: Merged revisions 141949 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r141949 |
	  russell | 2008-09-08 20:47:56 -0500 (Mon, 08 Sep 2008) | 9 lines
	  Modify ast_answer() to not hold the channel lock while calling
	  ast_safe_sleep() or when calling ast_waitfor(). These are
	  inappropriate times to hold the channel lock. This is what has
	  caused "could not get the channel lock" messages from chan_sip
	  and has likely caused a negative impact on performance results of
	  SIP in Asterisk 1.6. Thanks to file for pointing out this section
	  of code. (closes issue #13287) (closes issue #13115) ........

2008-09-08 22:15 +0000 [r141812-141870]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 141868 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r141868 |
	  mmichelson | 2008-09-08 17:14:40 -0500 (Mon, 08 Sep 2008) | 4
	  lines Um, apparently I didn't actually finish merging before
	  committing. Bad bad bad ........

	* /, channels/chan_sip.c: Merged revisions 141810 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r141810 | mmichelson | 2008-09-08 16:18:49 -0500 (Mon, 08 Sep
	  2008) | 22 lines Merged revisions 141809 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141809 | mmichelson | 2008-09-08 16:10:10 -0500 (Mon, 08 Sep
	  2008) | 14 lines Fix pedantic mode of chan_sip to only check the
	  remote tag of an endpoint once a dialog has been confirmed. Up
	  until that point, it is possible and legal for the far-end to
	  send provisional responses with a different To: tag each time.
	  With this patch applied, these provisional messages will not
	  cause a matching problem. (closes issue #11536) Reported by: ibc
	  Patches: 11536v2.patch uploaded by putnopvut (license 60)
	  ........ ................

2008-09-08 20:20 +0000 [r141747]  Jason Parker <jparker@digium.com>

	* Makefile, /, redhat (removed): Merged revisions 141745 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r141745 | qwell | 2008-09-08 15:18:17 -0500
	  (Mon, 08 Sep 2008) | 16 lines Merged revisions 141741 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141741 | qwell | 2008-09-08 15:15:42 -0500 (Mon, 08 Sep 2008) |
	  8 lines Remove RPM package targets from Makefile (and all
	  associated parts). This has never worked in 1.4, and we decided
	  that it makes no sense to be done here. There are many distros
	  out there that already have "proper" spec files that can be
	  (re)used. Closes issue #13113 Closes issue #10950 Closes issue
	  #10952 ........ ................

2008-09-08 17:15 +0000 [r141684]  Sean Bright <sean.bright@gmail.com>

	* build_tools/make_buildopts_h, /: Merged revisions 141682 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r141682 | seanbright | 2008-09-08 13:13:04 -0400 (Mon,
	  08 Sep 2008) | 9 lines Quote the arguments to grep so that sh on
	  various platforms doesn't choke on the special characters (like
	  ^). (closes issue #13417) Reported by: dougm Patches:
	  13417.make_buildopts_h.patch uploaded by seanbright (license 71)
	  Tested by: dougm ........

2008-09-06 20:23 +0000 [r141572]  Steve Murphy <murf@digium.com>

	* /, channels/chan_sip.c: Merged revisions 141566 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r141566 | murf | 2008-09-06 14:19:50 -0600 (Sat, 06 Sep 2008) | 9
	  lines Merged revisions 141565 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141565 | murf | 2008-09-06 14:13:16 -0600 (Sat, 06 Sep 2008) | 1
	  line This fix comes from Joshua Colp The Brilliant, who, given
	  the trace, came up with a solution. This will most likely will
	  close 13235 and 13409. I'll wait till Monday to verify, and then
	  close these bugs. ........ ................

2008-09-06 15:28 +0000 [r141506]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_agi.c: Merged revisions 141504 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r141504 | tilghman | 2008-09-06 10:26:45 -0500 (Sat, 06 Sep 2008)
	  | 12 lines Merged revisions 141503 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141503 | tilghman | 2008-09-06 10:23:42 -0500 (Sat, 06 Sep 2008)
	  | 4 lines Reverting behavior change (AGI should not exit non-zero
	  on SUCCESS) (closes issue #13434) Reported by: francesco_r
	  ........ ................

2008-09-05 21:13 +0000 [r141369]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_agent.c: Merged revisions 141367 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r141367 | mmichelson | 2008-09-05 16:12:09 -0500
	  (Fri, 05 Sep 2008) | 15 lines Merged revisions 141366 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141366 | mmichelson | 2008-09-05 16:10:32 -0500 (Fri, 05 Sep
	  2008) | 7 lines Agent's should not try to call a channel's
	  indicate callback if the channel has been hung up. It will likely
	  crash otherwise ABE-1159 ........ ................

2008-09-05 14:25 +0000 [r141117-141159]  Steve Murphy <murf@digium.com>

	* main/channel.c, /: Merged revisions 141157 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r141157 | murf | 2008-09-05 08:18:43 -0600 (Fri, 05 Sep 2008) | 9
	  lines Merged revisions 141156 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141156 | murf | 2008-09-05 08:15:43 -0600 (Fri, 05 Sep 2008) | 1
	  line A small change to prevent double-posting of CDR's; thanks to
	  Daniel Ferrer for bringing it to our attention ........
	  ................

	* res/ael/ael.flex, pbx/ael/ael-test/ref.ael-vtest25 (added), /,
	  pbx/ael/ael-test/ael-vtest25/extensions.ael,
	  pbx/ael/ael-test/ael-vtest25 (added), res/ael/ael_lex.c,
	  pbx/ael/ael-test/ref.ael-test6: Merged revisions 141115 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r141115 | murf | 2008-09-04 17:31:41 -0600 (Thu,
	  04 Sep 2008) | 78 lines Merged revisions 141094 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141094 | murf | 2008-09-04 17:15:07 -0600 (Thu, 04 Sep 2008) |
	  70 lines (closes issue #13357) Reported by: pj Tested by: murf
	  (closes issue #13416) Reported by: yarns Tested by: murf If you
	  find this message overly verbose, relax, it's probably not meant
	  for you. This message is meant for probably only two people in
	  the whole world: me, or the poor schnook that has to maintain
	  this code because I'm either dead or unavailable at the moment.
	  This fix solves two reports, both having to do with embedding a
	  function call in a ${} construct. It was tricky because the
	  funccall syntax has parenthesis () in it. And up till now, the
	  'word' token in the flex stuff didn't allow that, because it
	  would tend to steal the LP and RP tokens. To be truthful, the
	  "word" token was the trickiest, most unstable thing in the whole
	  lexer. I was lucky it made this long without complaints. I had to
	  choose every character in the pattern with extreme care, and I
	  knew that someday I'd have to revisit it. Well, the day has come.
	  So, my brilliant idea (and I'm being modest), was to use the
	  surrounding ${} construct to make a state machine and capture
	  everything in it, no matter what it contains. But, I have to now
	  treat the word token like I did with comments, in that I turn the
	  whole thing into a state-machine sort of spec, with new contexts
	  "curlystate", "wordstate", and "brackstate". Wait a minute,
	  "brackstate"? Yes, well, it didn't take very many regression
	  tests to point out if I do this for ${} constructs, I also have
	  to do it with the $[] constructs, too. I had to create a separate
	  pcbstack2 and pcbstack3 because these constructs can occur inside
	  macro argument lists, and when we have two state machines
	  operating on the same structures we'd get problems otherwise. I
	  guess I could have stopped at pcbstack2 and had the brackstate
	  stuff share it, but it doesn't hurt to be safe. So, the pcbpush
	  and pcbpop routines also now have versions for "2" and "3". I had
	  to add the {KEYWORD} construct to the initial pattern for "word",
	  because previously word would match stuff like "default7",
	  because it was a longer match than the keyword "default". But,
	  not any more, because the word pattern only matches only one or
	  two characters now, and it will always lose. So, I made it the
	  winner again by making an optional match on any of the keywords
	  before it's normal pattern. I added another regression test to
	  make sure we don't lose this in future edits, and had to fix just
	  one regression, where it no longer reports a 'cascaded' error,
	  which I guess is a plus. I've given some thought as to whether to
	  apply these fixes to 1.4 and the 1.6.x releases, vs trunk; I
	  decided to put it in 1.4 because one of the bug reports was
	  against 1.4; and it is unexpected that AEL cannot handle this
	  situation. It actually reduced the amount of useless "cascade"
	  error messages that appeared in the regressions (by one line,
	  ehhem). There is a possible side-effect in that it does now do
	  more careful checking of what's in those ${} constructs, as far
	  as matching parens, and brackets are concerned. Some users may
	  find a an insidious problem and correct it this way. This should
	  be exceedingly rare, I hope. ........ ................

2008-09-04 17:28 +0000 [r141042]  Jeff Peeler <jpeeler@digium.com>

	* /, main/features.c, res/res_agi.c: Merged revisions 141039 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r141039 | jpeeler | 2008-09-04 12:27:56 -0500
	  (Thu, 04 Sep 2008) | 15 lines Merged revisions 141028 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141028 | jpeeler | 2008-09-04 12:00:29 -0500 (Thu, 04 Sep 2008)
	  | 7 lines (closes issue #11979) Fixes multiple parking problems:
	  Crash when executing a park on an extension dialed by AGI due to
	  not returning the proper return code. Crash when using a builtin
	  feature that was a subset of a enabled dynamic feature. Crash due
	  to always hanging up the peer despite the fact that the peer was
	  supposed to be parked. ........ ................

2008-09-03 20:18 +0000 [r140888-140977]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 140975 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r140975 |
	  mmichelson | 2008-09-03 15:16:12 -0500 (Wed, 03 Sep 2008) | 4
	  lines Fix some locking order issues in app_queue. This was
	  brought up by atis on IRC a while ago. ........

	* apps/app_voicemail.c, /: Merged revisions 140887 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r140887 | mmichelson | 2008-09-03 09:41:54 -0500 (Wed, 03 Sep
	  2008) | 3 lines Fix compilation ........

2008-09-03 14:39 +0000 [r140886]  Steve Murphy <murf@digium.com>

	* res/ael/pval.c, main/pbx.c, /, res/ael/ael.tab.c, res/ael/ael.y,
	  res/ael/ael.tab.h: Merged revisions 140824 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r140824 |
	  murf | 2008-09-03 08:01:27 -0600 (Wed, 03 Sep 2008) | 21 lines In
	  these changes, I have added some explanation of changes to the
	  Set and MSet apps, so people aren't so shocked and surprised when
	  they upgrade from 1.4 to 1.6. Also, for the sake of those
	  upgrading from 1.4 to 1.6 with AEL, I provide automatic support
	  for the "old" way of using Set(), that still does the exact same
	  old thing with quotes and backslashes and so on as 1.4 did, by
	  having AEL compile in the use of MSet() instead of Set(),
	  everywhere it inserts this code. But, if the app_set var is set
	  to 1.6 or higher, it uses the "new", non-evaluative Set(). This
	  only usually happens if the user manually inserts this into the
	  asterisk.conf file, or runs the "make samples" command. (closes
	  issue #13249) Reported by: dimas Patches: ael-MSet.diff uploaded
	  by murf (license 17) Tested by: dimas, murf ........

2008-09-03 14:32 +0000 [r140867]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 140860 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r140860 | mmichelson | 2008-09-03 09:31:33 -0500
	  (Wed, 03 Sep 2008) | 17 lines Merged revisions 140850 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140850 | mmichelson | 2008-09-03 09:29:15 -0500 (Wed, 03 Sep
	  2008) | 9 lines Fix voicemail forwarding when using ODBC storage.
	  (closes issue #13387) Reported by: moliveras Patches: 13387.patch
	  uploaded by putnopvut (license 60) Tested by: putnopvut,
	  moliveras ........ ................

2008-09-03 13:27 +0000 [r140819]  Russell Bryant <russell@digium.com>

	* main/poll.c, /: Merged revisions 140817 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r140817 | russell | 2008-09-03 08:26:43 -0500 (Wed, 03 Sep 2008)
	  | 12 lines Merged revisions 140816 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140816 | russell | 2008-09-03 08:24:35 -0500 (Wed, 03 Sep 2008)
	  | 4 lines Don't freak out if the poll emulation receives NULL for
	  the pollfds array (closes issue #13307) Reported by: jcovert
	  ........ ................

2008-09-02 23:51 +0000 [r140755]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 140752 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r140752 | mmichelson | 2008-09-02 18:48:25 -0500
	  (Tue, 02 Sep 2008) | 14 lines Merged revisions 140751 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140751 | mmichelson | 2008-09-02 18:47:49 -0500 (Tue, 02 Sep
	  2008) | 6 lines After adding the context checking to
	  app_voicemail for IMAP storage, I left out a crucial place to
	  copy the context to the vm_state structure. This is the
	  correction. ........ ................

2008-09-02 23:46 +0000 [r140693-140750]  Steve Murphy <murf@digium.com>

	* main/cdr.c, /: Merged revisions 140749 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r140749 | murf | 2008-09-02 17:44:04 -0600 (Tue, 02 Sep 2008) |
	  11 lines Merged revisions 140747 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140747 | murf | 2008-09-02 17:36:56 -0600 (Tue, 02 Sep 2008) | 1
	  line I am turning the warnings generated in ast_cdr_free and
	  post_cdr into verbose level 2 messages. Really, they matter
	  little to end users. You either get the CDR's you wanted, or you
	  don't, and it is a bug. For trunk, I am going one step further.
	  These messages were pretty worthless even for debug, so I'm
	  completely removing them. ........ ................

	* main/channel.c, /: Merged revisions 140692 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r140692 | murf | 2008-09-02 16:55:12 -0600 (Tue, 02 Sep 2008) |
	  13 lines Merged revisions 140690 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140690 | murf | 2008-09-02 16:40:13 -0600 (Tue, 02 Sep 2008) | 1
	  line After reconsidering, with respect to 13409, ast_cdr_detach
	  should be OK, better in fact, than ast_cdr_free, which generates
	  lots of useless warnings that will undoubtably generate
	  complaints. Hmmm. It doesn't hush the useless warnings, but it
	  does allow control of posting via the detach and post routines,
	  for those possible situations, where you'd want to post
	  single-channel cdrs. ........ ................

	* main/channel.c, main/pbx.c, /: Merged revisions 140691 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r140691 | murf | 2008-09-02 16:50:59 -0600 (Tue,
	  02 Sep 2008) | 22 lines Merged revisions 140670 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140670 | murf | 2008-09-02 16:15:57 -0600 (Tue, 02 Sep 2008) |
	  14 lines (closes issue #13409) Reported by: tomaso Patches:
	  asterisk-1.6.0-rc2-cdrmemleak.patch uploaded by tomaso (license
	  564) I basically spent the day, verifying that this patch solves
	  the problem, and doesn't hurt in non-problem cases. Why valgrind
	  did not plainly reveal this leak absolutely mystifies and stuns
	  me. Many, many thanks to tomaso for finding and providing the
	  fix. ........ ................

2008-09-02 18:18 +0000 [r140608]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_iax2.c, /: Merged revisions 140606 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r140606 | seanbright | 2008-09-02 14:15:54 -0400
	  (Tue, 02 Sep 2008) | 16 lines Merged revisions 140605 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140605 | seanbright | 2008-09-02 14:14:57 -0400 (Tue, 02 Sep
	  2008) | 8 lines Make sure to use the correct length of the
	  mohinterpret and mohsuggest buffers when copying configuration
	  values. (closes issue #13336) Reported by:
	  decryptus_proformatique Patches:
	  chan_iax2_mohinterpret_mohsuggest_general_settings.patch uploaded
	  by decryptus (license 555) ........ ................

2008-09-02 15:13 +0000 [r140565-140568]  Russell Bryant <russell@digium.com>

	* apps/app_jack.c, /, codecs/codec_resample.c: Merged revisions
	  140566 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r140566 |
	  russell | 2008-09-02 10:11:53 -0500 (Tue, 02 Sep 2008) | 2 lines
	  Update instructions for getting libresample ........

	* res/ais/amf.c (removed), res/ais/lck.c (removed), /,
	  res/ais/ckpt.c (removed): Merged revisions 140563 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r140563 | russell | 2008-09-02 10:09:20 -0500 (Tue, 02 Sep 2008)
	  | 3 lines I'm not sure how these files got to trunk (probably my
	  fault), but they should not be here ........

2008-08-29 17:55 +0000 [r140492]  Jeff Peeler <jpeeler@digium.com>

	* CHANGES, /, main/features.c: Merged revisions 140491 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r140491 | jpeeler | 2008-08-29 12:53:32 -0500 (Fri, 29 Aug 2008)
	  | 2 lines Added the option s to the Park application which will
	  silence the announcement of the parking space number. Also, fixes
	  the bug of just clearing the flags instead of actually parsing
	  the arguments to Park. ........

2008-08-29 17:48 +0000 [r140420-140490]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, channels/chan_iax2.c, main/config.c,
	  main/manager.c, res/ais/lck.c, /, channels/chan_sip.c,
	  funcs/func_dialgroup.c, res/res_timing_pthread.c,
	  main/features.c, res/res_phoneprov.c, utils/hashtest2.c,
	  channels/chan_console.c, main/taskprocessor.c: Merged revisions
	  140489 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r140489 | mmichelson | 2008-08-29 12:47:17 -0500 (Fri, 29 Aug
	  2008) | 30 lines Merged revisions 140488 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140488 | mmichelson | 2008-08-29 12:34:17 -0500 (Fri, 29 Aug
	  2008) | 22 lines After working on the ao2_containers branch, I
	  noticed something a bit strange. In all cases where we provide a
	  callback function to ao2_container_alloc, the callback function
	  would only return 0 or CMP_MATCH. After inspecting the
	  ao2_callback() code carefully, I found that if you're only
	  looking for one specific item, then you should return CMP_MATCH |
	  CMP_STOP. Otherwise, astobj2 will continue traversing the current
	  bucket until the end searching for more matches. In cases like
	  chan_iax2 where in 1.4, all the peers are shoved into a single
	  bucket, this makes for potentially terrible performance since the
	  entire bucket will be traversed even if the peer is one of the
	  first ones come across in the bucket. All the changes I have made
	  were for cases where the callback function defined was passed to
	  ao2_container_alloc so that calls to ao2_find could find a unique
	  instance of whatever object was being stored in the container.
	  ........ ................

	* /, main/file.c: Merged revisions 140433 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r140433 |
	  mmichelson | 2008-08-29 11:24:37 -0500 (Fri, 29 Aug 2008) | 10
	  lines Allow for video files to be opened as well as audio files.
	  (closes issue #13372) Reported by: epicac Patches: 13372.patch
	  uploaded by putnopvut (license 60) Tested by: epicac ........

	* apps/app_voicemail.c, /: Merged revisions 140422 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r140422 | mmichelson | 2008-08-29 11:06:09 -0500
	  (Fri, 29 Aug 2008) | 20 lines Merged revisions 140421 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140421 | mmichelson | 2008-08-29 11:01:07 -0500 (Fri, 29 Aug
	  2008) | 12 lines Add context checking when retrieving a vm_state.
	  This was causing a problem for people who had identically named
	  mailboxes in separate voicemail contexts. This commit affects
	  IMAP storage only. (closes issue #13194) Reported by: moliveras
	  Patches: 13194.patch uploaded by putnopvut (license 60) Tested
	  by: putnopvut, moliveras ........ ................

	* /, channels/chan_sip.c: Merged revisions 140418 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r140418 | mmichelson | 2008-08-29 10:32:02 -0500 (Fri, 29 Aug
	  2008) | 18 lines Merged revisions 140417 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140417 | mmichelson | 2008-08-29 10:26:52 -0500 (Fri, 29 Aug
	  2008) | 10 lines Fix SIP's parsing so that if a port is specified
	  in a string to Dial(), it is not ignored. (closes issue #13355)
	  Reported by: acunningham Patches: 13355v2.patch uploaded by
	  putnopvut (license 60) Tested by: acunningham ........
	  ................

2008-08-27 20:14 +0000 [r140303]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 140301 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r140301 | mmichelson | 2008-08-27 15:11:22 -0500 (Wed, 27 Aug
	  2008) | 19 lines Merged revisions 140299 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140299 | mmichelson | 2008-08-27 14:49:20 -0500 (Wed, 27 Aug
	  2008) | 11 lines Fix tag checking in get_sip_pvt_byid_locked when
	  in pedantic mode. The problem was that the wrong tags would be
	  compared depending on the direction of the call. (closes issue
	  #13353) Reported by: flefoll Patches:
	  chan_sip.c.br14.139015.patch-refer-pedantic uploaded by flefoll
	  (license 244) ........ ................

2008-08-26 18:50 +0000 [r140206]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 140205 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r140205 | jpeeler | 2008-08-26 13:48:55 -0500
	  (Tue, 26 Aug 2008) | 17 lines Merged revisions 140056 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140056 | jpeeler | 2008-08-26 10:57:02 -0500 (Tue, 26 Aug 2008)
	  | 9 lines (closes issue #12071) Reported by: tzafrir Patches:
	  dahdi_close.diff uploaded by tzafrir (license 46) Tested by:
	  tzafrir, jpeeler This patch fixes closing open file descriptors
	  in the case of an error. ........ ................

2008-08-26 18:12 +0000 [r140055-140171]  Russell Bryant <russell@digium.com>

	* Makefile, /: Merged revisions 140169 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r140169 |
	  russell | 2008-08-26 13:11:49 -0500 (Tue, 26 Aug 2008) | 4 lines
	  Fix building menuselect-tree with PRINT_DIR set. We _must_ use
	  the --quiet flag here, or else some arbitrary text will end up in
	  the resulting menuselect-tree file and things will explode.
	  ........

	* /, channels/chan_sip.c: Merged revisions 140061 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r140061 | russell | 2008-08-26 11:10:06 -0500 (Tue, 26 Aug 2008)
	  | 14 lines Merged revisions 140060 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140060 | russell | 2008-08-26 11:07:58 -0500 (Tue, 26 Aug 2008)
	  | 6 lines Fix some bogus scheduler usage in chan_sip. This code
	  used the return value of a completely unrelated function to
	  determine whether the scheduler should be run or not. This would
	  have caused the scheduler to not run in cases where it should
	  have. Also, leave a note about another scheduler issue that needs
	  to be addressed at some point. ........ ................

	* channels/chan_iax2.c, /: Merged revisions 140053 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r140053 | russell | 2008-08-26 10:29:25 -0500
	  (Tue, 26 Aug 2008) | 23 lines Merged revisions 140051 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140051 | russell | 2008-08-26 10:27:23 -0500 (Tue, 26 Aug 2008)
	  | 15 lines Fix a race condition with the IAX scheduler thread. A
	  lock and condition are used here to allow newly scheduled tasks
	  to wake up the scheduler just in case the new task needs to run
	  sooner than the current wakeup time when the thread is sleeping.
	  However, there was a race condition such that a newly scheduled
	  task would not properly wake up the scheduler or affect the wake
	  up period. The order of execution would have been: 1) Scheduler
	  thread determines wake up time of N ms. 2) Another thread
	  schedules a task and signals the condition, with an execution
	  time of < N ms. 3) Scheduler thread locks and goes to sleep for N
	  ms. By moving the sleep time determination to inside the critical
	  section, this possibility is avoided. ........ ................

2008-08-25 21:49 +0000 [r139929]  Jeff Peeler <jpeeler@digium.com>

	* main/manager.c, /: Merged revisions 139928 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139928 | jpeeler | 2008-08-25 16:48:51 -0500 (Mon, 25 Aug 2008)
	  | 11 lines Merged revisions 139927 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139927 | jpeeler | 2008-08-25 16:47:33 -0500 (Mon, 25 Aug 2008)
	  | 3 lines Fix a typo I made. Lesson learned, apply the patch if
	  one exists. ........ ................

2008-08-25 21:34 +0000 [r139919]  Sean Bright <sean.bright@gmail.com>

	* build_tools/get_moduleinfo, /, build_tools/get_makeopts: Merged
	  revisions 139915 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139915 | seanbright | 2008-08-25 17:32:10 -0400 (Mon, 25 Aug
	  2008) | 17 lines Merged revisions 139909 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139909 | seanbright | 2008-08-25 17:31:03 -0400 (Mon, 25 Aug
	  2008) | 9 lines Some versions of awk (nawk, for example) don't
	  like empty regular expressions so be slightly more verbose.
	  (closes issue #13374) Reported by: dougm Patches: 13374.diff
	  uploaded by seanbright (license 71) Tested by: dougm ........
	  ................

2008-08-25 21:13 +0000 [r139874]  Terry Wilson <twilson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 139870 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139870 | twilson | 2008-08-25 15:59:58 -0500 (Mon, 25 Aug 2008)
	  | 10 lines Merged revisions 139869 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139869 | twilson | 2008-08-25 15:46:10 -0500 (Mon, 25 Aug 2008)
	  | 2 lines Make SIPADDHEADER() propagate indefinitely ........
	  ................

2008-08-25 16:05 +0000 [r139778]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /, main/features.c: Merged revisions 139770 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r139770 | murf | 2008-08-25 09:54:18 -0600 (Mon,
	  25 Aug 2008) | 17 lines Merged revisions 139764 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139764 | murf | 2008-08-25 09:33:14 -0600 (Mon, 25 Aug 2008) | 9
	  lines This patch reverts the changes made via 139347, and 139635,
	  as users are seeing adverse difference. I will un-close 13251.
	  Back to the drawing board/ concept/ beginning/ whatever! ........
	  ................

2008-08-24 16:36 +0000 [r139709]  Tilghman Lesher <tlesher@digium.com>

	* /, cdr/cdr_pgsql.c: Merged revisions 139707 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r139707 |
	  tilghman | 2008-08-24 11:26:48 -0500 (Sun, 24 Aug 2008) | 2 lines
	  Memory leak ........

2008-08-22 22:37 +0000 [r139629-139674]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 139662 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139662 | murf | 2008-08-22 16:32:35 -0600 (Fri, 22 Aug 2008) |
	  14 lines Merged revisions 139635 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139635 | murf | 2008-08-22 16:24:02 -0600 (Fri, 22 Aug 2008) | 6
	  lines I found some problems with the code I committed earlier,
	  when I merged them into trunk, so I'm coming back to clean up.
	  And, in the process, I found an error in the code I added to
	  trunk and 1.6.x, that I'll fix using this patch also. ........
	  ................

	* apps/app_dial.c, main/pbx.c, /, main/features.c: Merged revisions
	  139627 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139627 | murf | 2008-08-22 16:03:13 -0600 (Fri, 22 Aug 2008) |
	  59 lines Merged revisions 139347 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139347 | murf | 2008-08-21 17:03:50 -0600 (Thu, 21 Aug 2008) |
	  47 lines (closes issue #13251) Reported by: sergee Tested by:
	  murf THis is a bold move for a static release fix, but I wouldn't
	  have made it if I didn't feel confident (at least a *bit*
	  confident) that it wouldn't mess everyone up. The reasoning goes
	  something like this: 1. We simply cannot do anything with CDR's
	  at the current point (in pbx.c, after the __ast_pbx_run loop).
	  It's way too late to have any affect on the CDRs. The CDR is
	  already posted and gone, and the remnants have been cleared. 2. I
	  was very much afraid that moving the running of the 'h' extension
	  down into the bridge code (where it would be now practical to do
	  it), would result in a lot more calls to the 'h' exten, so I
	  implemented it as another exten under another name, but found, to
	  my pleasant surprise, that there was a 1:1 correspondence to the
	  running of the 'h' exten in the pbx_run loop, and the new spot at
	  the end of the bridge. So, I ifdef'd out the current 'h' loop,
	  and moved it into the bridge code. The only difference I can see
	  is the stuff about the AST_PBX_KEEPALIVE, and hopefully, if this
	  is still an important decision point, I can replicate it if there
	  are complaints. To be perfectly honest, the KEEPALIVE situation
	  is not totally clear to me, and how it relates to a post-bridge
	  situation is less clear. I suspect the users will point out
	  everything in total clarity if this steps on anyone's toes! 3. I
	  temporarily swap the bridge_cdr into the channel before running
	  the 'h' exten, which makes it possible for users to edit the cdr
	  before it goes out the door. And, of course, with the
	  endbeforehexten config var set, the users can also get at the
	  billsec/duration vals. After the h exten finishes, the cdr is
	  swapped back and processing continues as normal. Please, all who
	  deal with CDR's, please test this version of Asterisk, and file
	  bug reports as appropriate! ........ I also made a little fix to
	  the app_dial's 'e' option, that is related to my updates.
	  ................

2008-08-22 21:58 +0000 [r139623-139625]  Jeff Peeler <jpeeler@digium.com>

	* main/manager.c, /: Merged revisions 139624 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139624 | jpeeler | 2008-08-22 16:57:32 -0500 (Fri, 22 Aug 2008)
	  | 13 lines Merged revisions 139621 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139621 | jpeeler | 2008-08-22 16:36:13 -0500 (Fri, 22 Aug 2008)
	  | 5 lines (closes issue #13359) Reported by: Laureano Patches:
	  originate_channel_check.patch uploaded by Laureano (license 265)
	  ........ ................

	* /, main/features.c: Merged revisions 139622 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r139622 |
	  jpeeler | 2008-08-22 16:52:20 -0500 (Fri, 22 Aug 2008) | 1 line
	  remove extra comma typo ........

2008-08-22 20:21 +0000 [r139459-139565]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 139563 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r139563 |
	  mmichelson | 2008-08-22 15:20:58 -0500 (Fri, 22 Aug 2008) | 15
	  lines The -1 return value from incomplete or improper headers for
	  the SipNotify manager command was causing the current manager
	  session to become disconnected. Change the return value to 0 for
	  these cases. Also change a test for a NULL pointer to be
	  ast_strlen_zero instead. (closes issue #13351) Reported by:
	  Laureano Patches: sipnotify_action_fix.patch uploaded by Laureano
	  (license 265) ........

	* /, main/features.c: Merged revisions 139558 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r139558 |
	  mmichelson | 2008-08-22 15:02:35 -0500 (Fri, 22 Aug 2008) | 9
	  lines Add missing unique id to ParkedCallGiveUp and
	  ParkedCallTimeOut manager events (closes issue #13358) Reported
	  by: srt Patches: 13358_parking_events.diff uploaded by srt
	  (license 378) ........

	* include/asterisk/threadstorage.h, /: Merged revisions 139554 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r139554 | mmichelson | 2008-08-22 14:45:41 -0500
	  (Fri, 22 Aug 2008) | 16 lines Merged revisions 139553 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139553 | mmichelson | 2008-08-22 14:45:19 -0500 (Fri, 22 Aug
	  2008) | 8 lines Fix compilation when DEBUG_THREAD_LOCALS is
	  selected (closes issue #13298) Reported by: snuffy Patches:
	  bug13298_20080822.diff uploaded by snuffy (license 35) ........
	  ................

	* channels/chan_iax2.c, /: Merged revisions 139469 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r139469 | mmichelson | 2008-08-22 12:25:12 -0500
	  (Fri, 22 Aug 2008) | 11 lines Merged revisions 139466 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139466 | mmichelson | 2008-08-22 12:24:47 -0500 (Fri, 22 Aug
	  2008) | 3 lines Fix the build. Thanks, mvanbaak! ........
	  ................

	* channels/chan_iax2.c, /: Merged revisions 139457 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r139457 | mmichelson | 2008-08-22 11:58:21 -0500
	  (Fri, 22 Aug 2008) | 15 lines Merged revisions 139456 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139456 | mmichelson | 2008-08-22 11:57:38 -0500 (Fri, 22 Aug
	  2008) | 7 lines Prevent a deadlock in chan_iax2 resulting from
	  incorrect locking order between iax2_pvt and ast_channel
	  structures. AST-13 ........ ................

2008-08-21 23:44 +0000 [r139399]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 139391 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r139391 | jpeeler | 2008-08-21 18:41:50 -0500
	  (Thu, 21 Aug 2008) | 11 lines Merged revisions 139387 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139387 | jpeeler | 2008-08-21 18:39:31 -0500 (Thu, 21 Aug 2008)
	  | 3 lines Fixes loop that could possibly never exit in the event
	  of a channel never being able to be opened or specify after a
	  restart. (closes issue #11017) ........ ................

2008-08-20 22:19 +0000 [r139217]  Russell Bryant <russell@digium.com>

	* apps/app_chanspy.c, /: Merged revisions 139215 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139215 | russell | 2008-08-20 17:16:36 -0500 (Wed, 20 Aug 2008)
	  | 19 lines Merged revisions 139213 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139213 | russell | 2008-08-20 17:14:35 -0500 (Wed, 20 Aug 2008)
	  | 11 lines Fix a crash in the ChanSpy application. The issue here
	  is that if you call ChanSpy and specify a spy group, and sit in
	  the application long enough looping through the channel list, you
	  will eventually run out of stack space and the application with
	  exit with a seg fault. The backtrace was always inside of a
	  harmless snprintf() call, so it was tricky to track down.
	  However, it turned out that the call to snprintf() was just the
	  biggest stack consumer in this code path, so it would always be
	  the first one to hit the boundary. (closes issue #13338) Reported
	  by: ruddy ........ ................

2008-08-20 22:07 +0000 [r139212]  Jason Parker <jparker@digium.com>

	* /, channels/chan_sip.c: Merged revisions 139210 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r139210 |
	  qwell | 2008-08-20 17:06:40 -0500 (Wed, 20 Aug 2008) | 7 lines
	  Fix output of sipshowpeer manager response. (closes issue #13346)
	  Reported by: srt Patches:
	  13346_malformed_sip_show_peer_response.diff uploaded by srt
	  (license 378) ........

2008-08-20 17:34 +0000 [r139106]  Steve Murphy <murf@digium.com>

	* main/cdr.c, /: Merged revisions 139083 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139083 | murf | 2008-08-20 11:25:07 -0600 (Wed, 20 Aug 2008) |
	  20 lines Merged revisions 139074 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139074 | murf | 2008-08-20 11:14:55 -0600 (Wed, 20 Aug 2008) |
	  12 lines (closes issue #13263) Reported by: brainy Tested by:
	  murf The specialized reset routine is tromping on the flags field
	  of the CDR. I made a change to not reset the DISABLED bit. This
	  should get rid of this problem. ........ ................

2008-08-20 15:39 +0000 [r138888-139018]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 139016 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r139016 | mmichelson | 2008-08-20 10:38:47 -0500 (Wed, 20 Aug
	  2008) | 14 lines Merged revisions 139015 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139015 | mmichelson | 2008-08-20 10:37:56 -0500 (Wed, 20 Aug
	  2008) | 6 lines sip_read should properly handle a NULL return
	  from sip_rtp_read. (closes issue #13257) Reported by: travishein
	  ........ ................

	* /, channels/chan_agent.c: Merged revisions 138943 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r138943 | mmichelson | 2008-08-19 18:19:40 -0500
	  (Tue, 19 Aug 2008) | 19 lines Merged revisions 138942 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138942 | mmichelson | 2008-08-19 18:17:17 -0500 (Tue, 19 Aug
	  2008) | 11 lines Reset agent_pvt variables back to the values in
	  agents.conf (from what the corresponding channel variables were
	  set to) when the agent logs out. (closes issue #13098) Reported
	  by: davidw Patches:
	  20080731__issue13098_agent_ackcall_not_reset.diff uploaded by
	  bbryant (license 36) Tested by: davidw ........ ................

	* apps/app_chanspy.c, /: Merged revisions 138887 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r138887 | mmichelson | 2008-08-19 13:52:04 -0500 (Tue, 19 Aug
	  2008) | 31 lines Merged revisions 138886 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138886 | mmichelson | 2008-08-19 13:50:53 -0500 (Tue, 19 Aug
	  2008) | 23 lines Add a lock and unlock prior to the destruction
	  of the chanspy_ds lock to ensure that no other threads still have
	  it locked. While this should not happen under normal
	  circumstances, it appears that if the spyer and spyee hang up at
	  nearly the same time, the following may occur. 1.
	  ast_channel_free is called on the spyee's channel. 2. The chanspy
	  datastore is removed from the spyee's channel in
	  ast_channel_free. 3. In the spyer's thread, the spyer attempts to
	  remove and destroy the datastore from the spyee channel, but the
	  datastore has already been removed in step 2, so the spyer
	  continues in the code. 4. The spyee's thread continues and calls
	  the datastore's destroy callback, chanspy_ds_destroy. This
	  involves locking the chanspy_ds. 5. Now the spyer attempts to
	  destroy the chanspy_ds lock. The problem is that in step 4, the
	  spyee has locked this lock, meaning that the spyer is attempting
	  to destroy a lock which is currently locked by another thread.
	  The backtrace provided in issue #12969 supports the idea that
	  this is possible (and has even occurred). This commit does not
	  close the issue, but should help in preventing one type of crash
	  associated with the use of app_chanspy. ........ ................

2008-08-19 17:01 +0000 [r138853-138855]  Steve Murphy <murf@digium.com>

	* utils/conf2ael.c, /, res/ael/ael.tab.c, res/ael/ael.y,
	  res/ael/ael.tab.h, utils/ael_main.c: Merged revisions 138845 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r138845 | murf | 2008-08-19 10:31:24 -0600 (Tue, 19 Aug
	  2008) | 1 line Oops. put a decl in a generated file. My bad, but
	  fixed now. ........

	* main/pbx.c, /, res/ael/ael.tab.c, res/ael/ael.y,
	  res/ael/ael.tab.h: Merged revisions 138815 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138815 |
	  murf | 2008-08-19 09:59:12 -0600 (Tue, 19 Aug 2008) | 19 lines
	  These changes are in regards to bug 13249, where users are being
	  surprised by the changes made to the Set app in trunk/1.6.x, as
	  they come from the 1.4 world. They are only bitten if they write
	  their AEL dialplan in the 1.4 world, and then carry it over to a
	  trunk/1.6.x installation where a "make samples" was executed, or
	  where they hand-edited the asterisk.conf file and added the
	  [compat] category with app_set = 1.6 (or higher). (this commit
	  does not totally solve 13249, at least not yet) The change
	  involves issueing a single warning while the AEL file is loading,
	  if: 1. app_set is present in the config file, and set to 1.6 or
	  higher. 2. there are double quotes in an assignment statement (eg
	  x = "hi there";) 3. the warning was not already issued. The
	  standalone app, aelparse, does not (yet) issue this warning. I'd
	  have to have it read in the asterisk.conf file, and that's a bit
	  of hassle. I'll add it if users request it, tho. ........

2008-08-19 00:17 +0000 [r138777-138782]  Sean Bright <sean.bright@gmail.com>

	* /, channels/chan_sip.c: Merged revisions 138778-138780 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r138778 | seanbright | 2008-08-18 20:08:27 -0400 (Mon,
	  18 Aug 2008) | 1 line While we're at it, make this machine
	  parseable too. ........ r138779 | seanbright | 2008-08-18
	  20:09:38 -0400 (Mon, 18 Aug 2008) | 1 line And remove code we
	  don't need anymore. ........ r138780 | seanbright | 2008-08-18
	  20:10:56 -0400 (Mon, 18 Aug 2008) | 1 line Let it compile now,
	  too (woops) ........

	* /, channels/chan_sip.c: Merged revisions 138775 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138775 |
	  seanbright | 2008-08-18 19:42:36 -0400 (Mon, 18 Aug 2008) | 3
	  lines Change event header to RegistrationTime to be more
	  consistent (and avoid breaking existing frameworks). Pointed out
	  by Laureano on #asterisk-dev. ........

2008-08-18 20:24 +0000 [r138689-138698]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /, configs/queues.conf.sample: Merged revisions
	  138694 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138694 |
	  mmichelson | 2008-08-18 15:23:11 -0500 (Mon, 18 Aug 2008) | 10
	  lines Change the queue timeout priority logic into less ugly and
	  confusing code pieces. Clarify the logic within
	  queues.conf.sample. (closes issue #12690) Reported by: atis
	  Patches: queue_timeoutpriority.patch uploaded by atis (license
	  242) ........

	* apps/app_queue.c, /: Merged revisions 138687 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r138687 | mmichelson | 2008-08-18 15:04:10 -0500 (Mon, 18 Aug
	  2008) | 18 lines Merged revisions 138685 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138685 | mmichelson | 2008-08-18 15:01:14 -0500 (Mon, 18 Aug
	  2008) | 10 lines Change the inequalities used in app_queue with
	  regards to timeouts from being strict to non-strict for more
	  accuracy. (closes issue #13239) Reported by: atis Patches:
	  app_queue_timeouts_v2.patch uploaded by atis (license 242)
	  ........ ................

2008-08-18 15:55 +0000 [r138633]  Jason Parker <jparker@digium.com>

	* Makefile, /: Merged revisions 138631 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138631 |
	  qwell | 2008-08-18 10:54:07 -0500 (Mon, 18 Aug 2008) | 1 line
	  Remove option that isn't valid here. ........

2008-08-18 02:14 +0000 [r138520]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 138518 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r138518 | jpeeler | 2008-08-17 21:13:04 -0500 (Sun, 17 Aug 2008)
	  | 1 line add missing define for SS7 in dahdi_restart ........

2008-08-17 14:27 +0000 [r138444-138498]  Sean Bright <sean.bright@gmail.com>

	* /, main/features.c: Merged revisions 138482 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138482 |
	  seanbright | 2008-08-17 10:12:11 -0400 (Sun, 17 Aug 2008) | 6
	  lines Move Uniqueid to the end of the event for those that rely
	  on the position of the name/value pairs, pointed out by
	  snuffy-home on #asterisk-commits. For those of you who rely on
	  the position of name/value pairs in manager events... stop...
	  that is why associative arrays were invented. ........

	* /, main/features.c: Merged revisions 138479 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138479 |
	  seanbright | 2008-08-17 09:51:08 -0400 (Sun, 17 Aug 2008) | 7
	  lines Add Uniqueid header to ParkedCall manager event. (closes
	  issue #13323) Reported by: srt Patches:
	  13323_unique_id_for_parkedcalls_event.diff uploaded by srt
	  (license 378) ........

	* main/rtp.c, /: Merged revisions 138476 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138476 |
	  seanbright | 2008-08-17 09:40:36 -0400 (Sun, 17 Aug 2008) | 7
	  lines Add missing colons to RTCPReceived and RTCPSent manager
	  events. (closes issue #13319) Reported by: srt Patches:
	  13319_rtcp_manager_event_headers.diff uploaded by srt (license
	  378) ........

	* channels/chan_iax2.c, /: Merged revisions 138473 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r138473 | seanbright | 2008-08-17 09:31:54 -0400 (Sun, 17 Aug
	  2008) | 7 lines Fix the output of the JitterBufStats manager
	  event. (closes issue #13324) Reported by: srt Patches:
	  13324_missing_nl_in_jitterbufstats_event_2.diff uploaded by srt
	  (license 378) ........

	* configs/cdr_tds.conf.sample, /: Merged revisions 138442 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r138442 | seanbright | 2008-08-16 12:40:43 -0400 (Sat,
	  16 Aug 2008) | 4 lines Since it's introduction in revision 3497,
	  cdr_tds has *never* read the port configuration option from
	  cdr_tds.conf. So go ahead and remove it from the sample config.
	  ........

2008-08-16 13:08 +0000 [r138411-138414]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 138412 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r138412 | tilghman | 2008-08-16 08:07:08 -0500 (Sat, 16 Aug 2008)
	  | 2 lines Fix compilation warnings (found with dev-mode) ........

	* main/pbx.c, /: Merged revisions 138409 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138409 |
	  tilghman | 2008-08-16 07:52:06 -0500 (Sat, 16 Aug 2008) | 3 lines
	  Also make sure hinting won't crash on reload. (Closes issue
	  #13312) ........

2008-08-16 01:14 +0000 [r138359-138363]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 138361 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r138361 | jpeeler | 2008-08-15 20:13:26 -0500
	  (Fri, 15 Aug 2008) | 9 lines Merged revisions 138360 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r138360 | jpeeler | 2008-08-15 20:12:18 -0500 (Fri, 15
	  Aug 2008) | 1 line fixes use count to properly decrement if an
	  active dahdi channel is destroyed allowing module to be unloaded
	  ........ ................

	* channels/chan_dahdi.c, /: Merged revisions 138311 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r138311 | jpeeler | 2008-08-15 18:46:09 -0500
	  (Fri, 15 Aug 2008) | 20 lines Merged revisions
	  138119,138151,138238 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138119 | jpeeler | 2008-08-15 14:21:51 -0500 (Fri, 15 Aug 2008)
	  | 4 lines Fixes the dahdi restart functionality. Dahdi restart
	  allows one to restart all DAHDI channels, even if they are
	  currently in use. This is different from unloading and then
	  loading the module since unloading requires the use count to be
	  zero. Reloading the module is different in that the signalling is
	  not changed from what it was originally configured. Also, this
	  fixes not closing all the file descriptors for D-channels upon
	  module unload (which would prevent loading the module
	  afterwards). (closes issue #11017) ........ r138151 | jpeeler |
	  2008-08-15 14:41:29 -0500 (Fri, 15 Aug 2008) | 1 line declared
	  static mutexes using AST_MUTEX_DEFINE_STATIC macro ........
	  r138238 | jpeeler | 2008-08-15 16:28:26 -0500 (Fri, 15 Aug 2008)
	  | 1 line initialize condition variable ss_thread_complete using
	  ast_cond_init ........ ................

2008-08-15 22:56 +0000 [r138208-138261]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c, configs/sip.conf.sample: Merged revisions
	  138260 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r138260 | tilghman | 2008-08-15 17:54:57 -0500 (Fri, 15 Aug 2008)
	  | 16 lines Merged revisions 138258 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138258 | tilghman | 2008-08-15 17:33:42 -0500 (Fri, 15 Aug 2008)
	  | 8 lines More fixes for realtime peers. (closes issue #12921)
	  Reported by: Nuitari Patches: 20080804__bug12921.diff.txt
	  uploaded by Corydon76 (license 14) 20080815__bug12921.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: Corydon76 ........
	  ................

	* /: Merged revisions 138207 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ ........

2008-08-15 20:28 +0000 [r138184]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 138155 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r138155 | jpeeler | 2008-08-15 15:12:19 -0500 (Fri, 15 Aug 2008)
	  | 1 line rename all zfd instances in chan_dahdi to dfd to match
	  1.4 (left over from DAHDI transition) ........

2008-08-15 20:21 +0000 [r138158]  Russell Bryant <russell@digium.com>

	* main/autoservice.c, /: Merged revisions 138028 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r138028 | russell | 2008-08-15 10:09:46 -0500 (Fri, 15 Aug 2008)
	  | 17 lines Merged revisions 138027 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138027 | russell | 2008-08-15 10:07:16 -0500 (Fri, 15 Aug 2008)
	  | 9 lines Ensure that when a hangup occurs in autoservice, that a
	  hangup frame gets properly deferred to be read from the channel
	  owner when it gets taken out of autoservice. (closes issue
	  #12874) Reported by: dimas Patches: v1-12874.patch uploaded by
	  dimas (license 88) ........ ................

2008-08-15 19:37 +0000 [r138026-138150]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 138148 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138148 |
	  tilghman | 2008-08-15 14:36:11 -0500 (Fri, 15 Aug 2008) | 2 lines
	  Change free to ast_free_ptr, too ........

	* main/pbx.c, /: Merged revisions 138124 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138124 |
	  tilghman | 2008-08-15 14:22:48 -0500 (Fri, 15 Aug 2008) | 4 lines
	  e->data can be NULL, so use the safe version of ast_strdup()
	  (closes issue #13312) Reported by: pj ........

	* /, channels/chan_sip.c: Merged revisions 138086 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r138086 |
	  tilghman | 2008-08-15 13:02:15 -0500 (Fri, 15 Aug 2008) | 2 lines
	  regseconds is actually stored as the epoch time, not registration
	  length ........

	* /, funcs/func_strings.c: Merged revisions 138024 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r138024 | tilghman | 2008-08-15 10:03:32 -0500
	  (Fri, 15 Aug 2008) | 16 lines Merged revisions 138023 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138023 | tilghman | 2008-08-15 09:51:12 -0500 (Fri, 15 Aug 2008)
	  | 8 lines Additional check for more string specifiers than
	  arguments. (closes issue #13299) Reported by: adomjan Patches:
	  20080813__bug13299.diff.txt uploaded by Corydon76 (license 14)
	  func_strings.c-sprintf.patch uploaded by adomjan (license 487)
	  Tested by: adomjan ........ ................

2008-08-14 22:43 +0000 [r137989]  Russell Bryant <russell@digium.com>

	* /, doc/tex/Makefile: Merged revisions 137987 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r137987 |
	  russell | 2008-08-14 17:43:15 -0500 (Thu, 14 Aug 2008) | 2 lines
	  Fix a bashism that causes an error when trying to build the pdf
	  on ubuntu ........

2008-08-14 18:50 +0000 [r137935]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_sqlite3_custom.c, /: Merged revisions 137933 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r137933 | seanbright | 2008-08-14 14:47:28 -0400 (Thu, 14 Aug
	  2008) | 8 lines Fix memory leak in cdr_sqlite3_custom. (closes
	  issue #13304) Reported by: eliel Patches: sqlite.patch uploaded
	  by eliel (license 64) (Slightly modified by me) ........

2008-08-14 18:15 +0000 [r137904]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 137848 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r137848 | tilghman | 2008-08-14 11:52:43 -0500
	  (Thu, 14 Aug 2008) | 17 lines Merged revisions 137847 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r137847 | tilghman | 2008-08-14 11:47:30 -0500 (Thu, 14 Aug 2008)
	  | 9 lines When creating the secondary subchannel name, it is
	  necessary to compare to the existing channel name without the
	  "Zap/" or "DAHDI/" prefix, since our test string is also without
	  that prefix. (closes issue #13027) Reported by: dferrer Patches:
	  chan_zap-1.4.21.1_fix2.patch uploaded by dferrer (license 525)
	  (Slightly modified by me, to compensate for both names) ........
	  ................

2008-08-14 15:39 +0000 [r137815]  Jason Parker <jparker@digium.com>

	* /, channels/chan_sip.c: Merged revisions 137812 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r137812 |
	  qwell | 2008-08-14 10:32:16 -0500 (Thu, 14 Aug 2008) | 8 lines
	  Make sure we set the socket port, so we don't try to use <ip
	  address>:0. (closes issue #13255) Reported by: falves11 Patches:
	  13255-socketport.diff uploaded by qwell (license 4) Tested by:
	  falves11 ........

2008-08-14 15:35 +0000 [r137813]  Russell Bryant <russell@digium.com>

	* /, configs/sip.conf.sample: Merged revisions 137732 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r137732 | russell | 2008-08-14 09:15:50 -0500
	  (Thu, 14 Aug 2008) | 12 lines Merged revisions 137731 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r137731 | russell | 2008-08-14 09:05:23 -0500 (Thu, 14 Aug 2008)
	  | 4 lines Comments in this config file were aligned only if your
	  tab size was set to 8. So, convert tabs to spaces so that things
	  should be aligned regardless of what tab size you use in your
	  editor. ........ ................

2008-08-14 15:06 +0000 [r137782]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_tds.c, /: Merged revisions 137780 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r137780 |
	  seanbright | 2008-08-14 11:03:03 -0400 (Thu, 14 Aug 2008) | 8
	  lines If we detect that we are no longer connected, try to
	  reconnect a few times before giving up. This relies on the
	  timeout settings in the freetds.conf file and, unfortunately, on
	  a recent version of FreeTDS (0.82 or newer). I either need to
	  change the current execs to be non-blocking (which I do not want
	  to do) or we have to force people to run with the latest and
	  greatest of FreeTDS. I'm on the fence... ........

2008-08-14 02:08 +0000 [r137648-137683]  Kevin P. Fleming <kpfleming@digium.com>

	* /, Zaptel-to-DAHDI.txt: Merged revisions 137680 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r137680 | kpfleming | 2008-08-13 21:03:47 -0500 (Wed, 13 Aug
	  2008) | 9 lines Merged revisions 137679 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r137679 | kpfleming | 2008-08-13 21:03:04 -0500 (Wed, 13 Aug
	  2008) | 1 line forgot one module name that changed ........
	  ................

	* /: configure for merging from trunk

	* / (added): now that 1.6.0 has reached the 'release candidate'
	  stage, it's time to branch 1.6.1

2008-08-13 23:00 +0000 [r137627-137640]  Kevin P. Fleming <kpfleming@digium.com>

	* build_tools/prep_tarball: make this script actually work

	* /, Zaptel-to-DAHDI.txt (added), UPGRADE.txt: Merged revisions
	  137530 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r137530 | kpfleming | 2008-08-13 15:46:19 -0500 (Wed, 13 Aug
	  2008) | 1 line add document describing what users will need to be
	  aware of when upgrading to this version and using DAHDI ........

2008-08-13 21:08 +0000 [r137496-137532]  Jason Parker <jparker@digium.com>

	* channels/chan_sip.c: Correctly end locally ended calls. (closes
	  issue #12170) Reported by: pj Patches:
	  20080702__issue12170_clear_pendinginvite.diff uploaded by bbryant
	  (license 36) Tested by: bbryant, pabelanger

	* apps/app_fax.c: Add FAXMODE variable with what fax transport was
	  used. (closes issue #13252) Patches: v1-13252.patch uploaded by
	  dimas (license 88)

2008-08-13 17:36 +0000 [r137456]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c: Convert deprecated routines to the new names.
	  (closes issue #13297) Reported by: snuffy Patches:
	  bug13297_20080814.diff uploaded by snuffy (license 35)

2008-08-13 14:41 +0000 [r137403-137406]  Sean Bright <sean.bright@gmail.com>

	* /, doc/tex/cdrdriver.tex: Merged revisions 137405 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r137405 | seanbright | 2008-08-13 10:33:49 -0400 (Wed,
	  13 Aug 2008) | 1 line Update docs to reflect the change to
	  cdr_tds ........

	* cdr/cdr_tds.c: Use the ast_vasprintf macro instead of vasprintf
	  directly.

2008-08-12 19:48 +0000 [r137299-137301]  Russell Bryant <russell@digium.com>

	* doc/tex/asterisk.tex: Grammar hax from Qwell

	* doc/tex/asterisk.tex: Note that developer documentation belongs
	  in doxygen, and not integrated with the user manual stuff in
	  doc/tex/.

2008-08-11 16:14 +0000 [r137239]  Russell Bryant <russell@digium.com>

	* Makefile: Make PRINT_DIR work as advertised.

2008-08-11 14:25 +0000 [r137203]  Sean Bright <sean.bright@gmail.com>

	* UPGRADE.txt, cdr/cdr_tds.c: Log the userfield CDR variable like
	  the other CDR backends, assuming the column is actually there. If
	  it's not, we still log everything else as before. (closes issue
	  #13281) Reported by: falves11

2008-08-11 00:25 +0000 [r137150]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_odbc.c: Merged revisions 137138 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r137138 | tilghman | 2008-08-10 19:20:38 -0500 (Sun, 10 Aug 2008)
	  | 5 lines Deallocate database connection handle on disconnect, as
	  we allocate another one on connect. (closes issue #13271)
	  Reported by: dveiga ........

2008-08-10 21:10 +0000 [r137028-137112]  Sean Bright <sean.bright@gmail.com>

	* include/asterisk/channel.h: Fix this again so we can compile with
	  shadow warnings enabled and IMAP chosen in voicemail.

	* main/udptl.c, main/say.c, main/taskprocessor.c, main/sched.c:
	  That's all, folks. Not going to update the Makefile until
	  res_jabber is converted (snuffy, you there? :))

	* main/channel.c, main/pbx.c, main/frame.c, main/logger.c,
	  apps/app_queue.c, main/indications.c, main/asterisk.c,
	  main/rtp.c, apps/app_voicemail.c, main/cli.c: Another batch of
	  files from RSW. The remaining apps and a few more files from
	  main/

	* main/db1-ast/btree/bt_put.c, main/db1-ast/recno/rec_delete.c,
	  main/jitterbuf.c, main/acl.c, main/db1-ast/recno/rec_put.c,
	  main/astobj2.c, main/config.c, main/rtp.c, main/channel.c,
	  main/cdr.c, main/manager.c, main/tdd.c, main/features.c,
	  main/abstract_jb.c, main/file.c, main/http.c, main/callerid.c,
	  main/app.c, main/event.c, main/audiohook.c,
	  main/db1-ast/btree/bt_delete.c, main/asterisk.c: Another big
	  chunk of changes from the RSW branch. Bunch of stuff from main/

	* apps/app_dial.c, apps/app_dahdibarge.c, apps/app_meetme.c,
	  apps/app_festival.c, apps/app_record.c, apps/app_dahdiscan.c,
	  apps/app_disa.c, apps/app_waituntil.c, apps/app_playback.c,
	  apps/app_forkcdr.c, apps/app_osplookup.c, apps/app_minivm.c,
	  apps/app_macro.c, apps/app_sms.c, apps/app_directory.c,
	  apps/app_rpt.c, apps/app_while.c, apps/app_adsiprog.c: More RSW
	  merges. Everything from apps/ except for the big offenders
	  app_voicemail and app_queue.

	* res/res_config_pgsql.c, res/res_smdi.c, res/res_timing_pthread.c,
	  res/res_adsi.c, res/res_agi.c, res/res_phoneprov.c,
	  res/ael/ael_lex.c, res/res_musiconhold.c, res/ael/ael.flex,
	  res/res_config_ldap.c, res/res_odbc.c: All of the res/ stuff
	  (other than res_jabber) from the RSW branch.

2008-08-09 15:26 +0000 [r136947]  Tilghman Lesher <tlesher@digium.com>

	* /, include/asterisk/compat.h, include/asterisk/astobj2.h: Merged
	  revisions 136946 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r136946 | tilghman | 2008-08-09 10:25:36 -0500
	  (Sat, 09 Aug 2008) | 10 lines Merged revisions 136945 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r136945 | tilghman | 2008-08-09 10:24:36 -0500 (Sat, 09 Aug 2008)
	  | 2 lines Regression fixes for Solaris ........ ................

2008-08-09 14:12 +0000 [r136888-136917]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_unistim.c, channels/chan_sip.c,
	  channels/chan_skinny.c, codecs/codec_dahdi.c,
	  channels/chan_iax2.c, channels/xpmr/xpmr.c,
	  channels/iax2-parser.c, channels/chan_mgcp.c: More RSW merges.
	  This should do it for the channels/ dir.

	* channels/chan_dahdi.c: Biggest offender? chan_dahdi.c! More RSW
	  merging.

	* channels/chan_jingle.c, channels/chan_phone.c,
	  channels/chan_agent.c, channels/chan_features.c,
	  channels/chan_alsa.c, channels/chan_console.c: Merge more changes
	  from the resolve-shadow-warnings branch (henceforth known as RSW
	  since i am too lazy to keep typing it all out). This time a few
	  of the channels.

2008-08-09 01:15 +0000 [r136859]  Tilghman Lesher <tlesher@digium.com>

	* res/res_agi.c: Update documentation as to the behavior of AGI in
	  1.6.0 and higher. Also, add an OOB message that answers the
	  question of, if AGI no longer shuts down the connection on
	  hangup, how will FastAGI know when to stop processing the call?

2008-08-08 18:19 +0000 [r136819]  Sean Bright <sean.bright@gmail.com>

	* configure, configure.ac, makeopts.in: Bring in the configure and
	  makeopts jazz for -Wshadow, but don't add it to the Makefile yet.

2008-08-08 15:58 +0000 [r136787]  Dwayne M. Hubbard <dhubbard@digium.com>

	* channels/chan_dahdi.c: use ARRAY_LEN

2008-08-08 15:31 +0000 [r136784]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fix compilation for ODBC voicemail

2008-08-08 02:34 +0000 [r136751]  Tilghman Lesher <tlesher@digium.com>

	* /: Removing bad properties

2008-08-08 00:48 +0000 [r136746]  Steve Murphy <murf@digium.com>

	* res/ael/pval.c, /, pbx/ael/ael-test/ref.ael-ntest10,
	  include/asterisk/ael_structs.h, pbx/ael/ael-test/ref.ael-test8,
	  pbx/ael/ael-test/ref.ael-test18, pbx/ael/ael-test/ref.ael-test19,
	  pbx/ael/ael-test/ref.ael-vtest13: Merged revisions 136726 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r136726 | murf | 2008-08-07 18:15:34 -0600 (Thu, 07 Aug 2008) |
	  32 lines (closes issue #13236) Reported by: korihor Wow, this one
	  was a challenge! I regrouped and ran a new strategy for setting
	  the ~~MACRO~~ value; I set it once per extension, up near the
	  top. It is only set if there is a switch in the extension. So, I
	  had to put in a chunk of code to detect a switch in the pval
	  tree. I moved the code to insert the set of ~~exten~~ up to the
	  beginning of the gen_prios routine, instead of down in the switch
	  code. I learned that I have to push the detection of the switches
	  down into the code, so everywhere I create a new exten in
	  gen_prios, I make sure to pass onto it the values of the
	  mother_exten first, and the exten next. I had to add a couple
	  fields to the exten struct to accomplish this, in the
	  ael_structs.h file. The checked field makes it so we don't repeat
	  the switch search if it's been done. I also updated the
	  regressions. ........

2008-08-07 23:39 +0000 [r136715-136722]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Remove one last batch of debug messages

	* apps/app_voicemail.c: Fix build for non-IMAP storage and get rid
	  of some debug messages. Thanks to eliel for alerting me. No
	  thanks to buildbot.

	* /, apps/app_voicemail.c: Merging the imap_consistency_trunk
	  branch to trunk. For an explanation of what "imap_consistency"
	  is, please see svn revision 134223 to the 1.4 branch.
	  Coincidentally, this also fixes a recent bug report regarding the
	  inability to save messages to the new folder when using IMAP
	  storage since they will would be flagged as "seen" and not be
	  recognized as new messages. (closes issue #13234) Reported by:
	  jaroth

2008-08-07 21:19 +0000 [r136679]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: show correct called party id and also
	  store this to the 'placed calls' list once the call is connected.
	  (closes issue #13180) Reported by: pj Patches:
	  2008080700_skinny_calledpartyid.diff uploaded by mvanbaak
	  (license 7) Tested by: mvanbaak, pj

2008-08-07 20:54 +0000 [r136676]  Shaun Ruffell <sruffell@digium.com>

	* codecs/codec_dahdi.c: Updating codec_dahdi to the new transcoder
	  interface.

2008-08-07 20:25 +0000 [r136631-136660]  Mark Michelson <mmichelson@digium.com>

	* main/features.c: Bump a LOG_NOTICE message to LOG_DEBUG since it
	  appears once for every bridged call

	* main/pbx.c: Don't allow Answer() to accept a negative argument.
	  Negative argument means an infinite delay and we don't want that.

	* main/channel.c: Fix a calculation error I had made in the poll.
	  The poll would reset to 500 ms every time a non-voice frame was
	  received. The total time we poll should be 500 ms, so now we save
	  the amount of time left after the poll returned and use that as
	  our argument for the next call to poll

	* main/channel.c: Scrap the 500 ms delay when Asterisk auto-answers
	  a channel. Instead, poll the channel until receiving a voice
	  frame. The cap on this poll is 500 ms. The optional delay is
	  still allowable in the Answer() application, but the delay has
	  been moved back to its original position, after the call to the
	  channel's answer callback. The poll for the voice frame will not
	  happen if a delay is specified when calling Answer(). (closes
	  issue #12708) Reported by: kactus

2008-08-07 19:01 +0000 [r136594]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_misdn.c, /, configs/misdn.conf.sample,
	  channels/misdn_config.c: Merged revisions 136241 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r136241 | rmudgett | 2008-08-06 16:18:53 -0500 (Wed, 06
	  Aug 2008) | 5 lines * The allowed_bearers setting in misdn.conf
	  misspelled one of its options: digital_restricted. * Fixed some
	  other spelling errors and typos. ........

2008-08-07 17:44 +0000 [r136504-136542]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/doxyref.h, /: Merged revisions 136541 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ ........

	* apps/app_jack.c: stop using deprecated API call

2008-08-07 16:55 +0000 [r136489]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_queue.c: Merged revisions 136488 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r136488 | tilghman | 2008-08-07 11:50:47 -0500 (Thu, 07 Aug 2008)
	  | 7 lines Update persistent state on all exit conditions. (closes
	  issue #12916) Reported by: sgenyuk Patches: app_queue.patch.txt
	  uploaded by neutrino88 (license 297) Tested by: sgenyuk, aragon
	  ........

2008-08-07 16:29 +0000 [r136477]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_voicemail.c: fix some format strings to actually compile
	  without errors

2008-08-07 15:16 +0000 [r136408]  Sean Bright <sean.bright@gmail.com>

	* codecs/Makefile, utils/muted.c, utils/astman.c, utils/smsq.c,
	  codecs/codec_dahdi.c, formats/msgsm.h, utils/extconf.c,
	  utils/frame.c: More merges from resolve-shadow warnings: utils/
	  codecs/ and a change I missed from formats/

2008-08-07 15:10 +0000 [r136406]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_tds.c: Fix runtime symbol error

2008-08-07 14:36 +0000 [r136298-136402]  Sean Bright <sean.bright@gmail.com>

	* include/asterisk/callerid.h, include/asterisk/strings.h: Merge in
	  a few more changes. This time the include/ directory.

	* funcs/func_config.c, funcs/func_timeout.c, funcs/func_odbc.c,
	  funcs/func_strings.c: Continue merging in changes from
	  resolve-shadow-warnings. funcs/ this time.

	* cdr/cdr_adaptive_odbc.c, cdr/cdr_pgsql.c, cdr/cdr_radius.c,
	  cdr/cdr_tds.c, cdr/cdr_csv.c: More from the
	  resolve-shadow-warnings branch. This time the cdr/ directory.

	* formats/format_pcm.c, pbx/pbx_dundi.c, formats/msgsm.h,
	  pbx/dundi-parser.c, pbx/pbx_config.c: Start moving in changes
	  from my resolve-shadow-warnings branch. Going to do this in
	  pieces so the diffs are a little bit smaller and more reviewable.
	  pbx/ and formats/ first.

2008-08-06 21:22 +0000 [r136245]  Dwayne M. Hubbard <dhubbard@digium.com>

	* main/taskprocessor.c: move taskprocessor CLI commands into the
	  core namespace

2008-08-06 20:15 +0000 [r136112-136191]  Tilghman Lesher <tlesher@digium.com>

	* /, contrib/init.d/rc.redhat.asterisk: Merged revisions 136190 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r136190 | tilghman | 2008-08-06 15:14:54 -0500 (Wed, 06 Aug 2008)
	  | 4 lines -C option takes a filename, not a directory path.
	  (closes issue #13007) Reported by: klaus3000 ........

	* apps/app_meetme.c: Janitor ast_str project (closes issue #13058)
	  Reported by: pputman Patches: app_meetme_aststr2.patch uploaded
	  by pputman (license 81)

	* funcs/func_dialgroup.c: Persist DIALGROUP() values in astdb
	  (closes issue #13138) Reported by: Corydon76 Patches:
	  20080725__bug13138.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: pj

2008-08-06 15:59 +0000 [r136063]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_skinny.c, main/rtp.c: Merged revisions 136062
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r136062 | mmichelson | 2008-08-06 10:58:40 -0500 (Wed, 06 Aug
	  2008) | 16 lines Since adding the AST_CONTROL_SRCUPDATE frame
	  type, there are places where ast_rtp_new_source may be called
	  where the tech_pvt of a channel may not yet have an rtp structure
	  allocated. This caused a crash in chan_skinny, which was fixed
	  earlier, but now the same crash has been reported against
	  chan_h323 as well. It seems that the best solution is to modify
	  ast_rtp_new_source to not attempt to set the marker bit if the
	  rtp structure passed in is NULL. This change to
	  ast_rtp_new_source also allows the removal of what is now a
	  redundant pointer check from chan_skinny. (closes issue #13247)
	  Reported by: pj ........

2008-08-06 14:51 +0000 [r136034]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_odbc.c: Use a dynamic buffer for rendered SQL, instead
	  of hardcoding 2048 bytes. Also, switch to using RWLISTs for the
	  linked list of queries.

2008-08-06 13:34 +0000 [r136005]  Olle Johansson <oej@edvina.net>

	* res/res_jabber.c: - Formatting - Changing debug messages from
	  VERBOSE to DEBUG channel - Adding a few todo's - Adding a few
	  more "XMPP"'s to compliment Jabber...

2008-08-06 03:55 +0000 [r135900-135950]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c, /: Merged revisions 135949 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135949 | tilghman | 2008-08-05 22:53:36 -0500 (Tue, 05 Aug 2008)
	  | 4 lines Fix a longstanding bug in channel walking logic, and
	  fix the explanation to make sense. (Closes issue #13124) ........

	* /, main/translate.c: Merged revisions 135915 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135915 | tilghman | 2008-08-05 22:24:56 -0500 (Tue, 05 Aug 2008)
	  | 4 lines Since powerof() can return an error condition, it's
	  foolhardy not to detect and deal with that condition. (Related to
	  issue #13240) ........

	* include/asterisk/utils.h, /, include/asterisk/threadstorage.h:
	  Merged revisions 135899 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135899 | tilghman | 2008-08-05 22:02:59 -0500 (Tue, 05 Aug 2008)
	  | 4 lines 1) Bugfix for debugging code 2) Reduce compiler
	  warnings for another section of debugging code (Closes issue
	  #13237) ........

2008-08-06 00:30 +0000 [r135851]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c, /, main/abstract_jb.c, main/fixedjitterbuf.h,
	  include/asterisk/abstract_jb.h: Merged revisions
	  135841,135847,135850 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135841 | mmichelson | 2008-08-05 19:25:10 -0500 (Tue, 05 Aug
	  2008) | 27 lines Merging the issue11259 branch. The purpose of
	  this branch was to take into account "burps" which could cause
	  jitterbuffers to misbehave. One such example is if the L option
	  to Dial() were used to inject audio into a bridged conversation
	  at regular intervals. Since the audio here was not passed through
	  the jitterbuffer, it would cause a gap in the jitterbuffer's
	  timestamps which would cause a frames to be dropped for a brief
	  period. Now ast_generic_bridge will empty and reset the
	  jitterbuffer each time it is called. This causes injected audio
	  to be handled properly. ast_generic_bridge also will empty and
	  reset the jitterbuffer if it receives an AST_CONTROL_SRCUPDATE
	  frame since the change in audio source could negatively affect
	  the jitterbuffer. All of this was made possible by adding a new
	  public API call to the abstract_jb called ast_jb_empty_and_reset.
	  (closes issue #11259) Reported by: plack Tested by: putnopvut
	  ........ r135847 | mmichelson | 2008-08-05 19:27:54 -0500 (Tue,
	  05 Aug 2008) | 4 lines Revert inadvertent changes to app_skel
	  that occurred when I was testing for a memory leak ........
	  r135850 | mmichelson | 2008-08-05 19:29:54 -0500 (Tue, 05 Aug
	  2008) | 3 lines Remove properties that should not be here
	  ........

2008-08-05 23:45 +0000 [r135821]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, main/cdr.c, main/channel.c, /, main/features.c,
	  include/asterisk/cdr.h: Merged revisions 135799 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135799 | murf | 2008-08-05 17:13:20 -0600 (Tue, 05 Aug 2008) |
	  34 lines (closes issue #12982) Reported by: bcnit Tested by: murf
	  I discovered that also, in the previous bug fixes and changes,
	  the cdr.conf 'unanswered' option is not being obeyed, so I fixed
	  this. And, yes, there are two 'answer' times involved in this
	  scenario, and I would agree with you, that the first answer time
	  is the time that should appear in the CDR. (the second 'answer'
	  time is the time that the bridge was begun). I made the necessary
	  adjustments, recording the first answer time into the peer cdr,
	  and then using that to override the bridge cdr's value. To get
	  the 'unanswered' CDRs to appear, I purposely output them, using
	  the dial cmd to mark them as DIALED (with a new flag), and
	  outputting them if they bear that flag, and you are in the right
	  mode. I also corrected one small mention of the Zap device to
	  equally consider the dahdi device. I heavily tested 10-sec-wait
	  macros in dial, and without the macro call; I tested hangups
	  while the macro was running vs. letting the macro complete and
	  the bridge form. Looks OK. Removed all the instrumentation and
	  debug. ........

2008-08-05 21:37 +0000 [r135717-135748]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 135747 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r135747 | tilghman | 2008-08-05 16:34:46 -0500 (Tue, 05
	  Aug 2008) | 9 lines In a conversion to use ast_strlen_zero, the
	  meaning of the flag IAX_HASCALLERID was perverted. This change
	  reverts IAX2 to the original meaning, which was, that the
	  callerid set on the client should be overridden on the server,
	  even if that means the resulting callerid is blank. In other
	  words, if you set "callerid=" in the IAX config, then the
	  callerid should be overridden to blank, even if set on the
	  client. Note that there's a distinction, even on realtime,
	  between the field not existing (NULL in databases) and the field
	  existing, but set to blank (override callerid to blank). ........

	* include/asterisk/config.h, UPGRADE.txt, CHANGES, main/config.c:
	  Add '+=' append operator to configuration files.

2008-08-05 17:05 +0000 [r135680-135681]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/datastore.h, include/asterisk/channel.h:
	  datastore inheritance is a channel feature, so move this
	  definition back

	* apps/app_dial.c, funcs/func_speex.c, main/pbx.c, main/Makefile,
	  funcs/func_lock.c, pbx/pbx_lua.c, include/asterisk/channel.h,
	  apps/app_queue.c, channels/chan_iax2.c,
	  include/asterisk/manager.h, funcs/func_global.c,
	  apps/app_speech_utils.c, main/channel.c, funcs/func_enum.c,
	  main/manager.c, res/res_smdi.c, funcs/func_odbc.c,
	  funcs/func_volume.c, res/res_agi.c, include/asterisk/datastore.h
	  (added), pbx/pbx_dundi.c, main/audiohook.c, apps/app_chanspy.c,
	  apps/app_stack.c, main/datastore.c (added): make datastore
	  creation and destruction a generic API since it is not really
	  channel related, and add the ability to add/find/remove
	  datastores to manager sessions

2008-08-05 15:30 +0000 [r135648]  Tilghman Lesher <tlesher@digium.com>

	* build_tools/make_version: Always output a version string, even
	  when we can't figure out what we are. (Closes issue #13223)

2008-08-05 13:26 +0000 [r135598]  Sean Bright <sean.bright@gmail.com>

	* /, main/cli.c: Merged revisions 135597 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135597 | seanbright | 2008-08-05 09:25:00 -0400 (Tue, 05 Aug
	  2008) | 1 line Use PATH_MAX for filenames ........

2008-08-04 20:15 +0000 [r135537]  Russell Bryant <russell@digium.com>

	* configs/chan_dahdi.conf.sample, /: Merged revisions 135536 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135536 | russell | 2008-08-04 15:15:03 -0500 (Mon, 04 Aug 2008)
	  | 2 lines fix a config sample typo ........

2008-08-04 17:12 +0000 [r135476-135485]  Tilghman Lesher <tlesher@digium.com>

	* contrib/init.d/rc.mandriva.asterisk (added), Makefile,
	  contrib/init.d/rc.mandrake.asterisk (removed),
	  contrib/init.d/rc.mandriva.zaptel (added),
	  contrib/init.d/rc.mandrake.zaptel (removed): Rename Mandrake
	  scripts to Mandriva (Closes issue #13221)

	* contrib/init.d/rc.mandrake.asterisk, /: Merged revisions 135482
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135482 | tilghman | 2008-08-04 12:07:52 -0500 (Mon, 04 Aug 2008)
	  | 2 lines Define ASTSBINDIR for script (Closes issue #13221)
	  ........

	* /, apps/app_voicemail.c: Merged revisions 135479 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r135479 | tilghman | 2008-08-04 11:56:19 -0500 (Mon, 04
	  Aug 2008) | 6 lines Memory leak on unload (closes issue #13231)
	  Reported by: eliel Patches: app_voicemail.leak.patch uploaded by
	  eliel (license 64) ........

	* include/asterisk/http.h, main/http.c, res/res_http_post.c: HTTP
	  module memory leaks (closes issue #13230) Reported by: eliel
	  Patches: res_http_post_leak.patch uploaded by eliel (license 64)

2008-08-04 16:28 +0000 [r135439-135474]  Russell Bryant <russell@digium.com>

	* configs/chan_dahdi.conf.sample, /: Merged revisions 135473 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135473 | russell | 2008-08-04 11:26:17 -0500 (Mon, 04 Aug 2008)
	  | 2 lines Add a minor clarification to the documentation of
	  mohinterpret and mohsuggest ........

	* channels/chan_console.c: Be explicit that we don't want a result
	  from this callback. The callback would never indicate a match, so
	  nothing would have been returned anyway, but it was still a poor
	  example of proper usage.

2008-08-03 16:14 +0000 [r135405]  Sean Bright <sean.bright@gmail.com>

	* build_tools/cflags.xml, doc/hoard.txt (added),
	  build_tools/menuselect-deps.in, configure,
	  include/asterisk/autoconfig.h.in, main/Makefile, configure.ac,
	  CHANGES, makeopts.in: Merge in changes that allow Asterisk to be
	  built against the Hoard memory allocator. See doc/hoard.txt for
	  more details.

2008-08-03 00:03 +0000 [r135332-135373]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: whitespace fixes only.

	* channels/chan_skinny.c: Dont coredump on register of
	  non-configured devices (closes issue #13224) Reported by:
	  mvanbaak Patches: noncon.diff uploaded by wedhorn (license 30)
	  with whitespace fixes by me Tested by: wedhorn, mvanbaak

	* channels/chan_skinny.c: make this work again, and not segfault on
	  device registration

2008-08-02 13:21 +0000 [r135302]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_skinny.c: --enable-dev-mode is your friend :-)

2008-08-02 12:29 +0000 [r135300]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: pass device instead of session to
	  transmit_ functions. (closes issue #10396) Reported by: wedhorn
	  Patches: transmit3a.diff uploaded by wedhorn (license 30) Tested
	  by: wedhorn, mvanbaak

2008-08-02 04:51 +0000 [r135265]  Steve Murphy <murf@digium.com>

	* main/pbx.c, main/features.c: (closes issue #13202) Reported by:
	  falves11 Tested by: murf falves11 == The changes I introduce here
	  seem to clear up the problem for me. However, if they do not for
	  you, please reopen this bug, and we'll keep digging. The root of
	  this problem seems to be a subtle memory corruption introduced
	  when creating an extension with an empty extension name. While
	  valgrind cannot detect it outside of DEBUG_MALLOC mode, when
	  compiled with DEBUG_MALLOC, this is certain death. The code in
	  main/features.c is a puzzle to me. On the initial module load,
	  the code is attempting to add the parking extension before the
	  features.conf file has even been opened! I just wrapped the
	  offending call with an if() that will not try to add the
	  extension if the extension name is empty. THis seems to solve the
	  corruption, and let the "memory show allocations" work as one
	  would expect. But, really, adding an extension with an empty name
	  is a seriously bad thing to allow, as it will mess up all the
	  pattern matching algorithms, etc. So, I added a statement to the
	  add_extension2 code to return a -1 if this is attempted.

2008-08-01 21:56 +0000 [r135235]  Terry Wilson <twilson@digium.com>

	* main/http.c, res/res_http_post.c: Fix mime parsing by re-adding
	  support for passing headers to callback functions

2008-08-01 19:29 +0000 [r135197]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_mgcp.c: Remove some code that used to do something
	  but does not anymore, mainly to get rid of a shadow warning (but
	  this seemed legitimate enough to fix here instead of in my
	  branch). Thanks to putnopvut for taking a look as well.

2008-08-01 18:16 +0000 [r135158]  Russell Bryant <russell@digium.com>

	* configs/iax.conf.sample, channels/iax2.h, CHANGES,
	  channels/chan_iax2.c, channels/iax2-parser.c: Merge changes from
	  team/bbryant/keyrotation This set of changes enhances IAX2
	  encryption support by adding key rotation to provide enhanced
	  security. The key used for encryption is rotated right after the
	  call gets set up, and then again every few minutes. This was
	  discussed at the last AstriDevCon. For interoperability with
	  older versions of Asterisk, there is an option that disables key
	  rotation. (closes issue #13018) Reported by: bbryant Patches:
	  07072008__iax2_key_rotation.diff uploaded by bbryant (license 36)
	  Tested by: russell, bbryant

2008-08-01 17:09 +0000 [r135126-135128]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: Picky, picky, buildbot

	* channels/chan_sip.c, configs/sip.conf.sample: SIP should use the
	  transport type set in the Moved Temporarily for the next invite.
	  (closes issue #11843) Reported by: pestermann Patches:
	  20080723__issue11843_302_ignores_transport_16branch.diff uploaded
	  by bbryant (license 36)
	  20080723__issue11843_302_ignores_transport_trunk.diff uploaded by
	  bbryant (license 36) Tested by: pabelanger

2008-08-01 14:42 +0000 [r135067-135068]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: IMAP-specific items must go in IMAP_STORAGE
	  defines...

	* configs/voicemail.conf.sample, apps/app_voicemail.c: IMAP storage
	  functioned under the assumption that folders such as "Work" and
	  "Family" would be subfolders of the INBOX. This is an invalid
	  assumption to make, but it could be desirable to set up folders
	  in this manner, so a new option for voicemail.conf,
	  "imapparentfolder" has been added to allow for this. (closes
	  issue #13142) Reported by: jaroth Patches: parentfolder.patch
	  uploaded by jaroth (license 50)

2008-08-01 12:17 +0000 [r135056-135061]  Michiel van Baak <michiel@vanbaak.info>

	* contrib/scripts/safe_asterisk: Make safe_asterisk work on
	  dash/sh/bash etc. (closes issue #13111) Reported by: pabelanger
	  Patches: 2008071901_issue13111_safe_asterisk.diff uploaded by
	  mvanbaak (license 7) Tested by: mvanbaak, pabelanger

	* /, apps/app_ices.c: Merged revisions 135058 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r135058 | mvanbaak | 2008-08-01 13:43:46 +0200 (Fri, 01 Aug 2008)
	  | 2 lines make app_ices compile on OpenBSD. ........

	* /, channels/chan_skinny.c: Merged revisions 135055 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r135055 | mvanbaak | 2008-08-01 12:55:27 +0200 (Fri, 01
	  Aug 2008) | 8 lines fix some potential deadlocks in chan_skinny
	  (closes issue #13215) Reported by: qwell Patches:
	  2008080100_bug13215.diff.txt uploaded by mvanbaak (license 7)
	  Tested by: mvanbaak ........

2008-07-31 22:28 +0000 [r135016]  Kevin P. Fleming <kpfleming@digium.com>

	* /, main/http.c: Merged revisions 134983 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134983 | kpfleming | 2008-07-31 17:18:11 -0500 (Thu, 31 Jul
	  2008) | 3 lines accomodate users who seem to lack a sense of
	  humor :-) ........

2008-07-31 21:53 +0000 [r134925-134977]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_sqlite.c: Switch command order, to meet with
	  current specs

	* res/res_config_pgsql.c: Increase column size beyond the minimum
	  required, since PostgreSQL won't let us modify existing columns.

2008-07-31 19:48 +0000 [r134922]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 134883 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134883 | murf | 2008-07-31 13:23:42 -0600 (Thu, 31 Jul 2008) |
	  51 lines (closes issue #11849) Reported by: greyvoip Tested by:
	  murf OK, a few days of debugging, a bunch of instrumentation in
	  chan_sip, main/channel.c, main/pbx.c, etc. and 5 solid notebook
	  pages of notes later, I have made the small tweek necc. to get
	  the start time right on the second CDR when: A Calls B B answ. A
	  hits Xfer button on sip phone, A dials C and hits the OK button,
	  A hangs up C answers ringing phone B and C converse B and/or C
	  hangs up But does not harm the scenario where: A Calls B B answ.
	  B hits xfer button on sip phone, B dials C and hits the OK
	  button, B hangs up C answers ringing phone A and C converse A
	  and/or C hangs up The difference in start times on the second CDR
	  is because of a Masquerade on the B channel when the xfer number
	  is sent. It ends up replacing the CDR on the B channel with a
	  duplicate, which ends up getting tossed out. We keep a pointer to
	  the first CDR, and update *that* after the bridge closes. But,
	  only if the CDR has changed. I hope this change is specific
	  enough not to muck up any current CDR-based apps. In my defence,
	  I assert that the previous information was wrong, and this change
	  fixes it, and possibly other similar scenarios. I wonder if I
	  should be doing the same thing for the channel, as I did for the
	  peer, but I can't think of a scenario this might affect. I leave
	  it, then, as an exersize for the users, to find the scenario
	  where the chan's CDR changes and loses the proper start time.
	  ........ and as to 1.4 to trunk; have I expressed my feelings
	  about code shifting from one file to another? Good.

2008-07-31 19:43 +0000 [r134919]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_sqlite.c: Two errors: 1) If a function returns
	  SQLITE_LOCKED, no recovery is possible. 2) An error message can
	  be allocated, even when no error is signalled. (closes issue
	  #13109) Reported by: gknispel_proformatique

2008-07-31 19:39 +0000 [r134916-134917]  Russell Bryant <russell@digium.com>

	* /, apps/app_ices.c: Merged revisions 134915 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134915 | russell | 2008-07-31 14:37:26 -0500 (Thu, 31 Jul 2008)
	  | 9 lines Get app_ices working again (closes issue #12981)
	  Reported by: dlogan Patches:
	  20080709__app_ices_v2_update_trunk.diff uploaded by bbryant
	  (license 36) 20080709__app_ices_v2_update_14.diff uploaded by
	  bbryant (license 36) Tested by: bbryant ........

	* channels/iax2-parser.c: fix the potential use of an uninitialized
	  variable

2008-07-31 19:03 +0000 [r134867]  Tilghman Lesher <tlesher@digium.com>

	* channels/iax2-parser.c: Optimize frame cache by realloc'ing the
	  smallest frame when the cache is full. This ensures that we don't
	  just keep a cache of tiny frames, continually doing an alloc/free
	  for each data frame, thus negating the point of having a cache.

2008-07-31 16:50 +0000 [r134803-134815]  Russell Bryant <russell@digium.com>

	* channels/iax2-parser.c: Merged revisions 134814 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134814 | russell | 2008-07-31 11:45:31 -0500 (Thu, 31 Jul 2008)
	  | 7 lines In case we have some processing threads that free more
	  frames than they allocate, do not let the frame cache grow
	  forever. (closes issue #13160) Reported by: tavius Tested by:
	  tavius, russell ........

	* doc/tex/app-sms.tex, doc/tex/queuelog.tex: Fix some tex errors
	  (closes issue #13211) Reported by: eliel Patches:
	  fixtexerrors.patch uploaded by eliel (license 64)

2008-07-31 16:05 +0000 [r134759]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 134758 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134758 | mmichelson | 2008-07-31 10:56:18 -0500 (Thu, 31 Jul
	  2008) | 16 lines Add more timeout checks into app_queue,
	  specifically targeting areas where an unknown and potentially
	  long time has just elapsed. Also added a check to try_calling()
	  to return early if the timeout has elapsed instead of potentially
	  setting a negative timeout for the call (thus making it have *no*
	  timeout at all). (closes issue #13186) Reported by:
	  miquel_cabrespina Patches: 13186.diff uploaded by putnopvut
	  (license 60) Tested by: miquel_cabrespina ........

2008-07-30 22:38 +0000 [r134703]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/sched.h, main/sched.c: Oops, wrong define

2008-07-30 22:04 +0000 [r134653]  Steve Murphy <murf@digium.com>

	* /: blocking 134652 from trunk because this problem only applies
	  to 1.4

2008-07-30 21:40 +0000 [r134650]  Tilghman Lesher <tlesher@digium.com>

	* /, configure, configure.ac: Merged revisions 134649 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r134649 | tilghman | 2008-07-30 16:38:50 -0500 (Wed, 30
	  Jul 2008) | 4 lines Qwell pointed out, via IRC, that the previous
	  fix only worked when explicitly set. When nothing is set, and the
	  option is implied, it breaks, because configure sets the prefix
	  to 'NONE'. Fixing. ........

2008-07-30 21:05 +0000 [r134598]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Merged revisions 134556 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r134556 |
	  mmichelson | 2008-07-30 15:24:40 -0500 (Wed, 30 Jul 2008) | 7
	  lines Fix the parsing of the "reason" parameter in the Diversion:
	  header. (closes issue #13195) Reported by: woodsfsg ........

2008-07-30 20:38 +0000 [r134596]  Russell Bryant <russell@digium.com>

	* /, pbx/pbx_dundi.c: Merged revisions 134595 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134595 | russell | 2008-07-30 15:37:17 -0500 (Wed, 30 Jul 2008)
	  | 6 lines Reduce stack consumption by 12.5% of the max stack size
	  to fix a crash when compiled with LOW_MEMORY. (closes issue
	  #13154) Reported by: edantie ........

2008-07-30 20:24 +0000 [r134556]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Fix the parsing of the "reason" parameter in
	  the Diversion: header. (closes issue #13195) Reported by:
	  woodsfsg

2008-07-30 19:55 +0000 [r134541]  Russell Bryant <russell@digium.com>

	* funcs/func_curl.c, /: Merged revisions 134540 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134540 | russell | 2008-07-30 14:52:53 -0500 (Wed, 30 Jul 2008)
	  | 4 lines Fix a memory leak in func_curl. Every thread that used
	  this function leaked an allocation the size of a pointer.
	  (reported by jmls in #asterisk-dev) ........

2008-07-30 19:48 +0000 [r134481-134538]  Tilghman Lesher <tlesher@digium.com>

	* /, configure, configure.ac: Merged revisions 134536 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r134536 | tilghman | 2008-07-30 14:47:16 -0500 (Wed, 30
	  Jul 2008) | 4 lines Only override sysconfdir and mandir when
	  prefix=/usr (closes issue #13093) Reported by: pabelanger
	  ........

	* apps/app_queue.c: Let "roundrobin" also reference rrmemory, for
	  the 1.6 release (as described in UPGRADE-1.4.txt) (Closes issue
	  #13181)

	* /, res/res_agi.c: Merged revisions 134480 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134480 | tilghman | 2008-07-30 14:03:44 -0500 (Wed, 30 Jul 2008)
	  | 5 lines launch_netscript sometimes returns -1, which fails to
	  set AGISTATUS. Map failure to -1, so that AGISTATUS is always
	  set. (closes issue #13199) Reported by: smw1218 ........

2008-07-30 18:33 +0000 [r134476]  Mark Michelson <mmichelson@digium.com>

	* /, main/app.c: Merged revisions 134475 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134475 | mmichelson | 2008-07-30 13:31:47 -0500 (Wed, 30 Jul
	  2008) | 4 lines Fix a spot where a function could return without
	  bringing a channel out of autoservice. ........

2008-07-30 17:36 +0000 [r134401-134443]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: Document adaptive capabilities

	* res/res_config_sqlite.c: Add adaptive capabilities to the sqlite
	  realtime driver (closes issue #13097) Reported by:
	  gknispel_proformatique Patches: 20080730__bug13097.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: Corydon76

	* configs/iax.conf.sample, configs/chan_dahdi.conf.sample,
	  channels/chan_sip.c, main/features.c, configs/sip.conf.sample,
	  configs/skinny.conf.sample, CHANGES: Move implementation of an
	  attended-transfer-complete sound from one channel driver into a
	  common place for multiple channel drivers. (closes issue #13152)
	  Reported by: caio1982 Patches: atxfer_complete_sound3.diff
	  uploaded by caio1982 (license 22)

2008-07-30 15:32 +0000 [r134355]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, /: Merged revisions 134352 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r134352 | kpfleming | 2008-07-30 10:29:17 -0500 (Wed, 30 Jul
	  2008) | 2 lines use the proper method for building version.h
	  ........

2008-07-30 15:30 +0000 [r134312-134353]  Tilghman Lesher <tlesher@digium.com>

	* doc/tex/cliprompt.tex, main/asterisk.c: Add %u and %g to the
	  ASTERISK_PROMPT settings, for username and group, respectively.
	  Also, take the opportunity to clean up the CLI prompt generation
	  code. (closes issue #13175) Reported by: eliel Patches:
	  cliprompt.patch uploaded by eliel (license 64)

	* Makefile: Minor changes to reduce packaging changes made by the
	  Fedora maintainer. (closes issue #12974) Reported by: jcollie
	  Patches: 0001-Don-t-override-duplicate-optimization-flags.patch
	  uploaded by jcollie (license 412)

2008-07-29 22:22 +0000 [r134260]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_dahdibarge.c, channels/chan_dahdi.c, /,
	  apps/app_meetme.c, apps/app_dahdiscan.c, apps/app_dahdiras.c,
	  apps/app_rpt.c: build against the now-typedef-free dahdi/user.h,
	  and remove some #ifdefs for features that will always be present
	  in DAHDI

2008-07-29 21:23 +0000 [r134253]  Brett Bryant <bbryant@digium.com>

	* main/http.c: Fix deadlock when unloading res_http_post because
	  the uris lock was still locked.

2008-07-28 22:07 +0000 [r134162-134163]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 134161 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r134161 | tilghman | 2008-07-28 16:50:50 -0500 (Mon, 28
	  Jul 2008) | 7 lines Detect when sox fails to raise the volume,
	  because sox can't read the file. (closes issue #12939) Reported
	  by: rickbradley Patches: 20080728__bug12939.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: rickbradley ........

	* /: Restore properties mistakenly removed (broke merging)

2008-07-28 19:53 +0000 [r134125]  Mark Michelson <mmichelson@digium.com>

	* configure, main/Makefile, configure.ac, CHANGES: This commit
	  compensates for buggy poll(2) implementations. Asterisk has, for
	  a long time, had its own implementation of poll(2) which just
	  used the input arguments to call select(2). In 1.4, this internal
	  implementation was used for Darwin systems. This was removed in
	  Asterisk trunk at some point, but it seems as though this was not
	  the right move to make. On Mac OS X, it appears as though the
	  poll used to gather CLI input does not respond properly when
	  connecting via a remote Asterisk console. Reverting to the use of
	  Asterisk's poll fixed the issue. Also, there is now an option for
	  the configure script, --enable-internal-poll, which will allow
	  for anyone to use Asterisk's internal poll implementation in case
	  they suspect that their system's poll implementation is buggy.
	  closes issue #11928) Reported by: adriavidal Patches:
	  1.6.0-configurev2.patch uploaded by putnopvut (license 60)

2008-07-28 16:49 +0000 [r134088]  Tilghman Lesher <tlesher@digium.com>

	* UPGRADE.txt, apps/app_image.c, CHANGES: Change SendImage() to
	  output a more consistent status variable. (closes issue #13134)
	  Reported by: eliel Patches: app_image.c.patch uploaded by eliel
	  (license 64) UPGRADE.patch uploaded by eliel (license 64)

2008-07-28 16:42 +0000 [r134086]  Kevin P. Fleming <kpfleming@digium.com>

	* build_tools/cflags.xml, main/channel.c, apps/app_dahdibarge.c,
	  channels/chan_dahdi.c, configs/chan_dahdi.conf.sample,
	  doc/ss7.txt, apps/app_dahdiscan.c, apps/app_dahdiras.c,
	  doc/osp.txt, pbx/pbx_config.c, apps/app_parkandannounce.c,
	  main/loader.c, sample.call, contrib/scripts/autosupport: remove
	  remaining Zaptel references in various places

2008-07-28 16:00 +0000 [r134050]  Mark Michelson <mmichelson@digium.com>

	* apps/app_meetme.c, apps/app_dahdiscan.c, apps/app_chanspy.c,
	  main/asterisk.c: merging the zap_and_dahdi_trunk branch up to
	  trunk

2008-07-27 21:12 +0000 [r134005]  Russell Bryant <russell@digium.com>

	* funcs/func_config.c, /: Add a missing unlock within error
	  handling (closes issue #13176) Reported by: pj

2008-07-26 15:16 +0000 [r133941-133946]  Russell Bryant <russell@digium.com>

	* main/devicestate.c: actually use the cache_cache argument

	* main/devicestate.c: ast_device_state() gets called in two
	  different ways. The first way is when called from elsewhere in
	  Asterisk to find the current state of a device. In that case, we
	  want to use the cached value if it exists. The other way is when
	  processing a device state change. In that case, we do not want to
	  check the cache because returning the last known state is counter
	  productive.

	* main/devicestate.c: Re-work comment about how device state
	  changes are processed to be a bit more clear

	* main/devicestate.c: Remove the code that decided when device
	  state changes should be cached or not. It is no longer needed.

2008-07-25 22:08 +0000 [r133860-133904]  Tilghman Lesher <tlesher@digium.com>

	* doc/lang/hebrew.ods, apps/app_voicemail.c: Hebrew syntax for
	  voicemail prompts (closes issue #13155) Reported by:
	  greenfieldtech Patches: app_voicemail.c.patch uploaded by
	  greenfieldtech (license 369) hebrew.ods uploaded by
	  greenfieldtech (license 369)

	* contrib/scripts/asterisk.ldif: Update version (closes issue
	  #13163) Reported by: suretec Patches: asterisk.ldif uploaded by
	  suretec (license 70)

	* main/channel.c, channels/chan_dahdi.c,
	  include/asterisk/devicestate.h, channels/chan_sip.c,
	  channels/chan_skinny.c, channels/chan_agent.c,
	  main/devicestate.c, channels/chan_iax2.c: Deprecate
	  *_device_state_* APIs in favor of *_devstate_* APIs

2008-07-25 20:56 +0000 [r133819]  Kevin P. Fleming <kpfleming@digium.com>

	* main/logger.c: minor change to test automerge

2008-07-25 19:12 +0000 [r133770]  Brandon Kruse <bkruse@digium.com>

	* main/manager.c: Revert tilghman and pari's code changes, as we do
	  NOT need to uri_decode in manager. (if I sent
	  core%20show%20channels from a telnet session, it should be
	  interpreted literally, however, if I send that from an http
	  session, it should be decoded, which is the behaivor now)

2008-07-25 17:24 +0000 [r133665]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c, /, channels/chan_agent.c, main/devicestate.c:
	  Merged revisions 133649 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r133649 | tilghman | 2008-07-25 12:19:39 -0500 (Fri, 25 Jul 2008)
	  | 8 lines Fix some errant device states by making the devicestate
	  API more strict in terms of the device argument (only without the
	  unique identifier appended). (closes issue #12771) Reported by:
	  davidw Patches: 20080717__bug12771.diff.txt uploaded by Corydon76
	  (license 14) Tested by: davidw, jvandal, murf ........

2008-07-25 17:21 +0000 [r133651]  Brandon Kruse <bkruse@digium.com>

	* main/http.c: Committing a fix that was introduced a long time ago
	  (does not affect 1.4), where you would pass a pointer to the end
	  of a character array, and ast_uri_decode would do no good.

2008-07-25 15:00 +0000 [r133575-133579]  Russell Bryant <russell@digium.com>

	* /, LICENSE: Merged revisions 133578 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r133578 | russell | 2008-07-25 10:00:31 -0500
	  (Fri, 25 Jul 2008) | 10 lines Merged revisions 133577 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r133577 | russell | 2008-07-25 10:00:13 -0500 (Fri, 25 Jul 2008)
	  | 2 lines Fix the IAX2 URI for calling Digium ........
	  ................

	* include/asterisk/doxyref.h, main/asterisk.c: Modify the main page
	  of the doxygen documentation to link to a new page dedicated to
	  Asterisk licensing information. The licensing page includes the
	  Asterisk license, as well as a (not yet complete) list of 3rd
	  party libraries that may be used, as well as what license we
	  receive them under. Help filling out this list in the format that
	  I have started in doxyref.h would be much appreciated. :)

2008-07-25 14:40 +0000 [r133570-133573]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 133572 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r133572 | mmichelson | 2008-07-25 09:40:10 -0500 (Fri, 25 Jul
	  2008) | 7 lines We need to make sure to null-terminate the "name"
	  portion of SIP URI parameters so that there are no bogus
	  comparisons. Thanks to bbryant for pointing this out. ........

	* apps/app_queue.c: Add a missing unlock. Pointed out by Atis
	  Lezdins in #asterisk-dev

2008-07-25 13:01 +0000 [r133566-133568]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Minor coding guidelines tweaks ... - Use
	  ast_strlen_zero in one place - check for successful string
	  comparison the way most of Asterisk code does it

	* main/devicestate.c: When the ast_device_state() function is
	  called to retrieve device state, and the code checks to see if
	  there is a cached state available, use the aggregate cached state
	  across all servers, and not just the local state.

2008-07-24 21:27 +0000 [r133509]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 133488 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r133488 | tilghman | 2008-07-24 16:17:55 -0500 (Thu, 24 Jul 2008)
	  | 3 lines Fix rtautoclear and rtcachefriends (Closes issue
	  #12707) ........

2008-07-24 20:40 +0000 [r133486]  Russell Bryant <russell@digium.com>

	* channels/chan_agent.c: I made this change from DEVICE_STATE to
	  DEVICE_STATE_CHANGE, but I had it backwards, this is the right
	  event to subscribe to ...

2008-07-24 19:53 +0000 [r133448]  Mark Michelson <mmichelson@digium.com>

	* main/logger.c: Print the correct PID in log messages. Prior to
	  this commit, only the logger thread's PID would be printed.
	  (closes issue #13150) Reported by: atis Patches: log_pid.diff
	  uploaded by putnopvut (license 60) Tested by: eliel

2008-07-24 05:21 +0000 [r133391-133400]  Tilghman Lesher <tlesher@digium.com>

	* Makefile, contrib/scripts/asterisk.logrotate: Build the logrotate
	  script according to paths (Closes issue #13147)

	* Makefile: Optionally install logrotate file (Closes issue #13148)

2008-07-23 22:03 +0000 [r133299]  Steve Murphy <murf@digium.com>

	* main/pbx.c: (closes issue #13144) Reported by: murf Tested by:
	  murf For: J. Geis The 'data' field in the ast_exten struct was
	  being 'moved' from the current dialplan to the replacement
	  dialplan. This was not good, as the current dialplan could have
	  problems in the time between the change and when the new dialplan
	  is swapped in. So, I modified the merge_and_delete code to strdup
	  the 'data' field (the args to the app call), and then it's freed
	  as normal. I improved a few messages; I added code to limit the
	  number of calls to the
	  context_merge_incls_swits_igps_other_registrars() to one per
	  context. I don't think having it called multiple times per
	  context was doing anything bad, but it was inefficient. I hope
	  this fixes the problems Mr. Geiss was noting in asterisk-users,
	  see
	  http://lists.digium.com/pipermail/asterisk-users/2008-July/215634.html

2008-07-23 21:50 +0000 [r133296]  Jason Parker <jparker@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 133295 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r133295 | qwell | 2008-07-23 16:49:03 -0500 (Wed, 23 Jul
	  2008) | 1 line inbandrelease is gone - it's now inbanddisconnect
	  ........

2008-07-23 20:33 +0000 [r133197]  Brett Bryant <bbryant@digium.com>

	* channels/chan_sip.c: Fix issue where tcp in sip is enabled by
	  default, despite what it says in the config sample file. Also fix
	  "sip show settings" for tcp connections.

2008-07-23 19:48 +0000 [r133041-133171]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_chanspy.c, include/asterisk/options.h,
	  main/asterisk.c: Merged revisions 133169 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r133169 | mmichelson | 2008-07-23 14:39:47 -0500 (Wed, 23 Jul
	  2008) | 12 lines As suggested by seanbright, the PSEUDO_CHAN_LEN
	  in app_chanspy should be set at load time, not at compile time,
	  since dahdi_chan_name is determined at load time. Also changed
	  the next_unique_id_to_use to have the static qualifier. Also
	  added the dahdi_chan_name_len variable so that
	  strlen(dahdi_chan_name) isn't necessary. Thanks to seanbright for
	  the suggestion. ........

	* /, apps/app_chanspy.c: Merged revisions 133104 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r133104 | mmichelson | 2008-07-23 14:06:16 -0500 (Wed, 23 Jul
	  2008) | 5 lines Zap/pseudo is ten characters, but DAHDI/pseudo is
	  twelve. The strncmp call in next_channel should account for this.
	  ........

	* /, apps/app_chanspy.c: Merged revisions 133101 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r133101 | mmichelson | 2008-07-23 13:57:17 -0500 (Wed, 23 Jul
	  2008) | 6 lines Update the "last" channel in next_channel in
	  app_chanspy so that the same pseudo channel isn't constantly
	  returned. related to issue #13124 ........

	* channels/chan_dahdi.c, /: Merged revisions 133038 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r133038 | mmichelson | 2008-07-23 12:50:01 -0500 (Wed,
	  23 Jul 2008) | 7 lines Small cleanup. Move the declaration of the
	  DAHDI_SPANINFO variable to the block where it is used. This
	  allows one less #ifdef HAVE_PRI to clutter things up. Thanks to
	  Tzafrir for pointing this out on #asterisk-dev ........

2008-07-23 17:20 +0000 [r132977-132981]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_iax2.c: Yet another conversion of '|' to ','
	  (closes issue #13137) Reported by: eliel Patches:
	  chan_iax2trunk-IAXPEER.patch uploaded by eliel (license 64)

	* contrib/scripts/asterisk.logrotate (added): Add logrotate script
	  for Asterisk (closes issue #13085) Reported by: pabelanger
	  Patches: logrotate uploaded by pabelanger (license 224)

2008-07-23 16:38 +0000 [r132964-132966]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/misdn/isdn_lib.c: use correct function name... please
	  compile with --enable-dev-mode

	* /, main/utils.c, include/asterisk/stringfields.h: Merged
	  revisions 132872 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r132872 | kpfleming | 2008-07-23 06:52:18 -0500 (Wed, 23 Jul
	  2008) | 2 lines minor optimization for stringfields: when a field
	  is being set to a larger value than it currently contains and it
	  happens to be the most recent field allocated from the currentl
	  pool, it is possible to 'grow' it without having to waste the
	  space it is currently using (or potentially even allocate a new
	  pool) ........

2008-07-23 12:07 +0000 [r132883]  Christian Richter <christian.richter@beronet.com>

	* /, channels/misdn/isdn_lib.c: Merged revisions 132826 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r132826 | crichter | 2008-07-23 13:37:50 +0200 (Mi, 23 Jul 2008)
	  | 1 line another Fix because of r119585, this commit has broken
	  high frequented BRI Ports, there was a possibility that a
	  channel, that was marked as in_use would be reused later, the
	  corresponding port could got stuck then. So it is recommended to
	  upgrade for chan_misdn users. ........

2008-07-23 11:40 +0000 [r132827]  Kevin P. Fleming <kpfleming@digium.com>

	* /: remove bogus property that is breaking automerges

2008-07-23 08:13 +0000 [r132823]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Well, the content of a channel variable may
	  be longer than the size of a pointer... Thanks, eliel! Reported
	  by: eliel Patches: chan_siptrunk.SIPPEER.patch uploaded by eliel
	  (license 64) (closes issue #13135)

2008-07-22 22:17 +0000 [r132795]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 132777 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ Allow
	  Spiraled INVITEs to work correctly within Asterisk. Prior to this
	  change, a spiraled INVITE would cause a 482 Loop Detected to be
	  sent to the caller. With this change, if a potential loop is
	  detected, the Request-URI is inspected to see if it has changed
	  from what was originally received. If pedantic mode is on, then
	  this inspection is fully RFC 3261 compliant. If pedantic mode is
	  not on, then a string comparison is used to test the equality of
	  the two R-URIs. This has been tested by using OpenSER to rewrite
	  the R-URI and send the INVITE back to Asterisk. (closes issue
	  #7403) Reported by: stephen_dredge Modified:
	  branches/1.4/channels/chan_sip.c ........

2008-07-22 22:14 +0000 [r132791]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c: correct fix made in r132777... the code
	  *did* compile in dev-mode, as long as libpri was installed and
	  enabled

2008-07-22 21:53 +0000 [r132778]  Tilghman Lesher <tlesher@digium.com>

	* configs/iax.conf.sample, /, channels/chan_iax2.c: Merged
	  revisions 132713 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r132713 | tilghman | 2008-07-22 16:19:39 -0500
	  (Tue, 22 Jul 2008) | 10 lines Merged revisions 132711 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r132711 | tilghman | 2008-07-22 16:14:10 -0500 (Tue, 22 Jul 2008)
	  | 2 lines Fixes for AST-2008-010 and AST-2008-011 ........
	  ................

2008-07-22 21:52 +0000 [r132777]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_dahdi.c: Get chan_dahdi to compile in devmode

2008-07-22 21:21 +0000 [r132705-132721]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 132712 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r132712 | kpfleming | 2008-07-22 16:17:23 -0500 (Tue, 22
	  Jul 2008) | 6 lines ensure that if any alarms exist at channel
	  creation time, they are handled identically to if they occurred
	  later, so that later alarm clearing will work properly and 'make
	  sense' (closes issue #12160) Reported by: tzafrir ........

	* /, configure, configure.ac, acinclude.m4: Merged revisions 132704
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r132704 | kpfleming | 2008-07-22 15:49:41 -0500 (Tue, 22 Jul
	  2008) | 2 lines make AST_C_COMPILE_CHECK able to print a 'pretty'
	  description of what it is doing ........

2008-07-22 20:46 +0000 [r132703]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c, doc/sip-retransmit.txt (added): Merged
	  revisions 132645 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r132645 | oej | 2008-07-22 22:10:26 +0200 (Tis, 22 Jul 2008) | 9
	  lines The most common question on the #asterisk iRC channel and
	  on mailing lists seems to be in regards to an error message when
	  retransmit fails. This is frequently misunderstood as a failure
	  of Asterisk, not a failure of the network to reach the other
	  party. This document tries to assist the Asterisk user in sorting
	  out these issues by explaining the logic and pointing at some
	  possible causes. Hopefully, we will get other questions now :-)
	  ........

2008-07-22 19:59 +0000 [r132573-132643]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample, /,
	  configure, include/asterisk/autoconfig.h.in, configure.ac: Merged
	  revisions 132641 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r132641 | kpfleming | 2008-07-22 14:49:11 -0500 (Tue, 22 Jul
	  2008) | 2 lines use renamed libpri API call for controlling this
	  feature (was improperly named before) ........

	* channels/chan_dahdi.c, /: Merged revisions 132571 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r132571 | kpfleming | 2008-07-21 17:45:16 -0500 (Mon, 21
	  Jul 2008) | 2 lines teach chan_dahdi how to find the D-channel on
	  BRI spans, and don't attempt to use channel 24 as a D-channel on
	  spans of unexpected sizes ........

2008-07-21 22:49 +0000 [r132514-132572]  Brett Bryant <bbryant@digium.com>

	* channels/chan_iax2.c: Add autocompletion to "iax2 set debug
	  peer". (closes issue #13129) Reported by: eliel Patches:
	  chan_iax2.c.patch uploaded by eliel (license 64)

	* configs/gtalk.conf.sample, configs/jingle.conf.sample,
	  configs/manager.conf.sample, configs/features.conf.sample: Update
	  configuration files to add missing options for jingle, gtalk,
	  manager.conf, and features.conf. (closes issue #13128) Reported
	  by: caio1982 Patches: missing_options1.diff uploaded by caio1982
	  (license 22)

2008-07-21 21:00 +0000 [r132510-132511]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/fskmodem.h (added), main/fskmodem.c (added):
	  (Step 2 of 2)

	* include/asterisk/fskmodem_int.h (added), build_tools/cflags.xml,
	  main/fskmodem_float.c (added), main/tdd.c,
	  include/asterisk/fskmodem.h (removed), main/fskmodem_int.c
	  (added), main/callerid.c, include/asterisk/fskmodem_float.h
	  (added), main/fskmodem.c (removed): Optionally build
	  integer-based routines for FSK tone decoding (but default to the
	  more accurate float-based routines). (Closes issue #11679) (Step
	  1 of 2)

2008-07-21 20:54 +0000 [r132466-132508]  Brett Bryant <bbryant@digium.com>

	* apps/app_sendtext.c: Fix a bug where SENDTEXTSTATUS isn't set
	  properly when it isn't supported on a channel (yet _another_
	  useful patch by eliel). (closes issue #13081) Reported by: eliel
	  Patches: app_sendtext.c.patch uploaded by eliel (license 64)
	  Tested by: eliel

	* channels/chan_iax2.c: Add "iax2 set debug peer" command and
	  remove deprecated iax2 debug commands that conflicted with adding
	  new features to the newer debug commaands. (closes issue #13103)
	  Reported by: mvanbaak Patches:
	  2008071901__issue13103_iax2_set_debug_peer.diff uploaded by
	  mvanbaak (license 7) Tested by: bbryant, mvanbaak

	* channels/chan_sip.c: Fix bug where ast_parse_arg would
	  inadvertantly enable sip tcp when parsing a tcpbindaddr if it was
	  disabled. (closes issue #13117) Reported by: pj

	* channels/chan_iax2.c: Fix an issue in iax2 where a call that's
	  been rejected still kept an open channel on the side that
	  attempted to make the call (not the side of the call that
	  rejected the call). Changes were load tested and also approved by
	  Russell.

2008-07-21 15:33 +0000 [r132425]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: make buffers config option
	  (chan_dahdi.conf) parsing safer and added logging in case of
	  failure

2008-07-21 14:47 +0000 [r132388-132390]  Russell Bryant <russell@digium.com>

	* include/asterisk/libresample.h (removed),
	  build_tools/menuselect-deps.in, configure,
	  include/asterisk/autoconfig.h.in, main/Makefile, main/libresample
	  (removed), configure.ac, codecs/codec_resample.c, makeopts.in,
	  apps/app_jack.c: Remove libresample from the Asterisk source
	  tree. It is now available in its own repository, and must be
	  installed like any other library for Asterisk to use. The two
	  modules that require it are codec_resample and app_jack. To
	  install libresample: $ svn co
	  http://svn.digium.com/svn/libresample/trunk libresample $ cd
	  libresample $ ./configure $ make $ sudo make install This code is
	  currently in our own repository because the build system did not
	  include the appropriate targets for building a dynamic library or
	  for installing the library.

	* codecs/codec_resample.c, apps/app_jack.c: Enable higher quality
	  resampling, as it doesn't have a noticeable performance impact on
	  my machine ..

2008-07-19 16:46 +0000 [r132312]  Kevin P. Fleming <kpfleming@digium.com>

	* /, LICENSE: Merged revisions 132311 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r132311 | kpfleming | 2008-07-19 11:45:52 -0500 (Sat, 19 Jul
	  2008) | 2 lines grant a license exception to allow distribution
	  of Asterisk binaries that use the UW IMAP Toolkit (which is
	  licensed under a non-GPL-compatible license) ........

2008-07-19 10:46 +0000 [r132277]  Michiel van Baak <michiel@vanbaak.info>

	* res/res_config_sqlite.c: fix a couple of comments in sqlite
	  resource driver. (closes issue #13110) Reported by:
	  gknispel_proformatique Patches: res_config_sqlite_comments.patch
	  uploaded by gknispel (license 261)

2008-07-18 22:19 +0000 [r132242]  Brett Bryant <bbryant@digium.com>

	* main/manager.c: Fixes problem where manager users loaded from
	  users.conf would be removed early (before the routine to load the
	  configuration was finished) because a variable wasn't
	  initialized.

2008-07-18 20:57 +0000 [r132203-132206]  Tilghman Lesher <tlesher@digium.com>

	* main/manager.c: Russell pointed out that using ast_strdupa()
	  within a loop like this is probably not a good idea, as we might
	  run out of stack space. Therefore, changing this over to use the
	  ast_str infrastructure for buffers is probably a good idea.

	* main/manager.c: Fix trunk devmode

2008-07-18 20:14 +0000 [r132169]  Pari Nannapaneni <paripurnachand@digium.com>

	* main/manager.c: updateconfig is not uri decoding variables,values
	  from the GET url

2008-07-18 19:09 +0000 [r132109-132113]  Tilghman Lesher <tlesher@digium.com>

	* /, main/say.c: Merged revisions 132112 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r132112 | tilghman | 2008-07-18 14:06:10 -0500 (Fri, 18 Jul 2008)
	  | 6 lines Fix for Taiwanese number syntax (closes issue #12319)
	  Reported by: CharlesWang Patches: saynumber-tw-1.4.18.1.patch
	  uploaded by CharlesWang (license 444) ........

	* /, main/config.c: Merged revisions 132107 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r132107 | tilghman | 2008-07-18 13:47:50 -0500 (Fri, 18 Jul 2008)
	  | 6 lines Textual clarification (closes issue #13106) Reported
	  by: flefoll Patches: config.c.br14.120173.patch-unknown-directive
	  uploaded by flefoll (license 244) ........

2008-07-18 18:50 +0000 [r132108]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: Make sure we break the poll so that
	  messages queued will be sent on the SS7 when using CLI commands
	  for blocking and blocking of CICs and linksets.

2008-07-18 17:55 +0000 [r132050]  Brett Bryant <bbryant@digium.com>

	* main/hashtab.c, cdr/cdr_radius.c: Fix magic Revision keywords in
	  hashtab.c and change cdr_radius.c to use the same keyword as the
	  other files (patch by eliel). (closes issue #13104) Reported by:
	  eliel Patches: revision.patch uploaded by eliel (license 64)

2008-07-18 17:10 +0000 [r131982-131989]  Tilghman Lesher <tlesher@digium.com>

	* /, main/sched.c: Merged revisions 131988 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131988 | tilghman | 2008-07-18 12:10:01 -0500 (Fri, 18 Jul 2008)
	  | 2 lines Oops ........

	* /, include/asterisk/sched.h, main/sched.c: Merged revisions
	  131985 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131985 | tilghman | 2008-07-18 11:46:23 -0500 (Fri, 18 Jul 2008)
	  | 2 lines Preserve ABI compatibility with last change ........

	* /, include/asterisk/sched.h, channels/chan_iax2.c, main/sched.c:
	  Merged revisions 131970 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131970 | tilghman | 2008-07-18 11:30:31 -0500 (Fri, 18 Jul 2008)
	  | 2 lines Make the ast_assert call within ast_sched_del report
	  something useful. ........

2008-07-18 16:16 +0000 [r131923]  Kevin P. Fleming <kpfleming@digium.com>

	* /, main/Makefile, include/asterisk/dlfcn-compat.h (removed),
	  main/dlfcn.c (removed), main/loader.c: Merged revisions 131921
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131921 | kpfleming | 2008-07-18 11:15:41 -0500 (Fri, 18 Jul
	  2008) | 2 lines remove the dlfcn compatibility stuff, because no
	  platforms that Asterisk currently runs on it use it, and it
	  doesn't build anyway ........

2008-07-18 15:38 +0000 [r131916]  Brett Bryant <bbryant@digium.com>

	* /, main/features.c: Merged revisions 131915 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131915 | bbryant | 2008-07-18 10:34:42 -0500 (Fri, 18 Jul 2008)
	  | 4 lines Fix a bug in blind transfers where the BLINDTRANSFER
	  variable isn't always set to the other end of the blind transfer.
	  (closes issue #12586) ........

2008-07-17 22:40 +0000 [r131868]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: Add configuration option to
	  chan_dahdi.conf to allow buffering policy and number of buffers
	  to be configured per channel. Syntax: buffers=<num of
	  buffers>,<policy> Where the number of buffers is some
	  non-negative integer and the policy is either "full", "half", or
	  "immediate".

2008-07-17 21:26 +0000 [r131824]  Mark Michelson <mmichelson@digium.com>

	* apps/app_senddtmf.c: Document that the duration of dtmf may be
	  passed to the SendDTMF application. Also correct the default
	  pause between digits. (closes issue #13102) Reported by: eliel
	  Patches: app_senddtmf.c.patch uploaded by eliel (license 64)

2008-07-17 20:37 +0000 [r131753-131791]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 131790 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r131790 | tilghman | 2008-07-17 15:35:44 -0500 (Thu, 17
	  Jul 2008) | 7 lines Revert part of issue #5620 (revision 6965) as
	  it appears that it was in error. This should fix talk call
	  progress on analog lines. (closes issue #12178) Reported by:
	  michael-fig Patches: 20080717__bug12178.diff.txt uploaded by
	  Corydon76 (license 14) ........

	* res/res_config_sqlite.c: Fix memory leaks (closes issue #13099)
	  Reported by: gknispel_proformatique Patches:
	  res_config_sqlite_leak_on_error.patch uploaded by gknispel
	  (license 261)

2008-07-17 18:14 +0000 [r131717]  Brett Bryant <bbryant@digium.com>

	* main/features.c: Fix a memory leak in register_group_feature when
	  attempting to register a feature without specifying a group or
	  feature to register. (closes issue #13101) Reported by: eliel
	  Patches: features.c.patch uploaded by eliel (license 64)

2008-07-17 15:45 +0000 [r131681]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_sqlite.c: Fix memory leak. (Closes issue #13096)
	  Reported by gknispel_proformatique

2008-07-17 14:46 +0000 [r131643]  Russell Bryant <russell@digium.com>

	* channels/chan_agent.c: Instead of attempting to pass through
	  AST_EVENT_DEVICE_STATE, use DEVICE_STATE_CHANGE instead.
	  DEVICE_STATE is a state change on one server, and
	  DEVICE_STATE_CHANGE is the "real" state of that device across all
	  servers sharing state. This would have only been a problem with
	  distributed device state.

2008-07-17 14:00 +0000 [r131606]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, UPGRADE.txt, CHANGES: Change several 'core' commands
	  to be 'dialplan' commands (with appropriate deprecation, of
	  course) (closes issue #13016) Reported by: caio1982 Patches:
	  dialplan_globals6.diff uploaded by caio1982 (license 22)

2008-07-16 23:53 +0000 [r131570]  Steve Murphy <murf@digium.com>

	* include/asterisk/lock.h: (closes issue #13089) Reported by: murf
	  Most of this bug was already fixed by Tilghman before I opened
	  it; Many thanks to Tilghman for his fix in svn version 125794.
	  That fix cleared up some of the fields in the lock_info. This
	  commit changes the address that is stored for the lock in the
	  lock_info struct, so that it is the same as that passed into the
	  locking macros. This makes searching for a lock_info (as in
	  log_show_lock()) by its lock addr possible. The lock_addr field
	  is infinitely more useful if it is the same as what is 'publicly'
	  available outside the lock_info code. Many thanks to kpfleming,
	  putnopvut, and Russell for their invaluable insights earlier
	  today.

2008-07-16 22:28 +0000 [r131445-131529]  Brett Bryant <bbryant@digium.com>

	* apps/app_rpt.c: Janitor project: convert free to ast_free (closes
	  issue #13082) Reported by: eliel Patches: app_rpt.c.patch
	  uploaded by eliel (license 64)

	* /, channels/chan_iax2.c: Merged revisions 131491 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r131491 | bbryant | 2008-07-16 17:17:07 -0500 (Wed, 16
	  Jul 2008) | 6 lines Fix a bug in iax2 registration that allowed
	  peers to register with case-insensitive names (user_cmp_cb and
	  peer_cmp_cb are now both case-sensitive). (closes issue #13091)
	  ........

	* funcs/func_sysinfo.c: Fixes sysinfo operator issue also fixed
	  elsewhere in r131445. (issue #13057)

	* main/asterisk.c: Fixes an issue with "core show sysinfo" that
	  used the wrong operator to calculate the number of bytes from a
	  sysinfo structure. unsigned long. (closes issue #13057) Reported
	  by: eliel Patches: asterisk.c.patch uploaded by eliel (license
	  64)

2008-07-16 20:48 +0000 [r131422]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 131421 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r131421 | russell | 2008-07-16 15:47:53 -0500 (Wed, 16
	  Jul 2008) | 7 lines Always ensure that the channel's tech_pvt
	  reference is NULL after calling the destroy callback. (closes
	  issue #13060) Reported by: jpgrayson Patches:
	  chan_iax2_tech_pvt_crash.patch uploaded by jpgrayson (license
	  492) ........

2008-07-16 20:24 +0000 [r131300-131375]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 131369 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131369 | mmichelson | 2008-07-16 15:23:02 -0500 (Wed, 16 Jul
	  2008) | 14 lines Move the init_queue call back to where it used
	  to be (changed Sept 12 last year). It was moved then to prevent a
	  memory leak. Since then, the same memory leak recurred and was
	  fixed in a better way. Now it has been found that the placement
	  of this init_queue call can cause problems if a realtime queue
	  has values changed to an empty string. The problem is that the
	  default value for that queue parameter would not be set. (closes
	  issue #13084) Reported by: elbriga ........

	* res/res_config_sqlite.c: Don't try to dereference the dbfile
	  pointer if we know that it's NULL. (closes issue #13092) Reported
	  by: gknispel_proformatique Patches:
	  trunk_sqlite_check_vars_null.patch uploaded by gknispel (license
	  261)

	* /, apps/app_queue.c: Merged revisions 131357 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131357 | mmichelson | 2008-07-16 14:37:08 -0500 (Wed, 16 Jul
	  2008) | 6 lines Apparently, "thread safety" is important,
	  whatever that means. :P (Thanks Russell!) ........

	* /, apps/app_queue.c: Merged revisions 131299 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131299 | mmichelson | 2008-07-16 13:57:34 -0500 (Wed, 16 Jul
	  2008) | 13 lines Make absolutely certain that the transfer
	  datastore is removed from the calling channel once the caller is
	  finished in the queue. This could have weird con- sequences when
	  dialing local queue members when multiple transfers occur on a
	  single call. Also fixed a memory leak that would occur when an
	  attended transfer occurred from a queue member. (closes issue
	  #13047) Reported by: festr ........

2008-07-16 17:59 +0000 [r131243]  Steve Murphy <murf@digium.com>

	* res/ael/pval.c, /: Merged revisions 131242 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131242 | murf | 2008-07-16 11:53:43 -0600 (Wed, 16 Jul 2008) |
	  19 lines (closes issue #13090) Reported by: murf The problem was
	  that, esoteric as it is, because the hangerupper context
	  immediately preceded the std-priv-extent macro, that the checking
	  code accidentally would fall from traversing hangerupper into the
	  std-priv-exten macro, where it would hit the hangerupper in the
	  'includes', and proceed into an infinite recursion. A small fix
	  to traverse into the statements of the context instead of the
	  context solves this issue. I also added some commented out
	  printfs for debug, which were pretty handy in the face of a dorky
	  gdb. This was a problem around since the package was first
	  written; but evidently pretty rare in turning up in the field.
	  ........

2008-07-16 15:08 +0000 [r131207]  Russell Bryant <russell@digium.com>

	* channels/chan_agent.c: Add missing terminator to
	  ast_event_subscribe to fix a crash. (from rev 131206 in the 1.6.0
	  branch)

2008-07-16 00:52 +0000 [r131166]  Tilghman Lesher <tlesher@digium.com>

	* main/logger.c: Fix rotate strategy (Closes issue #13086)

2008-07-15 23:36 +0000 [r131129]  Steve Murphy <murf@digium.com>

	* main/pbx.c: (closes issue #12960) Reported by: mnicholson Spent
	  most of the day on this bug, and the solution was so simple. Just
	  had to find and understand the problem. The problem was, that the
	  routine to copy the existing switches, includes, and ignorepats
	  from the old context to the new one, wasn't getting called when
	  the context is already existent. (In other words, if AEL is
	  adding a new context to the mix, they get copied, but if
	  pbx_config already defined a context, then the copy wasn't
	  happening. This made no sense, so I moved the call to copy the
	  includes & etc, no matter the case.

2008-07-15 18:46 +0000 [r131072]  Russell Bryant <russell@digium.com>

	* res/res_agi.c: Fix a couple of places in res_agi where the
	  agi_commands lock would not be released, causing a deadlock.
	  (Reported by mvanbaak in #asterisk-dev, discovered by bbryant's
	  change to the lock tracking code to yell at you if a thread exits
	  with a lock still held)

2008-07-15 18:25 +0000 [r131044]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, main/manager.c, /, channels/chan_sip.c,
	  apps/app_voicemail.c: Merged revisions 130959 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r130959 | tilghman | 2008-07-15 12:19:13 -0500 (Tue, 15 Jul 2008)
	  | 8 lines astman_send_error does not need a newline appended --
	  the API takes care of that for us. (closes issue #13068) Reported
	  by: gknispel_proformatique Patches:
	  asterisk_1_4_astman_send.patch uploaded by gknispel (license 261)
	  asterisk_trunk_astman_send.patch uploaded by gknispel (license
	  261) ........

2008-07-15 18:14 +0000 [r131015]  Brett Bryant <bbryant@digium.com>

	* apps/app_queue.c: Fix memory leak in app_queue when a device
	  state is changed but it isn't a member of any queue. (closes
	  issue #13073) Reported by: eliel Patches: app_queue.c.patch
	  uploaded by eliel (license 64)

2008-07-15 17:49 +0000 [r131013]  Michiel van Baak <michiel@vanbaak.info>

	* main/cdr.c, /: Merged revisions 131012 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r131012 | mvanbaak | 2008-07-15 19:47:15 +0200 (Tue, 15 Jul 2008)
	  | 7 lines remove 4 lines of redundant code. (closes issue #13080)
	  Reported by: gknispel_proformatique Patches:
	  trunk_ast_cdr_setapp.patch uploaded by gknispel (license 261)
	  ........

2008-07-15 16:20 +0000 [r130890-130951]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Additional
	  option for videosupport (always) that disables the optimization
	  to fail to setup video RTP if the two endpoints will not support
	  it. This assists with call files and certain transfers to ensure
	  that if two video phones are ever connected, they will always
	  share a video feed.

	* /, channels/chan_iax2.c: Merged revisions 130889 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r130889 | tilghman | 2008-07-14 18:59:13 -0500 (Mon, 14
	  Jul 2008) | 8 lines Override the callerid in all cases when the
	  callerid is set in the user, not just when a remote callerid is
	  set. Also, if not set in the user, allow the remote CallerID to
	  pass through. (closes issue #12875) Reported by: dimas Patches:
	  20080714__bug12875.diff.txt uploaded by Corydon76 (license 14)
	  ........

2008-07-14 22:22 +0000 [r130794-130854]  Mark Michelson <mmichelson@digium.com>

	* main/asterisk.c: Fix a memory leak in the case that /dev/null
	  cannot be opened when running startup commands from cli.conf
	  (closes issue #13066) Reported by: eliel Patches:
	  asterisk.c.patch uploaded by eliel (license 64)

	* apps/app_dial.c, /: Merged revisions 130792 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r130792 | mmichelson | 2008-07-14 12:50:21 -0500 (Mon, 14 Jul
	  2008) | 8 lines Add a check to the CAN_EARLY_BRIDGE macro in
	  app_dial to be sure there are no audiohooks present on the
	  channels involved. This fixed a one-way audio situation I had in
	  my test setup. I couldn't find any open issues that suggested
	  one-way audio with regards to mixmonitor (or other audiohook)
	  usage, though. ........

2008-07-14 17:21 +0000 [r130744]  Michiel van Baak <michiel@vanbaak.info>

	* main/dnsmgr.c, /: Merged revisions 130735 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r130735 | mvanbaak | 2008-07-14 19:10:21 +0200 (Mon, 14 Jul 2008)
	  | 10 lines notify the user that dnsmgr refresh wont work when
	  dnsmgr is not enabled. Previously this command would
	  automagically appear and disappear. This was confusing. (closes
	  issue #12796) Reported by: chappell Patches:
	  dnsmgr_refresh_3.diff uploaded by chappell (license 8) Tested by:
	  russell, chappell, mvanbaak ........

2008-07-14 16:50 +0000 [r130732-130733]  Luigi Rizzo <rizzo@icir.org>

	* channels/vgrabbers.c: free memory used by the x11 grabber when
	  closing it.

	* channels/console_video.c: use
	  ast_pthread_create_detached_background() instead of redoing it
	  with separate calls

2008-07-14 15:44 +0000 [r130697]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_unistim.c, channels/h323/ast_h323.cxx,
	  include/asterisk/module.h, channels/misdn/isdn_lib.c: Swap
	  "static" and "const", so that "static" appears at the beginning
	  of each declaration (suppresses a warning). (closes issue #13070)
	  Reported by: gknispel_proformatique Patches:
	  asterisk_trunk_const_static.patch uploaded by gknispel (license
	  261)

2008-07-14 10:39 +0000 [r130635]  Russell Bryant <russell@digium.com>

	* /, main/audiohook.c: Merged revisions 130634 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r130634 | russell | 2008-07-14 05:38:14 -0500 (Mon, 14 Jul 2008)
	  | 2 lines Bump up the debug level for a message. ........

2008-07-13 23:14 +0000 [r130574-130578]  Michiel van Baak <michiel@vanbaak.info>

	* doc/tex/Makefile, build_tools/prep_tarball, res/Makefile: Make
	  all sed calls Posix sed compatible. To make sure nobody commits
	  script-modified files we first make a backup of asterisk.tex, run
	  the script, generate the pdf and / or html, and put the original
	  asterisk.tex back. This will guard us for the stuff that happened
	  before that someone committed a locally modified asterisk.tex,
	  with changes done by this script. (closes issue #13062) Reported
	  by: mvanbaak Patches: sed_without-i-v3.diff uploaded by mvanbaak
	  (license 7) Tested by: mvanbaak Feedback from Corydon. Thanks for
	  taking the time to go through this.

	* channels/chan_skinny.c: Convert chan_skinny's open-coded linked
	  lists to the list macros (closes issue #12956) Reported by: DEA
	  Patches: chan_skinny-linkedlists-v2.txt uploaded by DEA (license
	  3) Tested by: DEA, mvanbaak

	* main/manager.c, /: Merged revisions 130573 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r130573 | mvanbaak | 2008-07-14 00:48:51 +0200 (Mon, 14 Jul 2008)
	  | 8 lines fix memory leak when originate from manager cannot
	  create a thread (closes issue #13069) Reported by:
	  gknispel_proformatique Patches:
	  asterisk_trunk_action_originate.patch uploaded by gknispel
	  (license 261) Tested by: gknispel_proformatique, mvanbaak
	  ........

2008-07-13 17:58 +0000 [r130515]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 130514 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r130514 | tilghman | 2008-07-13 12:56:10 -0500 (Sun, 13
	  Jul 2008) | 4 lines Reverting 2 changesets, as it breaks incoming
	  IAX2 calls (Related to issue #12963) Reported by: mvanbaak
	  ........

2008-07-13 14:58 +0000 [r130479]  Michiel van Baak <michiel@vanbaak.info>

	* doc/tex/asterisk.tex: restore ASTERISKVERSION marker to
	  asterisk.tex. This got lost in commit 97634

2008-07-13 02:34 +0000 [r130444]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_agent.c: Unlock list before returning

2008-07-11 22:23 +0000 [r130320]  Kevin P. Fleming <kpfleming@digium.com>

	* /: not needed here

2008-07-11 22:03 +0000 [r130296-130297]  Steve Murphy <murf@digium.com>

	* main/pbx.c: (closes issue #13041) Reported by: eliel OK, now the
	  context registrar slot is strdup'd. It is freed on destruction. I
	  don't see the need to do this with all the structs' registrar
	  fields, but if some wild case proves they should also be handled
	  this way, then we can put in the extra work at that time.

	* res/res_odbc.c: a small change to make things compile

2008-07-11 21:36 +0000 [r130293]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: Support new TRANSPORT definitions in
	  libss7

2008-07-11 20:03 +0000 [r130237]  Mark Michelson <mmichelson@digium.com>

	* /, main/audiohook.c: Merged revisions 130236 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r130236 | mmichelson | 2008-07-11 15:03:23 -0500 (Fri, 11 Jul
	  2008) | 3 lines Remove redundant logic ........

2008-07-11 19:56 +0000 [r130230-130234]  Tilghman Lesher <tlesher@digium.com>

	* res/res_odbc.c: Don't copy on NULL.

	* include/asterisk/res_odbc.h, res/res_odbc.c: Add some debug code
	  and add a missing release

	* channels/chan_dahdi.c, utils/astman.c: Fix trunk breakage

2008-07-11 19:14 +0000 [r130174]  Mark Michelson <mmichelson@digium.com>

	* /, main/audiohook.c: Merged revisions 130173 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r130173 | mmichelson | 2008-07-11 14:13:29 -0500 (Fri, 11 Jul
	  2008) | 7 lines Fix a typo in audiohook_read_frame_both. While
	  this change has not been proven to fix any specific issue, it is
	  incorrect and could cause unforeseen problems. ........

2008-07-11 18:52 +0000 [r130170]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 130169 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r130169 | tilghman | 2008-07-11 13:51:56 -0500 (Fri, 11
	  Jul 2008) | 7 lines Ensure that a destination callno of 0 will
	  not match for frames that do not start a dialog (new, lagrq, and
	  ping). (closes issue #12963) Reported by: russellb Patches:
	  chan_iax2_dup_new_fix4.patch uploaded by jpgrayson (license 492)
	  ........

2008-07-11 18:32 +0000 [r130167]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_sip.c: Missed one. Formatting only.

2008-07-11 18:24 +0000 [r130145]  Steve Murphy <murf@digium.com>

	* main/pbx.c: (closes issue #13041) Reported by: eliel Tested by:
	  murf (closes issue #12960) Reported by: mnicholson In this
	  'omnibus' fix, I **think** I solved both the problem in 13041,
	  where unloading pbx_ael.so caused crashes, or incomplete removal
	  of previous registrar'ed entries. And I added code to completely
	  remove all includes, switches, and ignorepats that had a matching
	  registrar entry, which should appease 12960. I also added a lot
	  of seemingly useless brackets around single statement if's, which
	  helped debug so much that I'm leaving them there. I added a
	  routine to check the correlation between the extension tree lists
	  and the hashtab tables. It can be amazingly helpful when you have
	  lots of dialplan stuff, and need to narrow down where a problem
	  is occurring. It's ifdef'd out by default. I cleaned up the code
	  around the new CIDmatch code. It was leaving hanging extens with
	  bad ptrs, getting confused over which objects to remove, etc. I
	  tightened up the code and changed the call to remove_exten in the
	  merge_and_delete code. I added more conditions to check for empty
	  context worthy of deletion. It's not empty if there are any
	  includes, switches, or ignorepats present. If I've missed
	  anything, please re-open this bug, and be prepared to supply
	  example dialplan code.

2008-07-11 18:09 +0000 [r130129]  Brett Bryant <bbryant@digium.com>

	* codecs/codec_g722.c, channels/chan_sip.c, main/threadstorage.c,
	  utils/astman.c, main/utils.c, channels/chan_gtalk.c,
	  pbx/dundi-parser.c, main/cli.c, channels/chan_jingle.c,
	  channels/chan_dahdi.c, channels/chan_skinny.c,
	  main/abstract_jb.c, apps/app_minivm.c, codecs/codec_resample.c,
	  codecs/codec_dahdi.c, apps/app_chanspy.c, apps/app_milliwatt.c,
	  main/asterisk.c, main/dsp.c: Janitor patch to change uses of
	  sizeof to ARRAY_LEN (closes issue #13054) Reported by: pabelanger
	  Patches: ARRAY_LEN.patch2 uploaded by pabelanger (license 224)
	  Tested by: seanbright

2008-07-11 17:29 +0000 [r130126]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_agent.c: Merged revisions 130102 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r130102 | tilghman | 2008-07-11 11:50:42 -0500 (Fri, 11
	  Jul 2008) | 9 lines Pass the devicestate from an underlying
	  channel up through the Agent channel. This should make the Agent
	  always report the correct device state, even when the underlying
	  channel is used for other purposes. (closes issue #12773)
	  Reported by: davidw Patches: 20080710__bug12773.diff.txt uploaded
	  by Corydon76 (license 14) Tested by: davidw ........

2008-07-11 16:18 +0000 [r130040-130044]  Kevin P. Fleming <kpfleming@digium.com>

	* doc/ss7.txt, contrib/utils/zones2indications.c, CHANGES: clean up
	  a bunch more Zaptel-related references

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample, /,
	  configure, include/asterisk/autoconfig.h.in, configure.ac: Merged
	  revisions 130039 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r130039 | kpfleming | 2008-07-11 10:41:56 -0500 (Fri, 11 Jul
	  2008) | 4 lines add support for a configuration parameter for
	  'inband audio during RELEASE', which is currently mandatory in
	  libpri-1.4.4 but will become configurable in libpri-1.4.5 later
	  today (related to issue #13042) ........

2008-07-11 14:22 +0000 [r129985-129987]  Russell Bryant <russell@digium.com>

	* /, include/asterisk/astobj.h: Merged revisions 129970 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r129970 | russell | 2008-07-11 09:18:43 -0500 (Fri, 11 Jul 2008)
	  | 2 lines add a simple ASTOBJ_TRYWRLOCK macro ... ........

	* /: remove space in property value

2008-07-11 14:16 +0000 [r129916-129968]  Kevin P. Fleming <kpfleming@digium.com>

	* /, main/astmm.c: Merged revisions 129966 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r129966 | kpfleming | 2008-07-11 09:03:52 -0500 (Fri, 11 Jul
	  2008) | 5 lines fix a flaw found while experimenting with
	  structure alignment and padding; low-fence checking would not
	  work properly on 64-bit platforms, because the compiler was
	  putting 4 bytes of padding between the fence field and the
	  allocation memory block added a very obvious runtime warning if
	  this condition reoccurs, so the developer who broke it can be
	  chastised into fixing it :-) ........ r129967 | kpfleming |
	  2008-07-11 09:03:52 -0500 (Fri, 11 Jul 2008) | 5 lines simplify
	  calculation ........

	* /, sounds/Makefile: Merged revisions 129907 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r129907 | kpfleming | 2008-07-11 07:15:42 -0500 (Fri, 11 Jul
	  2008) | 2 lines don't attempt to set user/group ownership of
	  extracted sound files (reported on asterisk-users) ........

2008-07-11 00:55 +0000 [r129864]  Sean Bright <sean.bright@gmail.com>

	* res/res_config_pgsql.c, res/res_config_ldap.c: Fix some usages of
	  snprintf, and clarify a couple variable names.

2008-07-10 22:06 +0000 [r129758-129804]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 129803 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r129803 | tilghman | 2008-07-10 16:57:05 -0500 (Thu, 10
	  Jul 2008) | 8 lines Correctly deal with duplicate NEW frames (due
	  to retransmission). Also, fixup the destination call number
	  matching to be more strict and reliable. (closes issue #12963)
	  Reported by: jpgrayson Patches: chan_iax2_dup_new_fix3.patch
	  uploaded by jpgrayson (license 492) Tested by: jpgrayson,
	  Corydon76 ........

	* res/res_config_odbc.c, /: Merged revisions 129741 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r129741 | tilghman | 2008-07-10 16:19:48 -0500 (Thu, 10
	  Jul 2008) | 2 lines Oops ........

2008-07-10 20:56 +0000 [r129738]  Terry Wilson <twilson@digium.com>

	* Makefile: Move phoneprov config files to be installed with 'make
	  samples' so changes aren't inadvertently lost on a 'make install'

2008-07-10 20:33 +0000 [r129734]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Removed the fn2 field from the vm_state
	  structure. fn2 was used in three functions. In every case, it was
	  initialized in the function it was used in. This meant there was
	  no need to have it in a malloc'd structure just taking up space.
	  Furthermore two of the functions it was used in were completely
	  unnecessary since fn2 was set to exactly the same value as the
	  vm_state's fn string. fn2 was a char array sized at PATH_MAX. On
	  my system, PATH_MAX is 4096. This equates to a 4K memory savings
	  per vm_state allocated. Since there is a vm_state malloc'd for
	  every voicemail user on the system, this could potentially add up
	  nicely if there are lots of users. In addition, a vm_state is
	  allocated on the stack each time a caller calls the VoiceMailMain
	  application, meaning that there is a significant stack savings
	  with this patch too. Of course, a single vm_state struct still
	  takes up approximately 20K on my system (when using IMAP storage.
	  Without IMAP storage, there would be about another 300 bytes
	  fewer usage), even with this removal. Further optimizations are
	  probably possible, but most likely not as easy as this one.

2008-07-10 19:13 +0000 [r129684]  Brett Bryant <bbryant@digium.com>

	* apps/app_queue.c: Fixes a bug where the interface for a queue
	  member gets reloaded as the state_interface, if a state_interface
	  was set, on reload because the state_interface isn't stored in
	  the ast_db. (closes issue #13043) Reported by: jvandal Patches:
	  app_queue.patch uploaded by jvandal (license 413)

2008-07-10 18:19 +0000 [r129638-129642]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_sip.c: A couple more minor text changes

	* channels/chan_sip.c: Remove extraneous \n. Pointed out by eliel
	  on #asterisk-dev.

2008-07-10 16:21 +0000 [r129581]  Michiel van Baak <michiel@vanbaak.info>

	* main/features.c: Remove deprecated 'show parkedcalls' CLI command
	  (closes issue #13038) Reported by: eliel Patches:
	  finish.deprecate.patch uploaded by eliel (license 64)

2008-07-10 16:12 +0000 [r129569]  Russell Bryant <russell@digium.com>

	* /, sample.call: Merged revisions 129567 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r129567 | russell | 2008-07-10 11:03:59 -0500 (Thu, 10 Jul 2008)
	  | 3 lines Note that pbx_spool.so is the module used for call
	  files (inspired by a question in #asterisk) ........

2008-07-10 13:54 +0000 [r129503]  Sean Bright <sean.bright@gmail.com>

	* main/editline: Update svn:ignore

2008-07-09 19:40 +0000 [r129437]  Mark Michelson <mmichelson@digium.com>

	* /, main/rtp.c: Merged revisions 129436 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r129436 | mmichelson | 2008-07-09 14:32:20 -0500 (Wed, 09 Jul
	  2008) | 13 lines Fix a problem where inbound rfc2833 audio would
	  be sent to the core instead of being P2P bridged. When the core
	  regenerated the rfc2833 packet for the outbound leg, the SSRC
	  would be different than the RTP audio on the call leg causing
	  DTMF detection issues on the far end. (closes issue #12955)
	  Reported by: tonyredstone Patches: dynamic_rtp.patch uploaded by
	  tsearle (license 373) Tested by: tonyredstone ........

2008-07-09 15:57 +0000 [r129399]  Matthew Fredrickson <creslin@digium.com>

	* main/pbx.c: Add Proceeding() application (#13025)

2008-07-09 13:44 +0000 [r129344]  Sean Bright <sean.bright@gmail.com>

	* main/editline/makelist.in (added), /, main/editline/configure,
	  main/editline/Makefile.in, main/editline/configure.in,
	  main/editline/makelist (removed): Merged revisions 129343 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r129343 | seanbright | 2008-07-09 09:41:21 -0400 (Wed, 09 Jul
	  2008) | 4 lines Look for the system installed awk instead of
	  assuming it's at /usr/bin/awk. Pointed out by jmls via
	  #asterisk-dev. ........

2008-07-09 03:39 +0000 [r129307]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, main/manager.c, res/res_agi.c, pbx/pbx_realtime.c,
	  include/asterisk/channel.h, include/asterisk/pbx.h, main/cli.c:
	  Code wasn't ready to be merged - see -dev list discussion

2008-07-08 22:56 +0000 [r129270]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fix compilation error when IMAP storage is
	  enabled

2008-07-08 21:00 +0000 [r129156]  Brett Bryant <bbryant@digium.com>

	* main/dnsmgr.c, main/srv.c, main/dns.c: Fix a bug in SRV lookups
	  where dnsmgr would discard everything but the first SRV result
	  from DNS before processing weights and priorities and
	  dns_parse_answer wouldn't report that there were no records in
	  DNS unless a failure occured. Also fixed a bug where
	  dnsmgr_refresh would report that a entry was being changed when
	  ast_gethostbyname had failed.

2008-07-08 20:30 +0000 [r129048-129152]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c, /, channels/chan_sip.c,
	  include/asterisk/causes.h: Merged revisions 129149 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r129149 | tilghman | 2008-07-08 15:27:47 -0500 (Tue, 08
	  Jul 2008) | 8 lines Cause SIP to return a 480 instead of a 404
	  when a sip peer exists, but is not registered. (closes issue
	  #12885) Reported by: ibc Patches: 20080701__bug12885__2.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: ibc ........

	* main/asterisk.c: Reduce length of time that 'asterisk -rx' waits.
	  (closes issue #13001) Reported by: eliel Patches:
	  20080708__bug13001.diff.txt uploaded by Corydon76 (license 14)
	  20080708__bug13001.diff.txt.fixed uploaded by eliel (license 64)
	  Tested by: Corydon76, eliel

	* /, channels/chan_iax2.c: Merged revisions 129047 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r129047 | tilghman | 2008-07-08 11:45:23 -0500 (Tue, 08
	  Jul 2008) | 7 lines Timestamp decoding for video mini-frames is
	  bogus, because the timestamp only includes 15 bits, unlike voice
	  frames, which contain a 16-bit timestamp. (closes issue #13013)
	  Reported by: jpgrayson Patches: chan_iax2_unwrap_ts.patch
	  uploaded by jpgrayson (license 492) ........

2008-07-08 16:40 +0000 [r129045]  Brett Bryant <bbryant@digium.com>

	* main/pbx.c, main/frame.c, channels/chan_sip.c, apps/app_meetme.c,
	  channels/h323/ast_h323.cxx, res/res_limit.c, main/acl.c,
	  channels/iax2-provision.c, pbx/dundi-parser.c,
	  channels/chan_iax2.c, main/rtp.c, main/channel.c,
	  channels/chan_dahdi.c, main/manager.c, formats/format_pcm.c,
	  main/callerid.c, main/logger.c, apps/app_parkandannounce.c,
	  apps/app_adsiprog.c: Janitor project to convert sizeof to
	  ARRAY_LEN macro. (closes issue #13002) Reported by: caio1982
	  Patches: janitor_arraylen5.diff uploaded by caio1982 (license 22)

2008-07-08 14:17 +0000 [r129006]  Russell Bryant <russell@digium.com>

	* apps/app_fax.c: Update app_fax for better compatibility with
	  spandsp 0.0.5. Add a call to t38_terminal_release, and make sure
	  that the phase E handler gets called with proper status. (closes
	  issue #13020) Reported by: dimas Patches: v1-appfax.patch
	  uploaded by dimas (license 88)

2008-07-08 10:02 +0000 [r128927-128951]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 128950 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r128950 | oej | 2008-07-08 11:52:21 +0200 (Tis, 08 Jul 2008) | 11
	  lines Don't hangup the call if we can't resolve the Contact if
	  there's a proxy route set for the call. ---- This comment was
	  added a while ago and today it hit me badly. /* OEJ: Possible
	  issue that may need a check: If we have a proxy route between us
	  and the device, should we care about resolving the contact or
	  should we just send it? */ ........

	* /, channels/chan_sip.c: Merged revisions 128912 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r128912 | oej | 2008-07-08 11:06:08 +0200 (Tis, 08 Jul 2008) | 7
	  lines Fix issues where repeated messages where ignored, but
	  retransmitted reliably instead of unreliably. Reported by: johan
	  Patches: 12746.txt uploaded by oej (license 306) Tested by: johan
	  (issue #12746) ........

2008-07-08 00:02 +0000 [r128830-128857]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 128856 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r128856 | tilghman | 2008-07-07 19:01:30 -0500 (Mon, 07
	  Jul 2008) | 7 lines Check for non-NULL before stripping
	  characters. (closes issue #12954) Reported by: bfsworks Patches:
	  20080701__bug12954.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: deti ........

	* /, apps/app_voicemail.c: Merged revisions 128812 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r128812 | tilghman | 2008-07-07 18:21:52 -0500 (Mon, 07
	  Jul 2008) | 2 lines Stop using deprecated method, as requested by
	  Kevin. ........

2008-07-07 22:42 +0000 [r128796]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 128795 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r128795 | russell | 2008-07-07 17:41:48 -0500 (Mon, 07
	  Jul 2008) | 8 lines Fix handling of when a pvt disappears.
	  Properly return the pvt locked and don't hold the pvt lock while
	  destroying the ast_channel. (closes issue #13014) Reported by:
	  jpgrayson Patches: chan_iax2_ast_iax2_new2.patch uploaded by
	  jpgrayson (license 492) ........

2008-07-07 20:50 +0000 [r128738]  Sean Bright <sean.bright@gmail.com>

	* /, channels/chan_iax2.c: Merged revisions 128737 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r128737 | seanbright | 2008-07-07 16:47:56 -0400 (Mon,
	  07 Jul 2008) | 9 lines Remove spurious trailing whitespace from
	  log messages and fix a spelling error in a log message. (closes
	  issue #13017) Reported by: jpgrayson Patches:
	  chan_iax2_space_after_newline.patch uploaded by jpgrayson
	  (license 492) chan_iax2_spelling.patch uploaded by jpgrayson
	  (license 492) ........

2008-07-07 20:30 +0000 [r128599-128733]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Crap

	* apps/app_voicemail.c: If imapfolder=foo were set in
	  voicemail.conf, then when calling VoiceMailMain, app_voicemail
	  would attempt to play a file called vm-foo instead of playing
	  vm-INBOX to play the "new" sound file. This commit fixes that
	  issue. This may fix one of the problems reported in issue #12987

	* apps/app_voicemail.c: Get app_voicemail compiling when IMAP
	  storage is used. Brought up by reporter on issue #12987

	* /, channels/chan_iax2.c: Merged revisions 128639 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r128639 | mmichelson | 2008-07-07 12:02:28 -0500 (Mon,
	  07 Jul 2008) | 10 lines By using the iaxdynamicthreadcount to
	  identify a thread, it was possible for thread identifiers to be
	  duplicated. By using a globally-unique monotonically- increasing
	  integer, this is now avoided. (closes issue #13009) Reported by:
	  jpgrayson Patches: chan_iax2_dyn_threadnum.patch uploaded by
	  jpgrayson (license 492) ........

	* doc/tex/extensions.tex, configs/extensions.conf.sample: Update a
	  few instances of "extensions reload" to "dialplan reload" in the
	  documentation. Patch provided by caio1982 (license 22)

2008-07-07 11:53 +0000 [r128564]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: As pointed out on the -dev list, actually
	  use the result of find_peer() so that a peer reference is not
	  leaked.

2008-07-06 20:19 +0000 [r128274-128525]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: - Adding alias
	  "udpbindaddr" for the UDP port to comply with "tcpbindaddr" and
	  "tlsbindaddr". Note: I don't think we can start properly without
	  UDP port open, that needs to be tested. - Removing "bindport"
	  from configuration example, not needed to mention this any more I
	  suggest we deprecate "bindaddr" and "bindport" in trunk (for
	  1.6.1)

	* channels/chan_sip.c, configs/sip.conf.sample: - Fixing issues
	  with "sip show settings" - Adding IP address for TCP and/or TLS
	  too if auto-domain is enabled and binding to a different IP
	  address - Fixing documentation in sip.conf.sample

	* channels/chan_sip.c: - Remove unused variable "expiry" - Set
	  global_outboundproxy.force at reload.

	* channels/chan_sip.c: More doxygen comments.

	* channels/chan_sip.c: - Formatting changes - Doxygen changes -
	  Replacing a doxygen description that was copied from another
	  function

	* channels/chan_sip.c: Adding note about incorrect manager
	  registration...

	* doc/realtimetext.txt (added): Adding documentation on the T.140
	  support in Asterisk. This is a function that we're the reference
	  implementation on now. :-)

	* channels/chan_sip.c: Remove comments that doesn't make sense. The
	  deprecation of type=user will come at a later stage, as indicated
	  by previous commit message

	* channels/chan_sip.c: Fix severe problem with my previous commit
	  of "kill-the-user". Russell saw a problem with this code, but not
	  the correct problem. Thanks, anyway! ;-)

	* main/pbx.c, main/manager.c, pbx/pbx_realtime.c,
	  include/asterisk/pbx.h: Changing name of global api call to ast_*
	  My mistake, pointed out by Russell.

	* channels/chan_sip.c: Disabling code used by dumpdb with #ifdef,
	  since I believe we might use it sometime in the future, but also
	  want to avoid compiler warnings now.

	* channels/chan_sip.c: Removing the CLI dumpdb command (see
	  asterisk-dev discussion and decision)

	* channels/chan_sip.c: Adding a few reminders

	* channels/chan_sip.c: Adding doxygen comments to missing parts,
	  moving some #define ...trying to get my head around the thoughts
	  behind the TCP/TLS stuff and figure out what needs to be done to
	  make it useful...

	* channels/chan_sip.c: Adding TCP and TLS to "sip show settings".
	  TLS needs to have one configuration per configured domain at some
	  point.

	* channels/chan_sip.c: Add some comments...

	* channels/chan_sip.c: Set tls setting to default in reload_config.

2008-07-05 21:20 +0000 [r128254]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_sip.c: fix compiling of chan_sip.c

2008-07-05 21:11 +0000 [r128247]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: I like it when the tree is not broken.

2008-07-05 20:59 +0000 [r128201-128242]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: KILL THE USER! Actually, kill the in-memory
	  structure for type=user and start using the sip_peer structure
	  for every object. Have only one in-memory list and use them
	  different ways depending on type=user, type=peer and type=friend
	  - like always. The idea with this first patch is that
	  configurations should work as before. Some additional features
	  for realtime peers. By adding a type= field, you can now have
	  multiple functions. Let's test this for a while. Won't be
	  integrated in 1.6.0, only in trunk, for testing. There's propably
	  more to clean up and simplify here. Help is welcome and
	  encouraged!

	* main/pbx.c, main/manager.c, res/res_agi.c, pbx/pbx_realtime.c,
	  include/asterisk/channel.h, include/asterisk/pbx.h, main/cli.c:
	  Implement flags for AGI in the channel structure so taht "show
	  channels" and AMI commands can display that a channel is under
	  control of an AGI. Work inspired by work at customer site, but
	  paid for by Edvina AB

	* configs/sip.conf.sample: Make TCP disabled by default (it's
	  considered experimental)

	* configs/sip.conf.sample: Reformatting the config sample

	* channels/chan_sip.c: Stop cli command completion with tabs

2008-07-05 19:52 +0000 [r128198]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Make this actually evaluate how it was intended to
	  be.

2008-07-05 19:27 +0000 [r128197]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, include/asterisk/rtp.h, main/rtp.c: Add new
	  SIP cli command "sip show channelstats" that displays some QoS
	  data (if we have RTCP reports and not use the p2p rtp bridge). I
	  could not find a way to detect us using the p2p bridge, which
	  would be nice.

2008-07-05 15:17 +0000 [r128160]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/asterisk.ldap-schema,
	  contrib/scripts/asterisk.ldif: LDAP schema updates (closes issue
	  #12860) Reported by: flyn Patches: asterisk.ldif uploaded by
	  suretec (license 70) asterisk.schema uploaded by suretec (license
	  70)

2008-07-05 03:39 +0000 [r128122-128125]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: It would help if we actually parsed the
	  ss7_explicitacm option in the config file...

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample: Add option
	  to wait to be able to explicitly send ACM via the Proceeding()
	  application in the dialplan. Also minor documentation update
	  explaining how to setup multiple signalling links within a
	  linkset

2008-07-04 16:41 +0000 [r128027-128082]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: Fullcontact needs more than 20 characters,
	  even for the simplest case

	* main/pbx.c, /, include/asterisk/pbx.h, pbx/pbx_config.c: Merged
	  revisions 127973 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r127973 | tilghman | 2008-07-03 22:30:30 -0500 (Thu, 03 Jul 2008)
	  | 8 lines Fix the 'dialplan remove extension' logic, so that it
	  a) works with cidmatch, and b) completes contexts correctly when
	  the extension is ambiguous. (closes issue #12980) Reported by:
	  licedey Patches: 20080703__bug12980.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: Corydon76 ........

2008-07-04 14:36 +0000 [r127995]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - reorganize SIP extensions alphabetically,
	  to make it easier to synch with the IANA list - add a few new
	  registered and well-known extension names

2008-07-03 22:47 +0000 [r127931-127934]  Brett Bryant <bbryant@digium.com>

	* channels/iax2-parser.c: Fix one more file that got changed.

	* channels/iax2.h, channels/chan_iax2.c: Remove commit that somehow
	  got mergeed into trunk.

	* channels/iax2.h, channels/chan_iax2.c, channels/iax2-parser.c:
	  Update these files with transfer code.

2008-07-03 22:23 +0000 [r127903]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, /, apps/Makefile, main/editline/np/vis.c: Merged
	  revisions 127892,127895 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r127892 | kpfleming | 2008-07-03 17:18:38 -0500 (Thu, 03 Jul
	  2008) | 6 lines a couple of small Solaris-related fixes (closes
	  issue #11885) Reported by: snuffy, asgaroth ........ r127895 |
	  kpfleming | 2008-07-03 17:20:16 -0500 (Thu, 03 Jul 2008) | 3
	  lines remove this, it has been moved to the main Makefile
	  ........

2008-07-03 20:59 +0000 [r127831-127857]  Mark Michelson <mmichelson@digium.com>

	* apps/app_chanspy.c: Make change proposed by andrew53 on
	  bugtracker

	* apps/app_chanspy.c: Thanks to a suggestion from seanbright, print
	  a warning if the attachment of the whisper or barge audiohooks
	  fails.

	* apps/app_chanspy.c: Fix build

	* apps/app_chanspy.c: Fix a crash when attempting to spy on an
	  unbridged channel. (closes issue #12986) Reported by: andrew53

2008-07-03 17:16 +0000 [r127793]  Steve Murphy <murf@digium.com>

	* main/cdr.c, main/channel.c, channels/chan_dahdi.c, main/pbx.c, /,
	  channels/chan_sip.c, main/features.c, include/asterisk/cdr.h:
	  Merged revisions 127663 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r127663 | murf | 2008-07-02 18:16:25 -0600 (Wed, 02 Jul 2008) |
	  30 lines The CDRfix4/5/6 omnibus cdr fixes. (closes issue #10927)
	  Reported by: murf Tested by: murf, deeperror (closes issue
	  #12907) Reported by: falves11 Tested by: murf, falves11 (closes
	  issue #11849) Reported by: greyvoip As to 11849, I think these
	  changes fix the core problems brought up in that bug, but perhaps
	  not the more global problems created by the limitations of CDR's
	  themselves not being oriented around transfers. Reopen if necc,
	  but bug reports are not the best medium for enhancement
	  discussions. We need to start a second-generation CDR
	  standardization effort to cover transfers. (closes issue #11093)
	  Reported by: rossbeer Tested by: greyvoip, murf ........

2008-07-03 16:48 +0000 [r127779-127791]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Make sure we stop session timers as soon as
	  we start hanging up an active call. May fix issue 12919.

	* channels/chan_sip.c: Revert some logic for session timers. We do
	  send in-dialog requests that should not have session-timer
	  require headers, like MESSAGE and REFER. So in the future, only
	  add them on requests and responses that are related to INVITEs
	  and re-INVITEs.

2008-07-03 16:22 +0000 [r127767]  Kevin P. Fleming <kpfleming@digium.com>

	* /, configure, configure.ac, acinclude.m4: some minor fixes found
	  while working on issue #12911 (and block the rev from 1.4 since
	  the equivalent is already here)

2008-07-03 14:34 +0000 [r127720]  Mark Michelson <mmichelson@digium.com>

	* configs/queues.conf.sample, CHANGES, apps/app_queue.c: Added a
	  new option, "timeoutpriority" to queues.conf. A detailed
	  explanation of the change may be found in
	  configs/queues.conf.sample (closes issue #12690) Reported by:
	  atis

2008-07-03 09:59 +0000 [r127685]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Fix bad formatting in a very confusing
	  function. Who added the sipdb sql output? It's mixing peers and
	  users in a strange way and should really not be a CLI command,
	  since it's not meant for human output. It should be done with an
	  app connecting to manager.

2008-07-02 22:17 +0000 [r127622]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c: Oops

2008-07-02 22:16 +0000 [r127621]  Brett Bryant <bbryant@digium.com>

	* channels/chan_sip.c: Update transport= in sip so that the option
	  is not broken from a recent commit.

2008-07-02 21:27 +0000 [r127609]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_unistim.c, include/asterisk/app.h, main/manager.c,
	  channels/chan_sip.c, main/app.c, channels/chan_iax2.c,
	  apps/app_voicemail.c: Keep ast_app_inboxcount API compatible with
	  1.6.0.

2008-07-02 21:09 +0000 [r127566]  Mark Michelson <mmichelson@digium.com>

	* doc/janitor-projects.txt: Add a janitor project to use ARRAY_LEN
	  instead of in-line sizeof() and division.

2008-07-02 20:52 +0000 [r127564]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c: Fix some crashlike bugs because flag could
	  be NULL in play_record_review(). (Closes issue #12892) Reported
	  by: jaroth Patch originally by jaroth, fixed by me.

2008-07-02 20:49 +0000 [r127558-127562]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_agent.c: Merged revisions 127560 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r127560 | mmichelson | 2008-07-02 15:47:38 -0500 (Wed,
	  02 Jul 2008) | 3 lines Fix thread-safety of some of the
	  pbx_builtin_getvar_helper calls ........

	* configs/agents.conf.sample, channels/chan_agent.c, CHANGES: The
	  ackcall and endcall options in agents.conf now have supplemental
	  options acceptdtmf and enddtmf. These allow for the DTMF pressed
	  to be configurable instead of being hardcoded to '#' and '*'.
	  (AST-86)

2008-07-02 20:28 +0000 [r127545]  Terry Wilson <twilson@digium.com>

	* include/asterisk/http.h, main/http.c: Expose the prefix variable
	  so that it can be used by modules depending on http support

2008-07-02 18:31 +0000 [r127466]  Tilghman Lesher <tlesher@digium.com>

	* main/acl.c: Solaris fix (closes issue #12949) Reported by: snuffy
	  Patches: bug_12949.diff uploaded by snuffy (license 35)

2008-07-02 17:27 +0000 [r127434]  Brett Bryant <bbryant@digium.com>

	* channels/chan_sip.c: Fix to sip_parse_host so that it passes the
	  correct information to sip_registry.

2008-07-02 14:50 +0000 [r127401]  Russell Bryant <russell@digium.com>

	* include/asterisk/logger.h, include/asterisk/devicestate.h,
	  include/asterisk/astobj2.h, include/asterisk/timing.h,
	  include/asterisk/strings.h, include/asterisk/dnsmgr.h,
	  include/asterisk/threadstorage.h, include/asterisk/slinfactory.h,
	  main/libresample/include/libresample.h, include/asterisk/time.h:
	  Fix a bunch of places where \arg was used instead of \param.
	  Using \arg to document arguments seems logical, and does work,
	  but is not the best thing to use. \arg in doxygen is simply for
	  creating non-nested unordered lists. \param is the correct tag to
	  use to document function parameters, and will come out better in
	  the generated documentation.

2008-07-02 14:30 +0000 [r127398]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_tds.c: Fix a bug I noticed while doing the previous merge

2008-07-02 12:08 +0000 [r127363]  Russell Bryant <russell@digium.com>

	* doc/CODING-GUIDELINES: Add a locking section to the coding
	  guidelines document. This section covers some locking
	  fundamentals, as well as some information on locking as it is
	  used in Asterisk. It describes some of the ways that are used and
	  could be used to achieve deadlock avoidance. It also demonstrates
	  the unfortunate conclusion that with the use of recursive locks,
	  none of the constructs in use today are failsafe from deadlocks.
	  Finally, it makes some recommendations for new code being
	  written. As proper locking strategies is a complex subject, this
	  section still has room for expansion and improvement. This is a
	  result of collaboration between Luigi Rizzo and myself on the
	  asterisk-dev mailing list.

2008-07-02 12:06 +0000 [r127330-127362]  Luigi Rizzo <rizzo@icir.org>

	* channels/console_video.c: plug another panic when the gui cannot
	  be started. We can still send video, just don't try to use what
	  is not available.

	* channels/console_video.c: prevent a segfault when trying to start
	  the gui without any specific configuration in oss.conf (reported
	  by Klaus Darillion on the -video mailing list).

2008-07-02 02:48 +0000 [r127297]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: Change the global timer B to be dependent on
	  the value of the T1 timer, as recommended in RFC 3261, instead of
	  being hardcoded to 32 seconds. This is important for LANs, as it
	  allows autocongestion to occur much more quickly, if desired by
	  the local PBX administrator. It also corrects a bug: if the T1
	  timer was increased beyond 500ms, then timer B would have been
	  set at a much lower value than recommended. (closes issue #12544)
	  Reported by: kactus Patches: 20080616__bug12544.diff.txt uploaded
	  by Corydon76 (license 14) Tested by: kactus

2008-07-01 23:38 +0000 [r127245]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 127244 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r127244 | mmichelson | 2008-07-01 18:36:40 -0500 (Tue,
	  01 Jul 2008) | 5 lines Add error message to failed open(2) calls
	  inside the copy() function of app_voicemail. This idea came as
	  part of my work in helping to resolve issue #12764. ........

2008-07-01 21:43 +0000 [r127210]  Russell Bryant <russell@digium.com>

	* funcs/func_devstate.c: Add a \todo

2008-07-01 21:21 +0000 [r127169]  Tilghman Lesher <tlesher@digium.com>

	* res/res_musiconhold.c: Add AMI events for start/stop of MOH
	  (closes issue #12909) Reported by: chris-mac Patches:
	  res_musiconhold-event.patch uploaded by chris-mac (license 506)

2008-07-01 21:16 +0000 [r127157]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c: Place the delay in __ast_answer prior to the
	  channel-specific answer callback. This change differs from commit
	  127113 in that now the channel is not set to AST_STATE_UP until
	  after the answer callback. (closes issue #12924) Reported by:
	  snyfer

2008-07-01 21:03 +0000 [r127154]  Brett Bryant <bbryant@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample: Add a configuration
	  option so the global outboundproxy can use tcptls without it
	  being defined by each sip user.

2008-07-01 20:51 +0000 [r127152]  Jason Parker <jparker@digium.com>

	* Makefile: Fix a typo that caused this asterisk.conf to not get
	  correctly generated. (closes issue #12966) Reported by: ibc
	  Patches: 12966.patch uploaded by bkruse (license 132)

2008-07-01 20:28 +0000 [r127143]  Tilghman Lesher <tlesher@digium.com>

	* build_tools/cflags.xml, /, channels/chan_iax2.c: Merged revisions
	  127133 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r127133 | tilghman | 2008-07-01 15:25:37 -0500 (Tue, 01 Jul 2008)
	  | 2 lines Disable the old, slow search for matching callno in
	  chan_iax2 (but allow it to be reenabled for debugging) ........

2008-07-01 19:53 +0000 [r127113]  Kevin P. Fleming <kpfleming@digium.com>

	* main/channel.c: change the process of inserting a delay into the
	  ast_answer() path so that we don't tell the calling channel that
	  it has been answered unutil after the delay; for a single-thread
	  call this won't matter all, but for a dual-thread call (using
	  chan_local) this may fix the problem in issue 12924

2008-07-01 19:20 +0000 [r127074]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 127068 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r127068 | tilghman | 2008-07-01 13:52:53 -0500 (Tue, 01
	  Jul 2008) | 8 lines Change around how we schedule pings and
	  lagrqs, and fix a reason why the jobs were not getting properly
	  cancelled. (closes issue #12903) Reported by: stevedavies
	  Patches: 20080620__bug12903__2.diff.txt uploaded by Corydon76
	  (license 14) Tested by: stevedavies ........

2008-07-01 17:22 +0000 [r127017]  Kevin P. Fleming <kpfleming@digium.com>

	* res/res_ais.c, build_tools/menuselect-deps.in, configure,
	  include/asterisk/autoconfig.h.in, configure.ac, res/Makefile,
	  res/ais/ais.h, makeopts.in: make the AIS checking a little more
	  generic, and have a more useful configure script command line
	  option for OpenAIS

2008-07-01 16:52 +0000 [r127000]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 126999 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r126999 | tilghman | 2008-07-01 11:50:46 -0500 (Tue, 01
	  Jul 2008) | 2 lines Suppress annoying warning by finding the
	  remaining cases where the callno is not in the hash. ........

2008-07-01 16:28 +0000 [r126991]  Luigi Rizzo <rizzo@icir.org>

	* images/kpad2.jpg: even uglier gui with more buttons

2008-07-01 16:16 +0000 [r126960]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_dial.c, include/asterisk/channel.h, apps/app_queue.c:
	  another minor ast_channel memory size decrease... for nearly all
	  channels, 'dialcontext' is only going to be set once during the
	  channel's lifetime, so make it a string field instead of a char
	  array

2008-07-01 16:14 +0000 [r126959]  Luigi Rizzo <rizzo@icir.org>

	* doc/video.txt, doc/video_console.txt (added): add documentation
	  on video console support

2008-07-01 15:03 +0000 [r126845-126903]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 126902 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r126902 | oej | 2008-07-01 16:59:31 +0200 (Tis, 01 Jul 2008) | 7
	  lines Use domain part of SIP uri in register= configuration as
	  fromdomain. Reported by: one47 Patches: sip-reg-fromdom2.dpatch
	  uploaded by one47 (license 23) (closes issue #12474) ........

	* /, channels/chan_sip.c: Merged revisions 126899 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r126899 | oej | 2008-07-01 16:27:33 +0200 (Tis, 01 Jul 2008) | 8
	  lines Handle escaped URI's in call pickups. Patch by oej and
	  IgorG. Reported by: IgorG Patches: bug12299-11062-v2.patch
	  uploaded by IgorG (license 20) Tested by: IgorG, oej (closes
	  issue #12299) ........

	* /, configs/sip.conf.sample: Merged revisions 126844 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r126844 | oej | 2008-07-01 14:53:01 +0200 (Tis, 01 Jul
	  2008) | 5 lines Clear up documentation on "domain=" setting in
	  sip.conf Reported by: davidw (closes issue #12413) ........

2008-07-01 12:29 +0000 [r126835]  Luigi Rizzo <rizzo@icir.org>

	* main/logger.c: use %p to print a pointer

2008-07-01 11:58 +0000 [r126755-126790]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 126789 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r126789 | oej | 2008-07-01 13:51:38 +0200 (Tis, 01 Jul 2008) | 6
	  lines Report 200 OK to all in-dialog OPTIONs requests (to confirm
	  that the dialog exist). Don't bother checking the request URI.
	  (closes issue #11264) Reported by: ibc ........

	* /, channels/chan_sip.c: Merged revisions 126735 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r126735 | oej | 2008-07-01 09:49:15 +0200 (Tis, 01 Jul 2008) | 7
	  lines Fix bad XML for hold notification. Reported by: gowen72
	  Patches: hold.patch uploaded by gowen72 (license 432) (closes
	  issue #12942) ........

2008-06-30 22:34 +0000 [r126675]  Jeff Peeler <jpeeler@digium.com>

	* configs/chan_dahdi.conf.sample (added),
	  configs/zapata.conf.sample (removed): rename zapata.conf.sample
	  to chan_dahdi.conf.sample

2008-06-30 20:25 +0000 [r126637]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: Add support to see MTP2 down events when
	  the link layer drops in SS7

2008-06-30 16:07 +0000 [r126574]  Russell Bryant <russell@digium.com>

	* /, include/asterisk/lock.h: Merged revisions 126573 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r126573 | russell | 2008-06-30 11:05:08 -0500 (Mon, 30
	  Jun 2008) | 10 lines Fix a typo in the non-DEBUG_THREADS version
	  of the recently added DEADLOCK_AVOIDANCE() macro. This caused the
	  lock to not actually be released, and as a result, not avoid
	  deadlocks at all. This resolves the issues reported in the last
	  while about Asterisk locking up all over the place (and most
	  commonly, in chan_iax2). (closes issue #12927) (closes issue
	  #12940) (closes issue #12925) (potentially closes others ...)
	  ........

2008-06-30 15:45 +0000 [r126571-126572]  Luigi Rizzo <rizzo@icir.org>

	* channels/console_gui.c, channels/console_video.c,
	  channels/chan_oss.c, channels/console_video.h: implement the
	  'freeze' function for incoming frames; fix a bug which caused a
	  crash when a videodevice was specified after startgui=1 in the
	  config file. This also involves a slightly different method to
	  determine if the gui is active or not.

	* apps/app_voicemail.c: fix an uninitialized variable

2008-06-30 13:03 +0000 [r126517]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: The following patch with some changes for
	  trunk... Merged revisions 126516 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r126516 | oej | 2008-06-30 14:50:55 +0200 (MÃ¥n, 30 Jun 2008) |
	  10 lines Send all responses to an INVITE reliably, so that we
	  retransmit if we don't get an ACK and also fail if we don't get
	  the very same precious ACK. Based on patch by tsearle, with my
	  own additions. (closes issue #12951) Reported by: tsearle
	  Patches: busy_retransmit.patch uploaded by tsearle (license 373)
	  ........

2008-06-30 12:49 +0000 [r126515]  Russell Bryant <russell@digium.com>

	* doc/CODING-GUIDELINES: a few minor updates and typo fixes

2008-06-30 11:57 +0000 [r126513]  Sean Bright <sean.bright@gmail.com>

	* doc/tex/freetds.tex, cdr/cdr_tds.c: Cast a few more strings to
	  char *, so that we can compile cleanly against FreeTDS 0.60.
	  Update the docs to reflect that we can now compile and run
	  against all modern releases of FreeTDS (0.60 through 0.82)

2008-06-29 21:17 +0000 [r126448-126480]  Luigi Rizzo <rizzo@icir.org>

	* channels/console_gui.c, channels/console_video.c,
	  channels/console_board.c: import the recent additions for video
	  console into trunk, giving you support for up to 9 video sources
	  (e.g. webcams, or X11 grabbers, etc.) active at once, displaying
	  thumbnails for each of them in the main GUI window, and with the
	  ability to switch between them on the fly during a conversation.
	  The code also implements a 'Picture in Picture' feature, allowing
	  you to select any source as primary or secondary, and move the
	  PiP window by just dragging it with the mouse. The window looks
	  like this:
	  ________________________________________________________________
	  | ______ ______ ______ ______ ______ ______ ______ | | | tn.1 | |
	  tn.2 | | tn.3 | | tn.4 | | tn.5 | | tn.6 | | tn.7 | | | |______|
	  |______| |______| |______| |______| |______| |______| | | ______
	  ______ ______ ______ ______ ______ ______ | | |______| |______|
	  |______| |______| |______| |______| |______| | |
	  _________________ __________________ _________________ | | | | |
	  | | | | | | | | | | | | | | | | | | | | | | remote video | | | |
	  local video | | | | | | | | ______ | | | | | | keypad | | | PIP
	  || | | | | | | | |______|| | | |_________________| | |
	  |_________________| | | | | | | | | | | |__________________| |
	  |________________________________________________________________|

	* channels/console_gui.c, channels/console_board.c,
	  channels/console_video.h: fix wrong argument in checking
	  boundaries for a rectangle some whitespace fixes

2008-06-29 16:19 +0000 [r126356]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac, pbx/pbx_lua.c, pbx/Makefile,
	  pbx/pbx_gtkconsole.c: various minor fixes created while i worked
	  on getting *every* Asterisk module to build on laptop in dev
	  mode: remove weird pre-setting of LUA paths; they are not
	  necessary; also use the proper path for including the files in
	  pbx_lua.c add searching for OpenAIS libraries in /usr/lib/openais
	  if a path is not specified; not sure if this is really the
	  optimal solution, but it works make the compiler shut up about
	  some ignored function results in pbx_gtkconsole; this module is
	  badly coded anyway

2008-06-29 13:20 +0000 [r126312-126319]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_tds.c: This was bogus, need to find a better way.

	* cdr/cdr_tds.c: While we're at it, escape all the columns in our
	  TDS queries as well. Double quotes seems to be more standard than
	  square brackets (Sybase and SQL Server both support them).

2008-06-29 13:02 +0000 [r126308-126311]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_oss.c: implement a 'toggle' option for 'console
	  mute' and 'console unmute'

	* channels/console_video.h: add some defines and fields in
	  preparation for the import of the video source switching support

	* channels/vgrabbers.c: accept any name starting with X11 for X11
	  grabbers - this lets you have multiple active instances of this
	  grabber; require v4l device names to start with '/dev/' -
	  prevents some useless attempt to open a file as a device.

	* channels/vcodecs.c, channels/console_video.c: make this compile
	  after ast_frame's data field changed to a union

2008-06-29 12:06 +0000 [r126226-126274]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_pgsql.c: Quote column names when inserting CDRs into
	  postgres to avoid conflicts with reserved words. (closes issue
	  #12947) Reported by: panolex

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  UPGRADE.txt, cdr/cdr_tds.c: Merge in changes from my
	  cdr-tds-conversion branch. This changes the internal
	  implementation from using the volatile libtds, to using the
	  db-lib front end. The unintended side effect of this is that we
	  support (at least) versions 0.62 through 0.82 of the FreeTDS
	  distribution without any #ifdef ugliness. (closes issue #12844)
	  Reported by: jcollie

2008-06-28 15:54 +0000 [r126152-126187]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/channel.h: yay for airplane ride
	  optimizations... sort the fields in ast_channel by alignment
	  requirements, saving 36 bytes per instance on a 64-bit platform

	* Makefile: fix silly syntax error

	* Makefile: add message when no UI for menuselect is present

	* Makefile: use batch-mode (no user interface) menuselect for
	  --check-deps operations move automatic user interface selection
	  for menuselect to this Makefile

2008-06-27 23:29 +0000 [r126115]  Sean Bright <sean.bright@gmail.com>

	* main/cdr.c: Pretty up the 'cdr show status' output.

2008-06-27 22:10 +0000 [r126021-126057]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 126056 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r126056 | tilghman | 2008-06-27 17:01:09 -0500 (Fri, 27 Jun 2008)
	  | 4 lines When we get a 408 Timeout, don't stop trying to
	  re-register. (closes issue #12863) Reported by: ricvil ........

	* contrib/scripts/dbsep.cgi: Separate multiple items encoded into a
	  single field with ';'

2008-06-27 19:19 +0000 [r125988]  Russell Bryant <russell@digium.com>

	* doc/siptls.txt: Fix a typo. Someone on IRC copied this literally
	  and then wondered why it wasn't working. :)

2008-06-27 19:05 +0000 [r125980-125984]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: Revert this part of the fix. We'll fix it
	  in libss7

	* channels/chan_dahdi.c: Obviously somebody didn't compile with
	  libss7 support when doing the DAHDI conversion.

	* channels/chan_dahdi.c: Add support for new commands to
	  block/unblock all CICs on a linkset

2008-06-27 17:35 +0000 [r125947]  Brett Bryant <bbryant@digium.com>

	* channels/chan_sip.c: Small error in the function that converts
	  peer transports to a string.

2008-06-27 17:02 +0000 [r125895]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/lock.h: Document DLA_UNLOCK and DLA_LOCK

2008-06-27 16:28 +0000 [r125891]  Brett Bryant <bbryant@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample: Change the way that
	  the transport option works for sip users. transport will now take
	  multiple arguments, the first one listed will be the one used for
	  new dialogs, and the rest listed will be acceptable ways for that
	  peer to contact us. This fixes a minor bug where, because SIP
	  TCP/UDP run on the same port, could cause a TCP peer to be saved
	  in the ast_db. There will also be warnings when a transport is
	  changed for an unexpected reason. (issue #12799)

2008-06-27 16:23 +0000 [r125855-125880]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/lock.h: Optimization suggested by Russell to
	  cache the value of pthread_self() so that it isn't evaluated
	  every time through the loop.

	* apps/app_queue.c: Remove debug message

	* apps/app_queue.c: Ensure the thread-safety of the monexec
	  variable in app_queue. Thanks to Russell for pointing out the
	  problem

2008-06-27 16:00 +0000 [r125853]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_local.c: Revert half of the fix, as this part may
	  have been unnecessary (related to issue #12914) Requested here:
	  http://lists.digium.com/pipermail/asterisk-dev/2008-June/033658.html

2008-06-27 14:14 +0000 [r125799]  Mark Michelson <mmichelson@digium.com>

	* utils/Makefile: Remove an unneeded target from the Makefile

2008-06-27 14:08 +0000 [r125741-125796]  Tilghman Lesher <tlesher@digium.com>

	* Makefile: Push relatively unused compiler options down the list,
	  keeping the popular options at the top.

	* /, main/utils.c, include/asterisk/lock.h: Merged revisions 125793
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r125793 | tilghman | 2008-06-27 08:45:03 -0500 (Fri, 27 Jun 2008)
	  | 2 lines In this debugging function, copy to a buffer instead of
	  using potentially unsafe pointers. ........

	* channels/chan_local.c, /: Merged revisions 125740 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r125740 | tilghman | 2008-06-27 07:19:39 -0500 (Fri, 27
	  Jun 2008) | 7 lines Add proper deadlock avoidance. (closes issue
	  #12914) Reported by: ozan Patches: 20080625__bug12914.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: ozan ........

2008-06-27 07:28 +0000 [r125703]  Philippe Sultan <philippe.sultan@gmail.com>

	* include/asterisk/jabber.h, res/res_jabber.c: Fix a compile time
	  error that occurs if OpenSSL is not installed. Reported by Noel
	  Morais on the users mailing list

2008-06-27 00:22 +0000 [r125647-125666]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Make this compile with dev-mode on

	* apps/app_queue.c: The monitor-join option for queues was
	  deprecated in favor of using MixMonitor to mix audio. However, it
	  was pointed out to me that because of this, the command set for
	  the MONITOR_EXEC variable is ignored as well. This means that
	  people can't do their own custom mixing commands at the end of
	  recordings in order to make, for instance, stereo recordings of
	  calls. With this patch, app_queue will set the "joinfiles"
	  variable for the channel's monitor if MONITOR_EXEC is not
	  zero-length. This means that for normal audio mixing, MixMonitor
	  is still the preferred choice, but we allow custom mixing to be
	  done with the two Monitor streams if desired. (closes issue
	  #12923) Reported by: snyfer

	* apps/app_dial.c, CHANGES: Improve consistency between app_dial
	  and app_queue with regards to how language is handled between two
	  channels whose native language is different. Prior to this patch,
	  app_dial would have the callee inherit the caller's language, and
	  app_queue would not. After this patch, app_dial no longer has the
	  language inheritance capability. This seems to make the most
	  sense since it seems more natural for a person to hear files
	  played back in his/her native language instead of the language of
	  the person on the far end of the call. See the CHANGES file for
	  hints on how to keep the previous behavior of app_dial if
	  desired. (closes issue #12489) Reported by: bcnit

2008-06-26 23:18 +0000 [r125593-125596]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: remove block of commented code to set
	  __ourip This is now handled in skinny_register and load_config.
	  part two of chan_skinny cleanup

	* channels/chan_skinny.c: remove paging device from chan_skinny.
	  This has never been used, and noone could give us info about what
	  it is used for.

2008-06-26 23:06 +0000 [r125591]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix a really stupid mistake

2008-06-26 23:04 +0000 [r125589]  Jason Parker <jparker@digium.com>

	* /, main/utils.c: Merged revisions 125587 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r125587 | qwell | 2008-06-26 18:03:15 -0500 (Thu, 26 Jun 2008) |
	  1 line Make sure to unlock the lock_info lock (huh?). Possible
	  deadlock? ........

2008-06-26 23:01 +0000 [r125586]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 125585 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r125585 | mmichelson | 2008-06-26 17:52:39 -0500 (Thu, 26 Jun
	  2008) | 11 lines Add the interface of a queue member to the
	  output of the "queue show" command so that it can easily be
	  associated with a queue member's name. This helps so that the
	  appropriate queue member can be removed or paused since the
	  interface is required, not the member's name. (closes issue
	  #12783) Reported by: davevg Patches: app_queue.diff uploaded by
	  davevg (license 209) with small mod from me ........

2008-06-26 22:49 +0000 [r125583]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/astcli: Don't hang if the command is blank

2008-06-26 20:57 +0000 [r125477]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Merged revisions 125476 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r125476 | mmichelson | 2008-06-26 15:56:01 -0500 (Thu, 26 Jun
	  2008) | 11 lines Prior to this patch, the "queue show" command
	  used cached information for realtime queues instead of giving
	  up-to-date info. Now realtime is queried for the latest and
	  greatest in queue info. (closes issue #12858) Reported by: bcnit
	  Patches: queue_show.patch uploaded by putnopvut (license 60)
	  ........

2008-06-26 17:40 +0000 [r125386-125438]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c: Don't play "your message has been saved"
	  twice. (closes issue #12893) Reported by: jaroth Patches:
	  duplicate_saved.patch uploaded by jaroth (license 50)

	* codecs/codec_lpc10.c, codecs/codec_a_mu.c, codecs/codec_g722.c,
	  codecs/codec_adpcm.c, codecs/codec_alaw.c, codecs/codec_speex.c,
	  main/translate.c, codecs/codec_g726.c, codecs/codec_gsm.c,
	  codecs/codec_resample.c, codecs/codec_ulaw.c,
	  codecs/codec_ilbc.c, include/asterisk/translate.h: Convert casts
	  to unions, to fix alignment issues on Solaris (closes issue
	  #12932) Reported by: snuffy Patches: bug_12932_20080627.diff
	  uploaded by snuffy (license 35)

2008-06-26 16:54 +0000 [r125385]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 125384 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r125384 | oej | 2008-06-26 18:32:08 +0200 (Tor, 26 Jun 2008) | 3
	  lines Add support for peer realm based auth (a few missing lines,
	  the rest is well documented but never worked) ........

2008-06-26 15:50 +0000 [r125333]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 125327 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r125327 | kpfleming | 2008-06-26 10:30:33 -0500 (Thu, 26
	  Jun 2008) | 5 lines ensure that (whenever possible) if we
	  generate a log message because an ioctl() call to DAHDI/Zaptel
	  failed, that we include the reason it failed by including the
	  stringified error number (issue AST-80) ........

2008-06-26 15:37 +0000 [r125332]  Russell Bryant <russell@digium.com>

	* main/channel.c, res/res_timing_pthread.c, res/res_timing_dahdi.c,
	  include/asterisk/timing.h, main/timing.c: - add get_max_rate
	  timing API call - change ast_settimeout() to honor max rate in
	  edge cases of file playback (this will make some warning messages
	  go away at the end of playing back a file)

2008-06-26 12:09 +0000 [r125279]  Kevin P. Fleming <kpfleming@digium.com>

	* res/res_musiconhold.c: fix compile failure found by buildbot (go,
	  buildbot!)

2008-06-26 11:02 +0000 [r125191-125277]  Tilghman Lesher <tlesher@digium.com>

	* /, main/rtp.c: Merged revisions 125276 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r125276 | tilghman | 2008-06-26 06:01:21 -0500 (Thu, 26 Jun 2008)
	  | 7 lines Check for rtcp structure before trying to delete
	  schedule. (closes issue #12872) Reported by: destiny6628 Patches:
	  20080621__bug12872.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: destiny6628 ........

	* configs/agents.conf.sample, /: Merged revisions 125218 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r125218 | tilghman | 2008-06-25 20:24:26 -0500 (Wed, 25 Jun 2008)
	  | 4 lines Document ackcall=always. (closes issue #12852) Reported
	  by: davidw ........

	* configs/http.conf.sample: Update sample configuration to match
	  what are now the defaults for the prefix. (closes issue #12838,
	  related to issue #12198) Reported by: pabelanger Patches:
	  http.conf.diff2 uploaded by pabelanger (license 224)

2008-06-25 23:05 +0000 [r125138]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_dahdibarge.c, /, apps/app_meetme.c, main/Makefile,
	  apps/app_dahdiscan.c, apps/app_dahdiras.c, configure.ac,
	  res/res_timing_dahdi.c, include/asterisk/dahdi.h (removed),
	  res/res_musiconhold.c, main/channel.c, channels/chan_dahdi.c,
	  apps/app_flash.c, configure, codecs/codec_dahdi.c,
	  apps/app_rpt.c, main/asterisk.c: Merged revisions 125132 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r125132 | kpfleming | 2008-06-25 17:21:30 -0500 (Wed, 25 Jun
	  2008) | 10 lines allow tonezone to live in a different place than
	  DAHDI/Zaptel, since dahdi-tools and dahdi-linux are now separate
	  packages and can be installed in different places don't include
	  tonezone.h in dahdi_compat.h, because only a couple of modules
	  need it get app_rpt building again after the DAHDI changes
	  (closes issue #12911) Reported by: tzafrir ........

2008-06-25 22:40 +0000 [r125133-125135]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/lock.h: Fix indentation

	* include/asterisk/lock.h: Fix a bug in the rwlock tracking.
	  ast_rwlock_unlock did not take into account that multiple threads
	  could hold the same rdlock at the same time. As such, it expected
	  that when a thread released a lock that it must have been the
	  last to acquire the lock as well. Erroneous error messages would
	  be sent to the console stating that a thread was attempting to
	  unlock a lock it did not own. Now all threads are examined to be
	  sure that the message is only printed when it is supposed to be
	  printed.

2008-06-25 19:37 +0000 [r125096]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: implement transfer functionality in
	  chan_skinny (closes issue #9939) Reported by: wedhorn Patches:
	  transfer_v6.diff uploaded by wedhorn (license 30)
	  chan_skinny-transfer-trunk-v10.txt uploaded by DEA (license 3)
	  chan_skinny-transfer-trunk-v12.txt uploaded by mvanbaak (license
	  7) Tested by: DEA, wedhorn, mvanbaak

2008-06-25 16:00 +0000 [r124912-125055]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_curl.c, funcs/func_curl.c, res/res_curl.c (added):
	  Separate the global initialization routines for cURL into its own
	  separate module.

	* channels/chan_dahdi.c, channels/chan_local.c,
	  channels/chan_features.c, channels/chan_h323.c,
	  include/asterisk/lock.h, channels/chan_iax2.c: More expansion of
	  the deadlock avoidance macro, including a macro to do locking of
	  the channel lock

	* channels/chan_dahdi.c, /, include/asterisk/lock.h: Merged
	  revisions 124965 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r124965 | tilghman | 2008-06-24 19:46:24 -0500 (Tue, 24 Jun 2008)
	  | 7 lines Pvt deadlock causes some channels to get stuck in
	  Reserved status. (closes issue #12621) Reported by:
	  fabianoheringer Patches: 20080612__bug12621.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: fabianoheringer ........

	* /, apps/app_voicemail.c: Merged revisions 124910 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r124910 | tilghman | 2008-06-24 16:08:52 -0500 (Tue, 24
	  Jun 2008) | 8 lines Occasionally control characters find their
	  way into CallerID. These need to be stripped prior to placing
	  CallerID in the headers of an email. (closes issue #12759)
	  Reported by: RobH Patches: 20080602__bug12759__2.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: RobH ........

2008-06-24 17:50 +0000 [r124870-124872]  Philippe Sultan <philippe.sultan@gmail.com>

	* res/res_jabber.c: Subscribe to buddy's presence only if we really
	  need to. That is, if the corresponding roster item has a
	  subscription value set to "none" or "from". Make the code more
	  readable.

	* res/res_jabber.c: Code simplification

2008-06-24 11:02 +0000 [r124835]  Sean Bright <sean.bright@gmail.com>

	* UPGRADE.txt, CHANGES: Update CHANGES and UPGRADE.txt per
	  kpfleming's mail to #asterisk-dev.

2008-06-24 02:16 +0000 [r124798]  Russell Bryant <russell@digium.com>

	* res/res_timing_pthread.c: fix a memory leak. (inspired by, and
	  potentially fixes issue #12917)

2008-06-23 15:24 +0000 [r124707]  Dwayne M. Hubbard <dhubbard@digium.com>

	* main/taskprocessor.c: make solaris happy...pointed out by
	  snuff-home on IRC

2008-06-22 17:36 +0000 [r124596-124669]  Sean Bright <sean.bright@gmail.com>

	* configs/meetme.conf.sample: Revert my change to the sample meetme
	  conf file as it was incorrect.

	* configs/meetme.conf.sample: Fix a comment in meetme.conf.sample
	  per jmls via #asterisk-dev (And this time, do it in the correct
	  repository :-))

	* apps/app_rpt.c: Let app_rpt compile.

2008-06-22 02:58 +0000 [r124541]  Steve Murphy <murf@digium.com>

	* apps/app_forkcdr.c, /: Merged revisions 124540 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r124540 | murf | 2008-06-21 20:54:52 -0600 (Sat, 21 Jun 2008) | 9
	  lines (closes issue #12910) Reported by: chris-mac Sorry, my
	  testing did not contain the simple case of forkCDR(v), I am much
	  embarrassed to admit. If I had, I would have more solidly
	  initialized the opts element for varset. ........

2008-06-21 12:53 +0000 [r124396-124505]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_ldap.c: Reduce warning to debug, otherwise we
	  flood the log when we (legitimately) can't find a record. (Closes
	  issue #12908)

	* /, apps/app_rpt.c: Merged revisions 124450 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r124450 | tilghman | 2008-06-20 18:12:33 -0500 (Fri, 20 Jun 2008)
	  | 6 lines usleep with a value over 1,000,000 is nonportable.
	  Changing to use sleep() instead. (closes issue #12814) Reported
	  by: pputman Patches: app_rtp_sleep.patch uploaded by pputman
	  (license 81) ........

	* /, main/app.c: Merged revisions 124395 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r124395 | tilghman | 2008-06-20 17:02:55 -0500 (Fri, 20 Jun 2008)
	  | 3 lines If the last character in a string to be parsed is the
	  delimiter, then we should count that final empty string as an
	  additional argument. ........

2008-06-20 21:43 +0000 [r124392-124393]  Jeff Gehlbach <jeffg@opennms.org>

	* /: (Missed committing . on previous commit.....) Merged revisions
	  124372 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r124372 | jeffg | 2008-06-20 17:14:40 -0400 (Fri, 20 Jun 2008) |
	  1 line Fix issues in digium-mib.txt and asterisk-mib.txt to
	  placate smilint - bug 12905 ........ ................

	* doc/asterisk-mib.txt, doc/digium-mib.txt: Merged revisions 124372
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r124372 | jeffg | 2008-06-20 17:14:40 -0400 (Fri, 20 Jun 2008) |
	  1 line Fix issues in digium-mib.txt and asterisk-mib.txt to
	  placate smilint - bug 12905 ........

2008-06-20 20:17 +0000 [r124316]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_local.c, /: Merged revisions 124315 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r124315 | tilghman | 2008-06-20 15:16:02 -0500 (Fri, 20
	  Jun 2008) | 8 lines When using a Local channel, started by a call
	  file, with a destination of an AGI script, the AGI script does
	  not always get notified of a hangup if the underlying channel
	  hangs up early. (closes issue #11833) Reported by: IgorG Patches:
	  local_hangup-v1.diff uploaded by IgorG (license 20) ........

2008-06-20 16:30 +0000 [r124243-124278]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/doxyref.h, main/ast_expr2f.c, main/ast_expr2.fl:
	  Change references to doc/channelvariables.txt to
	  doc/tex/channelvariables.tex. This issue came up on the
	  asterisk-dev mailing list.

	* channels/chan_sip.c: Add a missing "ChannelType" header to one of
	  the "PeerStatus" manager events in chan_sip (closes issue #12904)
	  Reported by: eliel Patches: chan_sip.c.patch uploaded by eliel
	  (license 64)

2008-06-19 22:59 +0000 [r124183]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 124182 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r124182 | tilghman | 2008-06-19 17:53:22 -0500 (Thu, 19
	  Jun 2008) | 7 lines It's possible for a hangup to be received,
	  even just after the initial cid spill. (closes issue #12453)
	  Reported by: Alex728 Patches: 20080604__bug12453.diff.txt
	  uploaded by Corydon76 (license 14) ........

2008-06-19 22:34 +0000 [r124180]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fix attachment behavior when using IMAP
	  storage for voicemails 1. Filenames had an extra "msg" in the
	  attachment name 2. The attachment was being saved twice (closes
	  issue #12894) Reported by: jaroth Patches: imap_attach.patch
	  uploaded by jaroth (license 50)

2008-06-19 20:48 +0000 [r124127]  Michiel van Baak <michiel@vanbaak.info>

	* doc/CODING-GUIDELINES, channels/chan_sip.c, apps/app_minivm.c,
	  main/logger.c, pbx/pbx_realtime.c, res/res_realtime.c,
	  res/res_musiconhold.c, apps/app_directory.c, apps/app_queue.c,
	  channels/chan_iax2.c, include/asterisk/compiler.h,
	  apps/app_voicemail.c, funcs/func_realtime.c: Older versions of
	  GNU gcc do not allow 'NULL' as sentinel. They want (char *)NULL
	  as sentinel. An example is OpenBSD (confirmed on 4.3) that ships
	  with gcc 3.3.4 This commit introduces a contstant SENTINEL which
	  is declared as: #define SENTINEL ((char *)NULL) All places I
	  could test compile on my openbsd system are converted. Update
	  CODING-GUIDELINES to tell about this constant.

2008-06-19 20:35 +0000 [r124125]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: Oops

2008-06-19 20:30 +0000 [r124121]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 124112 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r124112 | mmichelson | 2008-06-19 15:28:41 -0500 (Thu,
	  19 Jun 2008) | 8 lines Fix IMAP forwarding so that messages are
	  sent to the proper mailbox. (closes issue #12897) Reported by:
	  jaroth Patches: destination_forward.patch uploaded by jaroth
	  (license 50) ........

2008-06-19 20:25 +0000 [r124102]  Tilghman Lesher <tlesher@digium.com>

	* main/netsock.c: Make OpenBSD compile again (reported by mvanbaak
	  via IRC -dev)

2008-06-19 19:48 +0000 [r124064]  Brett Bryant <bbryant@digium.com>

	* main/utils.c: Add errors that report any locks held by threads
	  when they are being closed.

2008-06-19 19:22 +0000 [r124049]  Tilghman Lesher <tlesher@digium.com>

	* configs/users.conf.sample, CHANGES, pbx/pbx_config.c: Allow
	  alternative extensions to be specified for a user. (closes issue
	  #12830) Reported by: jcollie Patches:
	  astertisk-trunk-121496-alternate-extensions.patch uploaded by
	  jcollie (license 412)

2008-06-19 18:57 +0000 [r124024]  Brett Bryant <bbryant@digium.com>

	* channels/chan_sip.c: Fix bug in sip registration that sets the
	  default port to 5060 for tls.

2008-06-19 18:30 +0000 [r124023]  Russell Bryant <russell@digium.com>

	* res/res_timing_pthread.c, main/timing.c: - Make
	  res_timing_pthread allow a max rate of 100/sec instead of 50/sec
	  - change the "timing test" CLI command to let you specify a
	  timing rate to test

2008-06-19 17:55 +0000 [r123870-123988]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/logger.h, configure,
	  include/asterisk/autoconfig.h.in, configure.ac,
	  include/asterisk/sched.h, include/asterisk/compiler.h: Detect if
	  the installed gcc version supports the warn_unused_result
	  attribute. Reported by mvanbaak via IRC -dev.

	* res/res_config_ldap.c: Don't change pointers that need to be
	  later passed back for deallocation. (closes issue #12572)
	  Reported by: flyn Patches: 20080613__bug12572.diff.txt uploaded
	  by Corydon76 (license 14)

	* main/channel.c, /: Merged revisions 123930 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123930 | tilghman | 2008-06-19 11:58:19 -0500 (Thu, 19 Jun 2008)
	  | 5 lines Change informative messages to use the _multiple
	  variant when multiple formats are possible. (Closes issue #12848)
	  Reported by klaus3000 ........

	* /, build_tools/strip_nonapi: Merged revisions 123909 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r123909 | tilghman | 2008-06-19 11:26:03 -0500 (Thu, 19
	  Jun 2008) | 5 lines Only process 40 arguments (20 files) at once
	  with xargs, because some older shells may force xargs to separate
	  on an odd boundary. (Closes issue #12883) Reported by Nik Soggia
	  ........

	* /, configs/sip.conf.sample: Merged revisions 123883 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r123883 | tilghman | 2008-06-19 11:20:41 -0500 (Thu, 19
	  Jun 2008) | 4 lines Correct description of notifyringing option.
	  (Closes issue #12890) Reported by gminet ........

	* /, main/asterisk.c: Merged revisions 123869 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123869 | tilghman | 2008-06-19 11:07:23 -0500 (Thu, 19 Jun 2008)
	  | 6 lines The RDTSC instruction was introduced on the Pentium
	  line of microprocessors, and is not compatible with certain 586
	  clones, like Cyrix. Hence, asking for i386 compatibility was
	  always incorrect. See http://en.wikipedia.org/wiki/RDTSC (Closes
	  issue #12886) Reported by tecnoxarxa ........

2008-06-19 15:55 +0000 [r123867]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Forwarding non-urgent IMAP messages could
	  inadvertently cause the messages to be marked urgent. This fixes
	  that issue. (closes issue #12895) Reported by: jaroth Patches:
	  urgent_forwarding.patch uploaded by jaroth (license 50)

2008-06-19 15:52 +0000 [r123865]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_externalivr.c: Missing comma (closes issue #12891)
	  Reported by: chris-mac

2008-06-19 14:28 +0000 [r123828-123830]  Sean Bright <sean.bright@gmail.com>

	* doc/tex/queuelog.tex: Update the queuelog.tex documentation as
	  well.

	* apps/app_queue.c: Include original position in TRANSFER entries
	  written to queue_log. (closes issue #12888) Reported by: slavon
	  Patches: app_queue_transfer_patch_trunk.diff uploaded by slavon
	  (license 288)

2008-06-18 22:17 +0000 [r123715-123770]  Tilghman Lesher <tlesher@digium.com>

	* /, main/say.c, doc/lang (added), doc/lang/hebrew.ods: Merged
	  revisions 123769 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123769 | tilghman | 2008-06-18 17:08:30 -0500 (Wed, 18 Jun 2008)
	  | 8 lines Add support for saying numbers in Hebrew. (closes issue
	  #11662) Reported by: greenfieldtech Patches: say.c.patch-12042008
	  uploaded by greenfieldtech (license 369) Hebrew-Sounds.ods
	  uploaded by greenfieldtech (with signficant changes to the
	  spreadsheet by me) ........

	* pbx/pbx_spool.c, /: Merged revisions 123710 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123710 | tilghman | 2008-06-18 15:22:42 -0500 (Wed, 18 Jun 2008)
	  | 7 lines Set the variables top-down, so that if a script sets a
	  variable more than once, the last one will take precedence.
	  (closes issue #12673) Reported by: phber Patches:
	  20080519__bug12673.diff.txt uploaded by Corydon76 (license 14)
	  ........

2008-06-18 20:07 +0000 [r123692]  Brett Bryant <bbryant@digium.com>

	* main/tcptls.c: Fix a crash in tcp and tls connections related to
	  reference counts.

2008-06-18 15:08 +0000 [r123650-123652]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: A portion of the code which handled the 'c'
	  queue option had been removed. No telling when it happened.
	  Anyway, it's back in now and works properly. (Based on issue
	  reported on mailing list)

	* apps/app_queue.c: Silly pointers. This fixes a memory corruption
	  I introduced with the attended transfer logging.

2008-06-18 13:09 +0000 [r123648]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c: Channel lock janitor -- add locks around
	  retrieval of channel variables (closes issue #12840) Reported by:
	  pputman Patches: app_dial_threadsafe3.patch uploaded by pputman
	  (license 81)

2008-06-18 00:33 +0000 [r123609]  Sean Bright <sean.bright@gmail.com>

	* res/res_agi.c: Whitespace only

2008-06-17 22:24 +0000 [r123546-123575]  Brett Bryant <bbryant@digium.com>

	* main/astobj2.c: Revert a previous regression in astobj2.c from
	  merging a branch.

	* main/tcptls.c, main/manager.c, channels/chan_sip.c, main/http.c,
	  apps/app_externalivr.c, include/asterisk/tcptls.h,
	  main/astobj2.c: Updates all usages of ast_tcptls_session_instance
	  to be managed by reference counts so that they only get destroyed
	  when all threads are done using them, and memory does not get
	  free'd causing strange issues with SIP. This code was originally
	  written by russellb in the team/group/issue_11972/ branch.

2008-06-17 21:42 +0000 [r123544]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_talkdetect.c: Add an option, specifying maximum analysis
	  time for talk detection. (closes issue #12149) Reported by:
	  davevg Patches: app_talkdetect.c.diff uploaded by davevg (license
	  209) (Plus a few additional cleanups by moi)

2008-06-17 21:33 +0000 [r123456-123541]  Mark Michelson <mmichelson@digium.com>

	* main/astobj2.c: Put quotes around "test"

	* main/astobj2.c: _ys pointed out in #asterisk-bugs that he was
	  experiencing a memory leak when running the astobj2 test CLI
	  command. After searching, it appears the leak was in the command
	  handler itself. Each object was allocated (recount = 1) and then
	  linked into a container (refounct = 2). Then at the end of the
	  function, the container was unreffed, causing all the objects to
	  have their refcount decremented by one, leaving the refcount for
	  all objects allocated in that function at 1. I've now added an
	  extra unref to the mix so that the refcount equals zero when the
	  container is unreffed.

	* /, channels/chan_sip.c: Merged revisions 123485 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123485 | mmichelson | 2008-06-17 15:26:38 -0500 (Tue, 17 Jun
	  2008) | 4 lines Make chan_sip build under dev mode with compilers
	  >= GCC 4.2 Thanks to jpeeler for alerting me of this ........

	* main/astobj2.c: Add the same fix from revision 123271 to
	  container_destruct_debug.

2008-06-17 20:17 +0000 [r123446-123448]  Steve Murphy <murf@digium.com>

	* channels/chan_sip.c, CHANGES: Changes to list peers and users in
	  alpha. order, as per a reasonable request in 12494. Due to
	  changes in trunk to use the astobj2 i/f in the sip channel
	  driver, the order of the entries in the config file was lost,
	  thus the output was in a random order, but no longer.

	* cdr/cdr_tds.c: This solves a crash in the cdr_tds module on 'stop
	  gracefully', for situations where 'settings' is not set to a
	  pointer

2008-06-17 19:00 +0000 [r123393]  Russell Bryant <russell@digium.com>

	* res/res_timing_pthread.c: Fix the check against the max supported
	  rate

2008-06-17 18:57 +0000 [r123358-123392]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 123391 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r123391 | tilghman | 2008-06-17 13:56:53 -0500 (Tue, 17
	  Jun 2008) | 3 lines Fix 3 more places where failure to lock the
	  structure could cause the wrong lock to be unlocked. (Closes
	  issue #12795) ........

	* main/pbx.c: If we don't match registrar when destroying a
	  context, it can cause a crash. (closes issue #12835) Reported by:
	  ys Patches: pbx.c.diff uploaded by ys (license 281)

2008-06-17 18:09 +0000 [r123275-123334]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 123333 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123333 | mmichelson | 2008-06-17 13:09:16 -0500 (Tue, 17 Jun
	  2008) | 11 lines Cisco BTS sends SIP responses with a tab between
	  the Cseq number and SIP request method in the Cseq: header.
	  Asterisk did not handle this properly, but with this patch, all
	  is well. (closes issue #12834) Reported by: tobias_e Patches:
	  12834.patch uploaded by putnopvut (license 60) Tested by:
	  tobias_e ........

	* /, apps/app_queue.c: Merged revisions 123274 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123274 | mmichelson | 2008-06-17 10:56:55 -0500 (Tue, 17 Jun
	  2008) | 12 lines davidw pointed out that the holdtime calculation
	  used by app_queue does not use "boxcar" filtering as the comments
	  say. The term "boxcar" means that the number of samples used to
	  calculate stays constant, with new samples replacing the oldest
	  ones. The queue holdtime calculation uses all holdtime samples
	  collected since the queue was loaded, so the comment has been
	  changed to be accurate. (closes issue #12781) Reported by: davidw
	  ........

2008-06-17 15:52 +0000 [r123272]  Russell Bryant <russell@digium.com>

	* /, main/astobj2.c: Merged revisions 123271 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123271 | russell | 2008-06-17 10:48:31 -0500 (Tue, 17 Jun 2008)
	  | 4 lines Fix a memory leak in astobj2 that was pointed out by
	  seanbright. When a container got destroyed, the underlying bucket
	  list entry for each object that was in the container at that time
	  did not get free'd. ........

2008-06-16 23:05 +0000 [r123238]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: Fix some (more) variables that were
	  forgotten to be renamed, related to 117658

2008-06-16 21:42 +0000 [r123203]  Doug Bailey <dbailey@digium.com>

	* include/asterisk/callerid.h, channels/chan_dahdi.c,
	  main/callerid.c: Clean up code that handles fsk mwi message
	  generation by pulling it from do_monitor and creating its own
	  thread. Added RP-AS mwi message generation using patches from
	  meneault as a basis. (closes issue #8587) Reported by: meneault
	  Tested by: meneault

2008-06-16 21:31 +0000 [r123201]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c: Oopsie, breakage

2008-06-16 21:15 +0000 [r123166]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: Fix some variables that were forgotten to
	  be renamed, related to 117658

2008-06-16 20:43 +0000 [r123165]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, main/pbx.c, main/features.c,
	  include/asterisk/pbx.h, apps/app_queue.c, apps/app_stack.c:
	  (closes issue #12689) Reported by: ys Many thanks to ys for doing
	  the research on this problem. I didn't think it would be best to
	  unlock the contexts and then relock them after the
	  remove_extension2() call, so I added an extra arg to
	  remove_extension2() and set it appropriately in each call. There
	  were not that many. I considered forcing the code to lock the
	  contexts before the call to remove_extension2(), but that would
	  require a slightly greater degree of changes, especially since
	  the find_context_locked is local to pbx.c I did a simple sanity
	  test to make sure the code doesn't mess things up in general.

2008-06-16 20:02 +0000 [r123115]  Chris Tooley <chris@tooley.com>

	* apps/app_externalivr.c: Changes response to the ExternalIVR() P
	  command from pipe delimited to comma delimited. closes issue
	  #12804

2008-06-16 19:57 +0000 [r123111-123114]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, /, channels/chan_sip.c,
	  channels/chan_skinny.c, channels/chan_h323.c,
	  channels/chan_iax2.c, channels/chan_mgcp.c: Merged revisions
	  123113 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123113 | tilghman | 2008-06-16 14:50:12 -0500 (Mon, 16 Jun 2008)
	  | 2 lines Port "hasvoicemail" change from SIP to other channel
	  drivers ........

	* /, channels/chan_sip.c: Merged revisions 123110 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r123110 | tilghman | 2008-06-16 14:21:58 -0500 (Mon, 16 Jun 2008)
	  | 8 lines People expect that if "hasvoicemail" is set in
	  users.conf, even if "mailbox" isn't set, that SIP will detect a
	  mailbox. (closes issue #12855) Reported by: PLL Patches:
	  20080614__bug12855__2.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: PLL ........

2008-06-16 17:33 +0000 [r123009-123076]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_tds.c: Last commit for a bit, minor cleanups and move the
	  lock initialization.

	* cdr/cdr_tds.c: Convert to use stringfields. Still some more work
	  to do on config load/reload.

	* cdr/cdr_tds.c: Remove some unused variables

	* cdr/cdr_tds.c: Coding guidelines stuff only.

2008-06-16 13:31 +0000 [r122923-122977]  Russell Bryant <russell@digium.com>

	* configs/modules.conf.sample: Note that only one timing interface
	  should get loaded.

	* res/res_timing_pthread.c (added): Merge res_timing_pthread. This
	  is a timing interface for Asterisk that does not require DAHDI.
	  It's called "pthread" because it uses a pthread API call in the
	  timing thread for sleeping and ensuring we wake up at an
	  appropriate time. I wasn't sure what else to call it. :) The
	  timing API requires a file descriptor that can be polled on. So,
	  when you open a timer, this module creates a pipe and returns the
	  read end of the pipe. There is a background thread that wakes up
	  every 10ms and checks to see if any of the currently open timers
	  need a 'tick' and writes to the appropriate pipe.

	* include/asterisk/_private.h, main/asterisk.c, main/timing.c: Add
	  a "timing test" CLI command. It opens a timer and configures it
	  for 50 ticks per second, and then counts to see how many ticks it
	  actually gets in a second.

	* main/channel.c, include/asterisk/timing.h, main/timing.c: - Fix a
	  typo in a timing API call - Convert the last part of channel.c
	  over to use the timing API. This would not have made a difference
	  when using the dahdi timing module. I noticed it when trying to
	  use another timing source. Oops. :)

2008-06-16 12:32 +0000 [r122870-122920]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 122919 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r122919 | file | 2008-06-16 09:31:09 -0300 (Mon, 16 Jun 2008) | 6
	  lines Only compare the first 15 characters so that even if the
	  charset is specified we still accept it as SDP. (closes issue
	  #12803) Reported by: lanzaandrea Patches: chan_sip.c.diff
	  uploaded by lanzaandrea (license 496) ........

	* /, channels/chan_sip.c: Merged revisions 122869 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r122869 | file | 2008-06-16 09:08:28 -0300 (Mon, 16 Jun 2008) | 6
	  lines Don't send a BYE on a dialog that is already gone during a
	  REFER. (closes issue #12865) Reported by: flefoll Patches:
	  chan_sip.c.br14.121495.patch-ALREADYGONE uploaded by flefoll
	  (license 244) ........

2008-06-16 03:33 +0000 [r122834]  Sean Bright <sean.bright@gmail.com>

	* apps/app_fax.c (added): Resurrected app_fax

2008-06-15 15:21 +0000 [r122802]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c, funcs/func_channel.c, UPGRADE.txt,
	  channels/chan_iax2.c: Add some more IAX2-specific information
	  about the channel to the CHANNEL() function and begin the
	  transition from SIPCHANINFO() to just using CHANNEL(). (closes
	  issue #12856) Reported by: mostyn Patches:
	  iax_and_sip_channel_info.patch uploaded by mostyn (license 398)
	  (with some additional cleanup by me)

2008-06-13 22:52 +0000 [r122716-122766]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/config.h: Document the input for
	  ast_realtime_require_field()

	* res/res_config_pgsql.c: Properly detect the size of char/varchar
	  fields

2008-06-13 21:45 +0000 [r122714]  Mark Michelson <mmichelson@digium.com>

	* main/autoservice.c, /: Merged revisions 122713 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r122713 | mmichelson | 2008-06-13 16:44:53 -0500 (Fri, 13 Jun
	  2008) | 9 lines Short circuit the loop in autoservice_run if
	  there are no channels to poll. If we continued, then the result
	  would be calling poll() with a NULL pollfd array. While this is
	  fine with POSIX's poll(2) system call, those who use Asterisk's
	  internal poll mechanism (Darwin systems) would have a failed
	  assertion occur when poll is called. (related to issue #10342)
	  ........

2008-06-13 14:15 +0000 [r122557]  Tilghman Lesher <tlesher@digium.com>

	* main/dial.c: Convert one more delimiter to use comma. (closes
	  issue #12850) Reported by: bcnit Patches:
	  20080613__bug12850.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: bcnit

2008-06-13 12:53 +0000 [r122523-122526]  Russell Bryant <russell@digium.com>

	* res/res_timing_dahdi.c: Do not allow res_timing_dahdi to be
	  unloaded. We can re-enable this once we add automatic use count
	  handling for timing modules.

	* main/channel.c, res/res_timing_dahdi.c (added), main/file.c,
	  include/asterisk/timing.h, include/asterisk/channel.h,
	  channels/chan_iax2.c, main/asterisk.c, main/timing.c: Merge
	  changes from timing branch - Convert chan_iax2 to use the timing
	  API - Convert usage of timing in the core to use the timing API
	  instead of using DAHDI directly - Make a change to the timing API
	  to add the set_rate() function - change the timing core to use a
	  rwlock - merge a timing implementation, res_timing_dahdi Basic
	  testing was successful using res_timing_dahdi

2008-06-13 11:20 +0000 [r122493]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: Implement call parking in chan_skinny.
	  (closes issue #11342) Reported by: DEA Patches:
	  chan_skinny-park.txt uploaded by DEA (license 3)
	  chan_skinny-park-v2.diff.txt uploaded by mvanbaak (license 7)
	  Tested by: DEA, mvanbaak

2008-06-12 23:58 +0000 [r122461]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix a segfault by not trying to store a stack
	  address for long-term use. Instead use the heap. I can't believe
	  this never happened *once* in my developer branch when I was
	  testing.

2008-06-12 23:08 +0000 [r122433]  Jeff Peeler <jpeeler@digium.com>

	* main/features.c, apps/app_parkandannounce.c: (closes issue
	  0012193) Reported by: davidw Patch by: Corydon76, modified by me
	  to work properly with ParkAndAnnounce app

2008-06-12 21:23 +0000 [r122399]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Recommitting revision 122228, which was
	  accidentally reverted as a result of commit 122234.

2008-06-12 20:38 +0000 [r122371]  Russell Bryant <russell@digium.com>

	* include/asterisk/timing.h: Complete the documentation for the
	  timing API.

2008-06-12 18:53 +0000 [r122312]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 122311 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r122311 | mmichelson | 2008-06-12 13:50:58 -0500 (Thu, 12 Jun
	  2008) | 9 lines Properly play a holdtime message if the
	  announce-holdtime option is set to "once." (closes issue #12842)
	  Reported by: ramonpeek Patches: patch001.diff uploaded by
	  ramonpeek (license 266) ........

2008-06-12 18:23 +0000 [r122262]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 122259 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r122259 | russell | 2008-06-12 13:22:44 -0500 (Thu, 12
	  Jun 2008) | 3 lines Fix some race conditions that cause
	  ast_assert() to report that chan_iax2 tried to remove an entry
	  that wasn't in the scheduler ........

2008-06-12 17:49 +0000 [r122243-122244]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: Fix pseudo channel allocation errors on
	  startup when using SS7. (from mattf r121914, moving from chan_zap
	  to chan_dahdi)

	* channels/chan_dahdi.c: Make sure we hangup any calls we have and
	  NULL out the ss7call value when we get a reset circuit message.
	  Fixes crash bug. (from mattf r121857, moving from chan_zap to
	  chan_dahdi)

2008-06-12 17:38 +0000 [r122241]  Russell Bryant <russell@digium.com>

	* include/asterisk/network.h: Get default entity ID determination
	  working on Linux again (closes issue #12839)

2008-06-12 17:30 +0000 [r122240]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/timing.h: clarify documentation on how timer
	  intervals should be specified

2008-06-12 17:27 +0000 [r122234]  Jeff Peeler <jpeeler@digium.com>

	* README, apps/app_dahdibarge.c (added),
	  contrib/init.d/rc.mandrake.asterisk, /,
	  include/asterisk/autoconfig.h.in, apps/app_dahdiscan.c (added),
	  apps/app_chanisavail.c, channels/chan_iax2.c,
	  configs/muted.conf.sample, main/loader.c,
	  include/asterisk/doxyref.h, channels/chan_dahdi.c (added),
	  configure, apps/app_zapscan.c (removed), main/features.c,
	  doc/tex/backtrace.tex, doc/tex/app-sms.tex, apps/app_zapras.c
	  (removed), configs/extensions.lua.sample,
	  include/asterisk/options.h, contrib/init.d/rc.suse.asterisk,
	  apps/app_dial.c, apps/app_page.c, doc/tex/hardware.tex,
	  apps/app_fax.c (removed), apps/app_dahdiras.c (added),
	  configs/queues.conf.sample, configure.ac,
	  include/asterisk/channel.h, doc/tex/configuration.tex,
	  configs/zapata.conf.sample, Makefile, apps/app_zapbarge.c
	  (removed), doc/janitor-projects.txt, configs/vpb.conf.sample,
	  doc/sms.txt, codecs/codec_dahdi.c (added),
	  contrib/scripts/loadtest.tcl, configs/smdi.conf.sample,
	  pbx/pbx_config.c, apps/app_chanspy.c, main/asterisk.c,
	  configs/users.conf.sample, doc/ss7.txt, apps/app_meetme.c,
	  configs/rpt.conf.sample, doc/backtrace.txt,
	  doc/tex/queues-with-callback-members.tex, res/res_musiconhold.c,
	  configs/extensions.ael.sample, include/asterisk/dahdi.h (added),
	  contrib/init.d/rc.mandrake.zaptel, codecs/codec_zap.c (removed),
	  configs/meetme.conf.sample, cdr/cdr_csv.c, main/channel.c,
	  doc/tex/manager.tex, doc/tex/sla.tex, include/asterisk/dsp.h,
	  doc/tex/localchannel.tex, apps/app_rpt.c, channels/chan_mgcp.c,
	  contrib/scripts/autosupport, doc/manager_1_1.txt,
	  channels/chan_zap.c (removed), doc/asterisk.8,
	  doc/tex/channelvariables.tex, doc/tex/ael.tex, apps/app_queue.c,
	  doc/tex/enum.tex, apps/app_getcpeid.c, doc/tex/security.tex,
	  configs/sla.conf.sample, include/asterisk/zapata.h (removed),
	  build_tools/menuselect-deps.in, doc/tex/privacy.tex,
	  apps/app_flash.c, doc/osp.txt, main/file.c,
	  contrib/utils/zones2indications.c, utils/extconf.c, makeopts.in,
	  doc/asterisk.sgml, configs/extensions.conf.sample: Goodbye
	  Zaptel, hello DAHDI. Removes Zaptel driver support with DAHDI.
	  Configuration file and dialplan backwards compatability has been
	  put in place where appropiate. Release announcement to follow.

2008-06-12 17:14 +0000 [r122232]  Russell Bryant <russell@digium.com>

	* channels/misdn/isdn_lib.c: Make this build under dev mode

2008-06-12 16:25 +0000 [r122228]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merging the work done in the
	  queue-log-atxfer branch. The net result of this work is that
	  attended transfers made by queue members will now show up in the
	  queue_log as a TRANSFER message instead of COMPLETECALLER as it
	  had been. As far as the details go, I created a datastore which
	  is attached to the calling channel just prior to when the caller
	  is bridged with the queue member. If the calling channel is
	  masqueraded, then during the "fixup" portion, the TRANSFER will
	  be logged and the datastore will be removed.

2008-06-12 15:26 +0000 [r122131-122174]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_meetme.c: Merged revisions 122137 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r122137 | tilghman | 2008-06-12 10:18:39 -0500 (Thu, 12 Jun 2008)
	  | 8 lines Flipflop the sections for two options, since the
	  section for 'X' (exit context) may otherwise absorb keypresses
	  meant for 's' (admin/user menu). (closes issue #12836) Reported
	  by: blitzrage Patches: 20080611__bug12836.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: blitzrage ........

	* main/channel.c, /: Merged revisions 122130 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r122130 | tilghman | 2008-06-12 10:11:30 -0500 (Thu, 12 Jun 2008)
	  | 4 lines Occasionally, the alertpipe loses its nonblocking
	  status, so detect and correct that situation before it causes a
	  deadlock. (Reported and tested by ctooley via #asterisk-dev)
	  ........

2008-06-12 14:56 +0000 [r122091-122128]  Steve Murphy <murf@digium.com>

	* main/cdr.c, apps/app_forkcdr.c, /, CHANGES: Merged revisions
	  122127 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r122127 | murf | 2008-06-12 08:51:44 -0600 (Thu, 12 Jun 2008) | 1
	  line Arkadia tried to warn me, but the code added to
	  ast_cdr_busy, _failed, and _noanswer was redundant. Didn't spot
	  it until I was resolving conflicts in trunk. Ugh. Redundant code
	  removed. It wasn't harmful. Just dumb. ........

	* main/cdr.c, apps/app_forkcdr.c, /, funcs/func_cdr.c,
	  include/asterisk/cdr.h, CHANGES: Merged revisions 122046 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r122046 | murf | 2008-06-12 07:47:34 -0600 (Thu, 12 Jun 2008) |
	  37 lines (closes issue #10668) Reported by: arkadia Tested by:
	  murf, arkadia Options added to forkCDR() app and the CDR() func
	  to remove some roadblocks for CDR applications. The "show
	  application ForkCDR" output was upgraded to more fully explain
	  the inner workings of forkCDR. The A option was added to forkCDR
	  to force the CDR system to NOT change the disposition on the
	  original CDR, after the fork. This involves ast_cdr_answer,
	  _busy, _failed, and so on. The T option was added to forkCDR to
	  force obedience of the cdr LOCKED flag in the ast_cdr_end, all
	  the disposition changing funcs (ast_cdr_answer, etc), and in the
	  ast_cdr_setvar func. The CHANGES file was updated to explain ALL
	  the new options added to satisfy this bug report (and some
	  requests made verbally and via email, irc, etc, over the past
	  months/year) The 's' option was added to the CDR() func, to force
	  it to skip LOCKED cdr's in the chain. Again, the new options
	  should be totally transparent to existing apps! Current behavior
	  of CDR, forkCDR, and the rest of the CDR system should not change
	  one little bit. Until you add the new options, at least! ........

2008-06-12 14:21 +0000 [r122062]  Kevin P. Fleming <kpfleming@digium.com>

	* main/Makefile, include/asterisk/timing.h (added), main/timing.c
	  (added): add infrastructure so that timing source can be a
	  loadable module... next steps are to convert channel.c and
	  chan_iax2.c to use this new API, and to move all the
	  DAHDI-specific timing source code into a new res_timing_dahdi
	  module

2008-06-12 14:06 +0000 [r122047]  Russell Bryant <russell@digium.com>

	* main/netsock.c: Don't log not being able to set a default EID.
	  Most people don't care, and those that do can check their setup
	  using CLI commands. (closes issue #12839)

2008-06-11 21:38 +0000 [r121955]  Terry Wilson <twilson@digium.com>

	* main/features.c: Initialize parkingtime to DEFAULT_PARK_TIME
	  instead of 0

2008-06-11 18:53 +0000 [r121914]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Fix pseudo channel allocation errors on
	  startup when using SS7

2008-06-11 18:19 +0000 [r121867]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c, /, channels/chan_agent.c, main/abstract_jb.c,
	  main/sched.c: Merged revisions 121861 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r121861 | tilghman | 2008-06-11 13:18:16 -0500 (Wed, 11 Jun 2008)
	  | 3 lines Make calls to ast_assert() actually test something, so
	  that the error message printed is not nonsensical (reported by
	  mvanbaak via #asterisk-bugs). ........

2008-06-11 17:50 +0000 [r121857]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Make sure we hangup any calls we have and
	  NULL out the ss7call value when we get a reset circuit message.
	  Fixes crash bug

2008-06-11 17:44 +0000 [r121855]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/realtime_pgsql.sql, UPGRADE.txt,
	  include/asterisk/cdr.h: Expand CDR uniqueid field to 150 chars,
	  to account for maximum systemname. (Closes issue #12831)

2008-06-11 16:11 +0000 [r121805]  Jeff Peeler <jpeeler@digium.com>

	* /, doc/backtrace.txt: Merged revisions 121804 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r121804 | jpeeler | 2008-06-11 11:11:09 -0500 (Wed, 11 Jun 2008)
	  | 1 line add instructions for logging gdb output via set logging
	  on ........

2008-06-11 11:52 +0000 [r121770]  Christian Richter <christian.richter@beronet.com>

	* /, channels/misdn/isdn_lib.c: Merged revisions 121751 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r121751 | crichter | 2008-06-11 11:28:04 +0200 (Mi, 11 Jun 2008)
	  | 1 line fixed issue with previous commit, the find_free_channel
	  test for channels which where inuse was broken. ........

2008-06-10 21:51 +0000 [r121716]  Russell Bryant <russell@digium.com>

	* doc/distributed_devstate.txt: don't refer to asterisk-events, as
	  that implies that the code was checked out from a branch

2008-06-10 21:14 +0000 [r121683]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/res_odbc.h, res/res_config_odbc.c,
	  res/res_odbc.c: Move the table cache routines to res_odbc, so
	  they can be used from other places (app_voicemail, for example).
	  (Related to bug #11678)

2008-06-10 19:52 +0000 [r121649]  Mark Michelson <mmichelson@digium.com>

	* main/event.c: Add an additional sanity check in case an event is
	  passed between Asterisk boxes with mismatched ie_maps.

2008-06-10 19:03 +0000 [r121599]  Donny Kavanagh <donnyk@gmail.com>

	* codecs/codec_ilbc.c: Revision 117802 changed frame.data to
	  frame.data.ptr however codec_ilbc.c was not updated. This
	  resolves that oversight.

2008-06-10 18:35 +0000 [r121597]  Sean Bright <sean.bright@gmail.com>

	* /, contrib/scripts/get_ilbc_source.sh: Merged revisions 121596
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r121596 | seanbright | 2008-06-10 14:34:45 -0400 (Tue, 10 Jun
	  2008) | 6 lines Fixes a problem with some buggy versions of GNU
	  awk (3.1.3) not liking carriage returns in scripts. (closes issue
	  #12749) Reported by: alinux Tested by: Laureano (on
	  #asterisk-dev), juggie ........

2008-06-10 15:12 +0000 [r121555-121559]  Russell Bryant <russell@digium.com>

	* main/pbx.c, res/res_ais.c (added), res/ais/clm.c,
	  doc/distributed_devstate.txt (added), res/ais/evt.c, res/ais
	  (added), main/devicestate.c, res/Makefile, res/ais/ais.h,
	  configs/ais.conf.sample (added), CHANGES, apps/app_queue.c: Merge
	  another big set of changes from team/russell/events This commit
	  merges in the rest of the code needed to support distributed
	  device state. There are two main parts to this commit. Core
	  changes: - The device state handling in the core has been updated
	  to understand device state across a cluster of Asterisk servers.
	  Every time the state of a device changes, it looks at all of the
	  device states on each node, and determines the aggregate device
	  state. That resulting device state is what is provided to modules
	  in Asterisk that take actions based on the state of a device. New
	  module, res_ais: - A module has been written to facilitate the
	  communication of events between nodes in a cluster of Asterisk
	  servers. This module uses the SAForum AIS (Service Availability
	  Forum Application Interface Specification) CLM and EVT services
	  (Cluster Management and Event) to handle this task. This module
	  currently supports sharing Voicemail MWI (Message Waiting
	  Indication) and device state events between servers. It has been
	  tested with openais, though other implementations of the spec do
	  exist. For more information on testing distributed device state,
	  see the following doc: - doc/distributed_devstate.txt

	* include/asterisk/event.h, include/asterisk/event_defs.h,
	  main/event.c: Merge some more changes from team/russell/events
	  This commit pulls in a batch of improvements and additions to the
	  event API. Changes include: - the ability to dynamically build a
	  subscription. This is useful if you're building a subscription
	  based on something you receive from the network, or from options
	  in a configuration file. - Add tables of event types and IE types
	  and the corresponding string representation for implementing text
	  based protocols that use these events, for showing events on the
	  CLI, reading configuration that references event information,
	  among other things. - Add a table that maps IE types and the
	  corresponding payload type. - an API call to get the total size
	  of an event - an API call to get all events from the cache that
	  match a subscription - a new IE payload type, raw, which I used
	  for transporting the Entity ID in my code for handling
	  distributed device state. - Code improvements to reduce code
	  duplication - Include the Entity ID of the server that originated
	  the event in every event - an additional event type,
	  DEVICE_STATE_CHANGE, to help facilitate distributed device state.
	  DEVICE_STATE is a state change on one server, DEVICE_STATE_CHANGE
	  is the aggregate device state change across all servers.

2008-06-10 14:11 +0000 [r121503]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Fix issue where session timer headers were
	  present when they should not have been. (closes issue #12706)
	  Reported by: falves11 Patches: chan_sip.c.diff uploaded by rjain
	  (license 226) Tested by: falves11

2008-06-10 14:06 +0000 [r121501]  Russell Bryant <russell@digium.com>

	* include/asterisk/devicestate.h, main/pbx.c, main/devicestate.c:
	  Merge another change from team/russell/events This commit breaks
	  out some logic from pbx.c into a simple API. The hint processing
	  code had logic for taking the state from multiple devices and
	  turning that into the state for a single extension. So, I broke
	  this out and made an API that lets you take multiple device
	  states and determine the aggregate device state. I needed this
	  for some core device state changes to support distributed device
	  state.

2008-06-10 13:36 +0000 [r121444-121496]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 121495 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r121495 | file | 2008-06-10 10:34:27 -0300 (Tue, 10 Jun 2008) | 4
	  lines If we are destroying a dialog only set the MWI dialog
	  pointer on the related peer to NULL if it is the dialog currently
	  being destroyed. (closes issue #12828) Reported by: ramonpeek
	  ........

	* main/channel.c, /: Merged revisions 121442 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r121442 | file | 2008-06-10 09:52:06 -0300 (Tue, 10 Jun 2008) | 4
	  lines Update BRIDGEPEER variable before we do a generic bridge in
	  case we just broke out of a native bridge and fell through to
	  generic. (closes issue #12815) Reported by: ramonpeek ........

2008-06-10 12:50 +0000 [r121401-121441]  Russell Bryant <russell@digium.com>

	* configs/dundi.conf.sample: Update dundi.conf to indicate that the
	  asterisk.conf entityid option can be used to set the entityid
	  used in DUNDi, as well.

	* include/asterisk/utils.h, main/pbx.c, include/asterisk/dundi.h,
	  doc/tex/channelvariables.tex, pbx/pbx_dundi.c,
	  pbx/dundi-parser.c, main/asterisk.c, main/netsock.c,
	  doc/tex/asterisk-conf.tex, pbx/dundi-parser.h: Merge another
	  change from team/russell/events ... DUNDi uses a concept called
	  the Entity ID for unique server identifiers. I have pulled out
	  the handling of EIDs and made it something available to all of
	  Asterisk. There is now a global Entity ID that can be used for
	  other purposes as well, such as code providing distributed device
	  state, which is why I did this. The global Entity ID is set
	  automatically, just like it was done in DUNDi, but it can also be
	  set in asterisk.conf. DUNDi will now use this global EID unless
	  one is specified in dundi.conf. The current EID for the system
	  can be seen in the "core show settings" CLI command. It is also
	  available in the dialplan via the ENTITYID variable.

	* channels/chan_iax2.c: Bump up the debug level of a couple of
	  messages

	* build_tools/menuselect-deps.in, configure,
	  include/asterisk/autoconfig.h.in, configure.ac, makeopts.in:
	  Merge a couple of configure script checks in from
	  team/russell/events. This adds the checks for the CLM and EVT
	  services from the SAForum AIS. I'm going to work on merging in
	  changes from this branch in pieces.

	* main/taskprocessor.c: Properly initialize the cli_ping condition
	  and lock

	* main/taskprocessor.c: Change system header includes to be like
	  how it is done in other files

2008-06-09 22:51 +0000 [r121367]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_curl.c, res/res_config_pgsql.c,
	  res/res_config_odbc.c, apps/app_meetme.c, channels/chan_sip.c,
	  include/asterisk/config.h, main/utils.c, apps/app_queue.c,
	  channels/chan_iax2.c, apps/app_voicemail.c: Expand RQ_INTEGER
	  type out to multiple types, one for each precision

2008-06-09 22:42 +0000 [r121365]  Terry Wilson <twilson@digium.com>

	* main/taskprocessor.c: Initialize the lock and destroy lock and
	  cond in the destructor (thanks, mmichelson)

2008-06-09 19:33 +0000 [r121334]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: Add storage of the useragent in the realtime
	  database. (Closes AST-38)

2008-06-09 16:55 +0000 [r121282-121286]  Russell Bryant <russell@digium.com>

	* main/dsp.c: arbitrary formatting change to test mantis change
	  (closes issue #12824)

	* main/channel.c: arbitrary formatting change to test a mantis
	  change (closes issue #12824)

	* main/channel.c: Minor formatting change to test a mantis change
	  ... (closes issue #12824)

	* main/channel.c, /: Merged revisions 121280 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r121280 | russell | 2008-06-09 11:35:40 -0500 (Mon, 09 Jun 2008)
	  | 10 lines Do not attempt to do emulation if an END digit is
	  received and the length is less than the defined minimum digit
	  length, and the other end only wants END digits (SIP INFO, for
	  example). (closes issue #12778) Reported by: tsearle Patches:
	  12778.rev1.txt uploaded by russell (license 2) Tested by: tsearle
	  ........

2008-06-09 16:35 +0000 [r121279]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c: Implement FINDLABEL matching for the new extension
	  matching engine. (closes issue #12800) Reported by: chris-mac
	  Patches: 20080608__bug12800.diff.txt uploaded by Corydon76
	  (license 14)

2008-06-09 15:08 +0000 [r121230]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_agent.c: Merged revisions 121229 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4 (Note
	  that this is being merged to trunk/1.6.0 because it may affect
	  non-callback agents with ackcall set) ........ r121229 |
	  mmichelson | 2008-06-09 10:02:37 -0500 (Mon, 09 Jun 2008) | 16
	  lines A unique situation of timeouts brought forth a failure
	  situation for autologoff in chan_agent. If using
	  AgentCallbackLogin-style agents, then if the timeout specified by
	  the Dial() to reach the agent's phone was shorter than the
	  timeout specified in queues.conf, then autologoff would only work
	  if the caller hung up while the agent's phone was ringing. This
	  patch allows autologoff to work in this situation when the call
	  in queue transfers to the next available agent (as it would have
	  if the timeout in queues.conf were less than the timeout in the
	  Dial()). (closes issue #12754) Reported by: Rodrigo Patches:
	  12754.patch uploaded by putnopvut (license 60) Tested by: Rodrigo
	  ........

2008-06-08 11:40 +0000 [r121197]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_privacy.c, CHANGES: add a new argument to PrivacyManager
	  to specify a context where the entered phone number is checked.
	  You can now define a set of extensions/exten patterns that
	  describe valid phone numbers. PrivacyManager will check that
	  context for a match with the given phone number. This way you get
	  better control. For example people blindly hitting 10 digits just
	  to get past privacymanager Example line in extensions.conf: exten
	  => incoming,n,PrivacyManager(3,10,,route-outgoing)

2008-06-08 01:41 +0000 [r121131-121163]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_console.c: This was accidentally reverted. Fixes a
	  bug where if a stream monitor thread was not created (caused from
	  failure of opening or starting the stream) pthread_cancel was
	  called with an invalid thread ID.

	* apps/app_parkandannounce.c: Fixes segfault when using
	  ParkAndAnnounce. Also, loop made more efficient as announce
	  template only needs to be checked until the number of colon
	  separated arguments run out, not the entire pointer storage
	  array. Was done in a similiar fashion in 1.4, but here we're
	  using less variables.

2008-06-07 14:18 +0000 [r121079]  Russell Bryant <russell@digium.com>

	* channels/chan_local.c, /, channels/chan_agent.c: Merged revisions
	  121078 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r121078 | russell | 2008-06-07 09:10:56 -0500 (Sat, 07 Jun 2008)
	  | 7 lines Don't run LIST_HEAD_DESTROY on a STATIC list (closes
	  issue #12807) Reported by: ys Patches: chan_agent_local.diff
	  uploaded by ys (license 281) ........

2008-06-06 20:24 +0000 [r121010-121042]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c, CHANGES: Added a facility for sending
	  arbitrary SIP notify commands from AMI. (closes issue #12562)
	  Reported by: michael-fig Patches: 20080515__bug12562.diff.txt
	  uploaded by Corydon76 (license 14)

	* main/pbx.c: Make extension match characters case-insensitive.
	  (closes issue #12777) Reported by: jsmith Patches:
	  lower_case_patterns-trunk-v1.patch uploaded by jsmith (license
	  15)

2008-06-06 18:30 +0000 [r120906-120960]  Jeff Peeler <jpeeler@digium.com>

	* /, channels/chan_sip.c: Merged revisions 120959 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120959 | jpeeler | 2008-06-06 13:29:14 -0500 (Fri, 06 Jun 2008)
	  | 1 line add another LOW_MEMORY define I forgot ........

	* /, channels/chan_sip.c: Merged revisions 120908 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120908 | jpeeler | 2008-06-06 13:05:15 -0500 (Fri, 06 Jun 2008)
	  | 1 line only define thread storage variable if necessary for
	  LOW_MEMORY ........

	* /, channels/chan_sip.c, main/features.c: Merged revisions
	  120863,120885 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120863 | jpeeler | 2008-06-06 10:33:15 -0500 (Fri, 06 Jun 2008)
	  | 3 lines This fixes a crash when LOW_MEMORY is turned on. Two
	  allocations of the ast_rtp struct that were previously allocated
	  on the stack have been modified to use thread local storage
	  instead. ........ r120885 | jpeeler | 2008-06-06 11:39:20 -0500
	  (Fri, 06 Jun 2008) | 2 lines Correction to commmit 120863, make
	  sure proper destructor function is called as well define two
	  thread storage local variables. ........

2008-06-06 17:34 +0000 [r120904]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_exec.c: For the purpose of making the changed syntax to
	  ExecIf easier to transition, allow the deprecated syntax (fixed
	  for jmls on -dev).

2008-06-05 21:34 +0000 [r120828]  Steve Murphy <murf@digium.com>

	* main/pbx.c: a small fix for a crash that occurs when compiling
	  AEL with global vars

2008-06-05 19:07 +0000 [r120789]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_curl.c, include/asterisk/res_odbc.h,
	  res/res_config_pgsql.c, res/res_config_odbc.c, apps/app_meetme.c,
	  channels/chan_sip.c, include/asterisk/config.h,
	  contrib/scripts/dbsep.cgi, apps/app_queue.c,
	  channels/chan_iax2.c, main/config.c,
	  configs/res_pgsql.conf.sample, apps/app_voicemail.c: Merge the
	  adaptive realtime branch, which will make adding new required
	  fields to realtime less painful in the future.

2008-06-05 18:03 +0000 [r120733-120734]  Russell Bryant <russell@digium.com>

	* UPGRADE-1.2.txt: revert 120733, wrong branch

	* UPGRADE-1.2.txt: Update file names

2008-06-05 17:02 +0000 [r120676]  Philippe Sultan <philippe.sultan@gmail.com>

	* /, res/res_jabber.c: Merged revisions 120675 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120675 | phsultan | 2008-06-05 18:56:15 +0200 (Thu, 05 Jun 2008)
	  | 2 lines Ignore appended resource when comparing JIDs. ........

2008-06-05 16:41 +0000 [r120635-120673]  Brett Bryant <bbryant@digium.com>

	* CHANGES: Update CHANGES file for the things done in revision
	  120635.

	* channels/chan_sip.c, funcs/func_channel.c,
	  include/asterisk/rtp.h, main/rtp.c: This patch adds more detailed
	  statistics for RTP channels, and provides an API call to access
	  it, including maximums, minimums, standard deviatinos, and normal
	  deviations. Currently this is implemented for chan_sip, but could
	  be added to the func_channel_read callbacks for the CHANNEL
	  function for any channel that uses RTP. (closes issue #10590)
	  Reported by: gasparz Patches: chan_sip_c.diff uploaded by gasparz
	  (license 219) rtp_c.diff uploaded by gasparz (license 219)
	  rtp_h.diff uploaded by gasparz (license 219) audioqos-trunk.diff
	  uploaded by snuffy (license 35) rtpqos-trunk-r119891.diff
	  uploaded by sergee (license 138) Tested by: jsmith, gasparz,
	  snuffy, marsosa, chappell, sergee

2008-06-05 15:58 +0000 [r120567-120602]  Tilghman Lesher <tlesher@digium.com>

	* res/res_agi.c, apps/app_stack.c, main/loader.c: Conditionally
	  load the AGI command gosub, depending on whether or not res_agi
	  has been loaded, fix a return value in the loader, and ensure
	  that the help workhorse header does not print on load.

	* UPGRADE.txt: Add info on the [compat] section of asterisk.conf.

2008-06-04 22:07 +0000 [r120514]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 120513 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120513 | mmichelson | 2008-06-04 17:05:33 -0500 (Wed, 04 Jun
	  2008) | 6 lines Make sure that the string we set will survive the
	  unref of the queue member. Thanks to Russell, who pointed this
	  out. ........

2008-06-04 20:34 +0000 [r120426-120477]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c: MSet doesn't necessarily need chan to be set

	* channels/chan_zap.c, /: Merged revisions 120425 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120425 | tilghman | 2008-06-04 13:35:47 -0500 (Wed, 04 Jun 2008)
	  | 6 lines If we fail to setup the PRI request channel, don't
	  continue, exit with an error. (closes issue #11989) Reported by:
	  Corydon76 Patches: 20080213__zap_memleak.diff.txt uploaded by
	  Corydon76 (license 14) ........

2008-06-04 15:38 +0000 [r120337]  Joshua Colp <jcolp@digium.com>

	* pbx/pbx_config.c: We like tabs.

2008-06-04 14:12 +0000 [r120286]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 120285 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120285 | mmichelson | 2008-06-04 09:11:12 -0500 (Wed, 04 Jun
	  2008) | 7 lines Tab completion when removing a member should give
	  the member's interface, not the name, since the interface is what
	  is expected for the command. (closes issue #12783) Reported by:
	  davevg ........

2008-06-04 13:33 +0000 [r120283]  Joshua Colp <jcolp@digium.com>

	* /, pbx/pbx_config.c: Merged revisions 120282 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120282 | file | 2008-06-04 10:31:09 -0300 (Wed, 04 Jun 2008) | 6
	  lines Fix a log message and add a message for when the dialplan
	  is done reloading. (closes issue #12716) Reported by: chappell
	  Patches: dialplan_reload_2.diff uploaded by chappell (license 8)
	  ........

2008-06-03 23:17 +0000 [r120227-120230]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_channel.c: Add a function, CHANNELS(), which retrieves
	  a list of all active channels. (closes issue #11330) Reported by:
	  rain Patches: func_channel-channel_list_function.diff uploaded by
	  rain (license 327) (with some additional changes by me, mostly to
	  meet coding guidelines)

	* pbx/pbx_loopback.c, /: Merged revisions 120226 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120226 | tilghman | 2008-06-03 17:41:04 -0500 (Tue, 03 Jun 2008)
	  | 8 lines Due to incorrect use of the AST_LIST_INSERT_HEAD()
	  macro the loopback switch cannot perform any translation on the
	  extension number before searching for it in the target context.
	  (closes issue #12473) Reported by: chappell Patches:
	  pbx_loopback.c.diff uploaded by chappell (license 8) ........

2008-06-03 22:17 +0000 [r120174]  Jeff Peeler <jpeeler@digium.com>

	* /, main/config.c: Merged revisions 120173 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r120173 | jpeeler | 2008-06-03 17:15:33 -0500 (Tue, 03 Jun 2008)
	  | 6 lines (closes issue #11594) Reported by: yem Tested by: yem
	  This change decreases the buffer size allocated on the stack
	  substantially in config_text_file_load when LOW_MEMORY is turned
	  on. This change combined with the fix from revision 117462
	  (making mkintf not copy the zt_chan_conf structure) was enough to
	  prevent the crash. ........

2008-06-03 22:05 +0000 [r120171]  Tilghman Lesher <tlesher@digium.com>

	* Makefile, main/pbx.c, res/res_agi.c, pbx/pbx_realtime.c,
	  configs/pbx_realtime.conf (removed), include/asterisk/options.h,
	  main/asterisk.c: Move compatibility options into asterisk.conf,
	  default them to on for upgrades, and off for new installations.
	  This includes the translation from pipes to commas for
	  pbx_realtime and the EXEC command for AGI, as well as the change
	  to the Set application not to support multiple variables at once.

2008-06-03 21:35 +0000 [r120169]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 120168 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r120168 | russell | 2008-06-03 16:34:55 -0500 (Tue, 03
	  Jun 2008) | 4 lines Fix another place where peer->callno could
	  change at a very bad time, and also fix a place where a peer was
	  used after the reference was released. (inspired by rev 120001)
	  ........

2008-06-03 21:22 +0000 [r120166]  Mark Michelson <mmichelson@digium.com>

	* CHANGES, apps/app_queue.c: Adding two new queue log events. The
	  ADDMEMBER event is logged when a dynamic realtime queue member is
	  added to the queue, and the REMOVEMEMBER event is logged when a
	  dynamic realtime member is removed. Since no calling channel is
	  associated with these events the string "REALTIME" is placed
	  where the channel's unique id is normally placed. (closes issue
	  #12774) Reported by: atis Patches: queue_log_rt_members.patch
	  uploaded by atis (license 242)

2008-06-03 19:48 +0000 [r120064-120129]  Russell Bryant <russell@digium.com>

	* apps/app_channelredirect.c, apps/app_disa.c,
	  apps/app_chanisavail.c: Use proper return values for a few
	  application modules

	* include/asterisk/lock.h: fix build for non debug threads

	* main/channel.c, main/utils.c, include/asterisk/lock.h,
	  utils/ael_main.c, utils/conf2ael.c: Add lock tracking for
	  rwlocks. Previously, lock.h only had the ability to hold tracking
	  information for mutexes. Now, the "core show locks" output will
	  output information about who is holding a rwlock when a thread is
	  waiting on it. (closes issue #11279) Reported by: ys Patches:
	  trunk_lock_utils.v8.diff uploaded by ys (license 281)

2008-06-03 16:19 +0000 [r120012]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 120001 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r120001 | tilghman | 2008-06-03 11:10:53 -0500 (Tue, 03
	  Jun 2008) | 9 lines Save the callno when we're poking, because
	  our peer structure could change during destruction (and thus we
	  unlock the wrong callno, causing a cascade failure). (closes
	  issue #12717) Reported by: gewfie Patches:
	  20080525__bug12717.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: gewfie ........

2008-06-03 15:49 +0000 [r119930-119998]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-vtest17,
	  pbx/ael/ael-test/ref.ael-ntest10, pbx/ael/ael-test/ref.ael-test1,
	  pbx/ael/ael-test/ref.ael-test3, pbx/ael/ael-test/ref.ael-test5,
	  pbx/ael/ael-test/ref.ael-test15, pbx/ael/ael-test/ref.ael-test8,
	  pbx/ael/ael-test/ref.ael-test18,
	  pbx/ael/ael-test/ref.ael-vtest21,
	  pbx/ael/ael-test/ref.ael-vtest13: Merged revisions 119966 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119966 | murf | 2008-06-03 09:26:56 -0600 (Tue, 03 Jun 2008) | 8
	  lines Updated the regressions on AEL. Hadn't updated this for the
	  changes I made to preserve ${EXTEN} in switches, which affected
	  several tests because it adds extra priorities, and at least one
	  needed to be updated because of the removal of the empty
	  extension warning message. ........

	* res/ael/pval.c, /: Merged revisions 119929 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119929 | murf | 2008-06-03 08:49:46 -0600 (Tue, 03 Jun 2008) |
	  16 lines as per
	  http://lists.digium.com/pipermail/asterisk-users/2008-June/212934.html,
	  which is a message from Philipp Kempgen, requesting that the
	  WARNING that an extension is empty be reduced to a NOTICE or
	  less, as empty extensions are syntactically possible, and no big
	  deal. With which I agree, and have removed that WARNING message
	  entirely. I think it is not necessary to see this message. It
	  didn't state that a NoOp() was inserted automatically on your
	  behalf, and really, as users, who cares? Why freak out dialplan
	  writers with unnecessary warnings? The details of the
	  machinations a compiler goes thru to produce working assembly
	  code is of little interest to most programmers-- we will follow
	  the unix principal of doing our work silently. ........

2008-06-03 14:47 +0000 [r119927]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 119926 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119926 | file | 2008-06-03 11:46:24 -0300 (Tue, 03 Jun 2008) | 2
	  lines Treat ECONNREFUSED as an error that will stop further
	  retransmissions. (issue #AST-58, patch from Switchvox) ........

2008-06-03 13:29 +0000 [r119744-119892]  Russell Bryant <russell@digium.com>

	* main/logger.c: Do a deep copy of file and function strings to
	  avoid a potential crash when modules are unloaded. (closes issue
	  #12780) Reported by: ys Patches: logger.diff uploaded by ys
	  (license 281) -- modified by me for coding guidelines

	* /, channels/chan_iax2.c: Merged revisions 119838 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r119838 | russell | 2008-06-02 15:08:04 -0500 (Mon, 02
	  Jun 2008) | 7 lines Revert a change made for issue #12479. This
	  change caused a regression such that a dial string such as
	  (IAX2/foo) did not automatically fall back to dialing the 's'
	  extension anymore. (closes issue #12770) Reported by: dagmoller
	  ........

	* apps/app_fax.c (added): Add app_fax from asterisk-addons, with
	  some additional changes to resolve compiler warnings, as well as
	  update to the APIs in spandsp 0.0.5. Spandsp 0.0.5 is being
	  distributed under the LGPL, so we can move this module into the
	  main tree.

	* configure, include/asterisk/autoconfig.h.in, configure.ac: After
	  determining that the version of spandsp installed is an
	  acceptable version, do a build and link test to ensure that the
	  library is usable, and that libtiff is also available

	* build_tools/menuselect-deps.in, configure,
	  include/asterisk/autoconfig.h.in, configure.ac, makeopts.in: Add
	  a configure script check for spandsp

	* main/manager.c, /: Merged revisions 119742 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119742 | russell | 2008-06-02 09:39:45 -0500 (Mon, 02 Jun 2008)
	  | 5 lines Improve CLI command blacklist checking for the command
	  manager action. Previously, it did not handle case or whitespace
	  properly. This made it possible for blacklisted commands to get
	  executed anyway. (closes issue #12765) ........

2008-06-02 14:35 +0000 [r119741]  Philippe Sultan <philippe.sultan@gmail.com>

	* channels/chan_jingle.c, channels/chan_gtalk.c, res/res_jabber.c:
	  Do not link the guest account with any configured XMPP client (in
	  jabber.conf). The actual connection is made when a call comes in
	  Asterisk. Apply this fix to Jingle too. Fix the
	  ast_aji_get_client function that was not able to retrieve an XMPP
	  client from its JID. (closes issue #12085) Reported by: junky
	  Tested by: phsultan

2008-06-02 12:30 +0000 [r119688]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 119687 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r119687 | russell | 2008-06-02 07:30:17 -0500 (Mon, 02
	  Jun 2008) | 3 lines Even of the first PING or LAGRQ doesn't get
	  sent because it comes up too soon, make sure to reschedule so it
	  gets sent later. ........

2008-06-02 09:35 +0000 [r119586-119637]  Christian Richter <christian.richter@beronet.com>

	* /, channels/misdn/isdn_lib.c: Merged revisions 119636 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119636 | crichter | 2008-06-02 11:29:21 +0200 (Mo, 02 Jun 2008)
	  | 1 line fixed compile issue when dev-mode is enabled ........

	* channels/misdn/isdn_lib.h, /, channels/misdn/isdn_lib.c: Merged
	  revisions 119585 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119585 | crichter | 2008-06-02 10:35:28 +0200 (Mo, 02 Jun 2008)
	  | 1 line Added counter for unhandled_bmsg Print, this prevents
	  the logs to be flooded to fast and save CPU in this error
	  scenario. Added 'last_used' element to bc structure, when a
	  bchannel changes from used to free this exact time will be marked
	  in last_used. When a new channel is requested the find_free_chan
	  function will check if the new empty channel was used within the
	  last second, if yes it will search for the next channel, if no it
	  will return this channel. This simple mechanism has prooven to
	  prevent race conditions where the NT and TE tried to allocate the
	  exact same channel at the same time (RELEASE cause: 44). ........

2008-06-02 01:08 +0000 [r119531-119534]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 119533 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r119533 | russell | 2008-06-01 20:06:09 -0500 (Sun, 01
	  Jun 2008) | 2 lines Change a debug message to an actual debug
	  message ........

	* apps/app_dial.c, /: Merged revisions 119530 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119530 | russell | 2008-06-01 20:03:22 -0500 (Sun, 01 Jun 2008)
	  | 2 lines Fix another typo in documentation ........

2008-06-01 21:06 +0000 [r119479]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_dial.c, /: Merged revisions 119478 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119478 | mvanbaak | 2008-06-01 22:47:55 +0200 (Sun, 01 Jun 2008)
	  | 2 lines small typo fix 'retires' => 'retries' ........

2008-05-30 21:51 +0000 [r119423]  Russell Bryant <russell@digium.com>

	* main/utils.c: Fix a minor merge issue that caused a function to
	  not get compiled in with DEBUG_THREADS like it was supposed to

2008-05-30 21:23 +0000 [r119419]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_queue.c: Merged revisions 119404 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119404 | tilghman | 2008-05-30 16:17:45 -0500 (Fri, 30 May 2008)
	  | 6 lines When joinempty=strict, it only failed on join if there
	  were busy members. If all members were logged out OR paused, then
	  it (incorrectly) let callers join the queue. (closes issue
	  #12451) Reported by: davidw ........

2008-05-30 19:47 +0000 [r119355]  Joshua Colp <jcolp@digium.com>

	* main/autoservice.c, /: Merged revisions 119354 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119354 | file | 2008-05-30 16:46:37 -0300 (Fri, 30 May 2008) | 2
	  lines Fix a bug I found while testing for another issue. ........

2008-05-30 16:47 +0000 [r119302]  Michiel van Baak <michiel@vanbaak.info>

	* contrib/init.d/rc.debian.asterisk,
	  contrib/init.d/rc.mandrake.asterisk, /,
	  contrib/init.d/rc.redhat.asterisk,
	  contrib/init.d/rc.gentoo.asterisk,
	  contrib/init.d/rc.slackware.asterisk,
	  contrib/scripts/safe_asterisk, contrib/init.d/rc.suse.asterisk:
	  Merged revisions 119301 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119301 | mvanbaak | 2008-05-30 18:44:39 +0200 (Fri, 30 May 2008)
	  | 14 lines dont use a bashism way to check the $VERSION variable.
	  The rc/init.d scripts, and safe_asterisk work on normal sh now
	  again. Tested on: OpenBSD 4.2 (me) Debian etch (me) Ubuntu Hardy
	  (me and loloski) FC9 (loloski) (closes issue #12687) Reported by:
	  loloski Patches: 20080529-12687-safe_asterisk-fixversion.diff.txt
	  uploaded by mvanbaak (license 7) Tested by: loloski, mvanbaak
	  ........

2008-05-30 16:40 +0000 [r119296-119299]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_stack.c: Suppress warning about pbx structure already
	  existing

	* apps/app_dial.c, include/asterisk/agi.h, CHANGES,
	  apps/app_stack.c: Add native AGI command GOSUB, as invoking Gosub
	  with EXEC does not work properly. (closes issue #12760) Reported
	  by: Corydon76 Patches: 20080530__bug12760.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: tim_ringenbach, Corydon76

2008-05-30 12:59 +0000 [r119239]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 119238 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r119238 | russell | 2008-05-30 07:55:36 -0500
	  (Fri, 30 May 2008) | 15 lines Merged revisions 119237 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r119237 | russell | 2008-05-30 07:49:39 -0500 (Fri, 30 May 2008)
	  | 7 lines - Instead of only enforcing destination call number
	  checking on an ACK, check all full frames except for PING and
	  LAGRQ, which may be sent by older versions too quickly to contain
	  the destination call number. (As suggested by Tim Panton on the
	  asterisk-dev list) - Merge changes from
	  team/russell/iax2-frame-race, which prevents PING and LAGRQ from
	  being sent before the destination call number is known. ........
	  ................

2008-05-30 11:26 +0000 [r119207]  Olle Johansson <oej@edvina.net>

	* include/asterisk/frame.h: Prefer T140 with REDundance before T140
	  without.

2008-05-29 22:28 +0000 [r119157]  Russell Bryant <russell@digium.com>

	* main/autoservice.c, /: Merged revisions 119156 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119156 | russell | 2008-05-29 17:24:29 -0500 (Thu, 29 May 2008)
	  | 10 lines Fix a race condition in channel autoservice. There was
	  still a small window of opportunity for a DTMF frame, or some
	  other deferred frame type, to come in and get dropped. (closes
	  issue #12656) (closes issue #12656) Reported by: dimas Patches:
	  v3-12656.patch uploaded by dimas (license 88) -- with some
	  modifications by me ........

2008-05-29 21:30 +0000 [r119126]  Brett Bryant <bbryant@digium.com>

	* include/asterisk/logger.h, main/logger.c, main/asterisk.c: Adds
	  support for changing logger settingss on remote consoles with a
	  new command "logger set level". i.e. "logger set level debug off"
	  (closes issue #10891)

2008-05-29 20:26 +0000 [r119074]  Steve Murphy <murf@digium.com>

	* main/taskprocessor.c: Had to move the ASTERISK_FILE_VERSION decl
	  to just after the include of "asterisk.h" or you get undefined
	  variable errors when you are compiling under the influence of
	  MTX_PROFILE

2008-05-29 20:25 +0000 [r119072]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_zap.c, /: Merged revisions 119071 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r119071 | tilghman | 2008-05-29 15:24:11 -0500 (Thu, 29 May 2008)
	  | 7 lines Call waiting tone occurs too often, because it's
	  getting serviced by both subchannels. (closes issue #11354)
	  Reported by: cahen Patches: 20080512__bug11354.diff.txt uploaded
	  by Corydon76 (license 14) ........

2008-05-29 19:10 +0000 [r119015]  Michiel van Baak <michiel@vanbaak.info>

	* main/features.c: Make sure the nrfds and nefds are reset to NULL
	  before we enter manage_parkinglot. This will get rid of CLI
	  warnings like: __ast_read: Exception flag set on
	  'SIP/<NUMBER>-<ID>', but no exception handler (closes issue
	  #12748) Reported by: nreinartz Patches:
	  asterisk-multiparking_initialize_filedescr_sets-0.0.1.patch
	  uploaded by nreinartz (license 452)

2008-05-29 19:05 +0000 [r118959-119013]  Russell Bryant <russell@digium.com>

	* /, apps/app_milliwatt.c: Merged revisions 119012 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r119012 | russell | 2008-05-29 14:04:52 -0500 (Thu, 29
	  May 2008) | 4 lines - Fix a typo in the argument to Playtones -
	  use ast_safe_sleep() instead of calling the wait application
	  (thanks to tilghman for pointing these out!) ........

	* /, channels/chan_iax2.c: Merged revisions 119009 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r119009 | russell | 2008-05-29 13:49:12 -0500
	  (Thu, 29 May 2008) | 16 lines Merged revisions 119008 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r119008 | russell | 2008-05-29 13:45:21 -0500 (Thu, 29 May 2008)
	  | 7 lines Merge changes from
	  team/russell/iax2-another-fix-to-the-fix As described in the
	  following post to the asterisk-dev mailing list, only enforce
	  destination call numbers when processing an ACK.
	  http://lists.digium.com/pipermail/asterisk-dev/2008-May/033217.html
	  (closes issue #12631) ........ ................

	* /, apps/app_milliwatt.c: Merged revisions 118961 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r118961 | russell | 2008-05-29 12:51:29 -0500 (Thu, 29
	  May 2008) | 3 lines - Mark app_milliwatt dependent on
	  res_indications (thanks to jsmith) - fix a typo in a log message
	  (thanks to qwell) ........

	* /, apps/app_milliwatt.c: Merged revisions 118956 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r118956 | russell | 2008-05-29 12:38:38 -0500 (Thu, 29
	  May 2008) | 3 lines Change milliwatt to use the proper tone by
	  default (1004 Hz) instead of 1000 Hz. An option is there to use
	  1000 Hz for anyone that might want it. ........

2008-05-29 17:39 +0000 [r118955-118957]  Tilghman Lesher <tlesher@digium.com>

	* /, include/asterisk/lock.h: Merged revisions 118954 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r118954 | tilghman | 2008-05-29 12:33:01 -0500 (Thu, 29
	  May 2008) | 2 lines Define also when not DEBUG_THREADS ........

	* channels/chan_zap.c, /, channels/chan_agent.c,
	  channels/chan_alsa.c, main/utils.c, include/asterisk/lock.h,
	  channels/chan_iax2.c, channels/chan_mgcp.c: Merged revisions
	  118953 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118953 | tilghman | 2008-05-29 12:20:16 -0500 (Thu, 29 May 2008)
	  | 3 lines Add some debugging code that ensures that when we do
	  deadlock avoidance, we don't lose the information about how a
	  lock was originally acquired. ........

2008-05-29 12:12 +0000 [r118911]  Sean Bright <sean.bright@gmail.com>

	* utils/check_expr.c: Avoid build warning when execinfo.h isn't
	  available. (closes issue #12751) Reported by: ys Patches:
	  check_expr.diff uploaded by ys (license 281)

2008-05-29 01:29 +0000 [r118880]  Steve Murphy <murf@digium.com>

	* main/cdr.c, apps/app_forkcdr.c, /: Merged revisions 118858 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118858 | murf | 2008-05-28 18:25:28 -0600 (Wed, 28 May 2008) |
	  46 lines (closes issue #10668) (closes issue #11721) (closes
	  issue #12726) Reported by: arkadia Tested by: murf These changes:
	  1. revert the changes made via bug 10668; I should have known
	  that such changes, even tho they made sense at the time, seemed
	  like an omission, etc, were actually integral to the CDR system
	  via forkCDR. It makes sense to me now that forkCDR didn't
	  natively end any CDR's, but rather depended on natively closing
	  them all at hangup time via traversing and closing them all,
	  whether locked or not. I still don't completely understand the
	  benefits of setvar and answer operating on locked cdrs, but I've
	  seen enough to revert those changes also, and stop messing up
	  users who depended on that behavior. bug 12726 found reverting
	  the changes fixed his changes, and after a long review and
	  working on forkCDR, I can see why. 2. Apply the suggested
	  enhancements proposed in 10668, but in a completely compatible
	  way. ForkCDR will behave exactly as before, but now has new
	  options that will allow some actions to be taken that will
	  slightly modify the outcome and side-effects of forkCDR. Based on
	  conversations I've had with various people, these small tweaks
	  will allow some users to get the behavior they need. For
	  instance, users executing forkCDR in an AGI script will find the
	  answer time set, and DISPOSITION set, a situation not covered
	  when the routines were first written. 3. A small problem in the
	  cdr serializer would output answer and end times even when they
	  were not set. This is now fixed. ........

2008-05-28 22:05 +0000 [r118790-118824]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: formatting changes. A lot of whitespace
	  issues have been resolved in this commit Also some doc updates,
	  but that's only 6 lines

	* channels/chan_phone.c, channels/DialTone.h (removed),
	  channels/chan_phone.h (added): rename DialTone.h to chan_phone.h
	  because chan_phone.c is the only file using it

2008-05-28 19:56 +0000 [r118783]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Update to the janitor project for making sure
	  to be thread-safe when retrieving the value of a channel
	  variable. This covers app_queue. This commit also incorporates a
	  logical change. Previously, if MixMonitor is to be used to record
	  the call, all the arguments were parsed first. Then the
	  MixMonitor app would be located. Now the order of these
	  operations has been swapped. Now the app is located first so that
	  we only go through the work of parsing the arguments if the app
	  was found. (closes issue #12742) Reported by: snuffy Patches:
	  bug_12742.diff uploaded by snuffy (license 35)

2008-05-28 17:58 +0000 [r118750]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: remove unused astobj.h header file from
	  chan_skinny.c

2008-05-28 16:01 +0000 [r118702]  Brett Bryant <bbryant@digium.com>

	* channels/chan_iax2.c: Fixes a bug in chan_iax that uses
	  send_command to poke a peer while a channel is unlocked in some
	  cases, and because it can cause seemingly random failures could
	  be related to some bugs in the tracker...

2008-05-28 15:56 +0000 [r118695]  Russell Bryant <russell@digium.com>

	* utils/check_expr.c: Fix a linkage error related to the lock
	  backtrace support

2008-05-28 14:29 +0000 [r118647]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Merged
	  revisions 118646 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118646 | file | 2008-05-28 11:23:34 -0300 (Wed, 28 May 2008) | 4
	  lines Add an option to use the source IP address of RTP as the
	  destination IP address of UDPTL when a specific option is
	  enabled. If the remote side is properly configured (ports
	  forwarded) then UDPTL will flow. (closes issue #10417) Reported
	  by: cstadlmann ........

2008-05-28 14:10 +0000 [r118614-118644]  Philippe Sultan <philippe.sultan@gmail.com>

	* channels/chan_jingle.c, include/asterisk/jingle.h: Changed to
	  temporary namespaces to match with latest XEPs. As soon as Jingle
	  is completely standardized, we can set those namespaces to their
	  final values. Added two attributes to the jingle_pvt struct to
	  store the content name attributes. Reported by Robert McQueen on
	  Telepathy's framework mailing list :
	  http://lists.freedesktop.org/archives/telepathy/2008-May/001971.html
	  Keeping working on our Jingle stack!

	* channels/chan_jingle.c: Code simplification

2008-05-27 19:45 +0000 [r118562]  Brett Bryant <bbryant@digium.com>

	* channels/chan_iax2.c: Remove loop from the detection of a
	  sequence number that acknowledges the receiving of a packet that
	  we've kept in memory just incase the packet needs to be
	  retransmitted.

2008-05-27 19:34 +0000 [r118560]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 118558 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118558 | file | 2008-05-27 16:32:38 -0300 (Tue, 27 May 2008) | 4
	  lines Fix an issue where codec preferences were not set on
	  dialogs that were not authenticated via a user or peer and allow
	  framing to work without rtpmap in the SDP. (closes issue #12501)
	  Reported by: slimey ........

2008-05-27 19:27 +0000 [r118556]  Russell Bryant <russell@digium.com>

	* include/asterisk/compat.h: Add printf format attribute for
	  vasprintf(). (closes issue #12729) Reported by: snuffy Patches:
	  bug_12729.diff uploaded by snuffy (license 35)

2008-05-27 19:21 +0000 [r118554]  Tilghman Lesher <tlesher@digium.com>

	* /, main/cli.c: Merged revisions 118551 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118551 | tilghman | 2008-05-27 14:15:27 -0500 (Tue, 27 May 2008)
	  | 6 lines When showing an error message for a command, don't
	  shorten the command output, as it tends to confuse the user (it's
	  fine for suggesting other commands, however). Reported by:
	  seanbright (on #asterisk-dev) Fixed by: me ........

2008-05-27 19:08 +0000 [r118514]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 118509 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118509 | mmichelson | 2008-05-27 14:07:26 -0500 (Tue, 27 May
	  2008) | 11 lines Russell noted to me that in the case that
	  separate threads use their own addressing system, the fix I made
	  for issue 12376 does not guarantee uniqueness to the datastores'
	  uids. Though I know of no system that works this way, I am going
	  to change this right now to prevent trying to track down some
	  future bug that may occur and cause untold hours of debugging
	  time to track down. The change involves using a global counter
	  which increases with each new chanspy_ds which is created. This
	  guarantees uniqueness. ........

2008-05-27 18:59 +0000 [r118466]  Tilghman Lesher <tlesher@digium.com>

	* /, main/asterisk.c: Merged revisions 118465 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118465 | tilghman | 2008-05-27 13:58:09 -0500 (Tue, 27 May 2008)
	  | 8 lines NULL character should terminate only commands back to
	  the core, not log messages to the console. (closes issue #12731)
	  Reported by: seanbright Patches: 20080527__bug12731.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: seanbright ........

2008-05-27 17:33 +0000 [r118417-118419]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_voicemail.c: Zap is now DAHDI, mkay

	* apps/app_voicemail.c: small update to the g() option of
	  app_voicemail to note that gain changes only work on zap channels
	  right now. issue #12578 shows it's not clear right now.

2008-05-27 16:43 +0000 [r118371]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 118365 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118365 | mmichelson | 2008-05-27 11:38:38 -0500 (Tue, 27 May
	  2008) | 14 lines Add a unique id to the datastore allocated in
	  app_chanspy since it is possible that multiple spies may be
	  listening to the same channel. (closes issue #12376) Reported by:
	  DougUDI Patches: 12376_chanspy_uid.diff uploaded by putnopvut
	  (license 60) Tested by: destiny6628 (closes issue #12243)
	  Reported by: atis ........

2008-05-27 15:46 +0000 [r118359]  Tilghman Lesher <tlesher@digium.com>

	* /, configs/queues.conf.sample: Merged revisions 118358 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118358 | tilghman | 2008-05-27 10:45:37 -0500 (Tue, 27 May 2008)
	  | 3 lines Add a note that pbx_config.so is needed for Local
	  channels. (Closes issue #12671) ........

2008-05-27 14:51 +0000 [r118328]  Russell Bryant <russell@digium.com>

	* include/asterisk/compat.h: Add printf attribute to asprintf

2008-05-27 13:30 +0000 [r118300-118302]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_ldap.c: When binding anonymously, credentials are
	  still needed. (closes issue #12601) Reported by: suretec Patches:
	  res_config_ldap.c.patch uploaded by suretec (license 70)

	* pbx/pbx_realtime.c: In compat14 mode, don't translate pipes
	  inside expressions, as they aren't argument delimiters, but
	  rather 'or' symbols. (Closes issue #12723)

2008-05-25 16:17 +0000 [r118223-118252]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 118251 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118251 | tilghman | 2008-05-25 11:02:04 -0500 (Sun, 25 May 2008)
	  | 12 lines Realtime flag affects construction in multiple ways,
	  so consulting whether rtcachefriends was set was done too soon
	  (needed to be done inside build_peer, not just as a flag to
	  build_peer). Also, fullcontact needed to be reconstructed,
	  because realtime separates the embedded ';' into multiple fields.
	  (closes issue #12722) Reported by: barthpbx Patches:
	  20080525__bug12722.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: barthpbx (Much of the discussion happened on
	  #asterisk-dev for diagnosing this issue) ........

	* main/pbx.c, UPGRADE.txt: Change space-zero to now evaluate to
	  false, as is expected by a great many. (Inspired by a post on the
	  -users list)

2008-05-24 01:14 +0000 [r118176-118178]  Jeff Peeler <jpeeler@digium.com>

	* doc/api-1.6.0-changes.odt (added): add document describing API
	  changes from 1.4.0 to 1.6.0

	* main/features.c: Fixes segfault in parking, patch submitted by
	  bmd.

2008-05-23 22:41 +0000 [r118173-118175]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/lock.h: Make sure not to include non-existent
	  headers if they indeed are non-existent

	* include/asterisk/logger.h, utils/refcounter.c, main/logger.c,
	  utils/hashtest.c, main/utils.c, include/asterisk/lock.h,
	  utils/ael_main.c, utils/hashtest2.c, CHANGES, utils/conf2ael.c,
	  utils/check_expr.c: A new feature thanks to the fine folks at
	  Switchvox! If a deadlock is detected, then the typical lock
	  information will be printed along with a backtrace of the stack
	  for the offending threads. Use of this requires compiling with
	  DETECT_DEADLOCKS and having glibc installed. Furthermore, issuing
	  the "core show locks" CLI command will print the normal lock
	  information as well as a backtraces for each lock. This requires
	  that DEBUG_THREADS is enabled and that glibc is installed. All
	  the backtrace features may be disabled by running the configure
	  script with --without-execinfo as an argument

2008-05-23 21:26 +0000 [r118164]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_zap.c, /: Merged revisions 118163 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118163 | jpeeler | 2008-05-23 16:21:35 -0500 (Fri, 23 May 2008)
	  | 1 line Fix a few things I missed to ensure zt_chan_conf
	  structure is not modified in mkintf ........

2008-05-23 21:19 +0000 [r118161]  Brett Bryant <bbryant@digium.com>

	* main/manager.c, main/http.c, include/asterisk/manager.h: Add new
	  functionality to http server that requires manager authentication
	  for any path that includes a directory named 'private'. This
	  patch also requires manager authentication for any POST's being
	  sent to the server as well to help secure uploads.

2008-05-23 20:55 +0000 [r118157-118159]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Get rid of warnings for those silly
	  compilers which warn when freeing a const pointer

	* apps/app_voicemail.c: Use a deep copy on strings that come from
	  ast_events. Otherwise it is likely that after the event is freed,
	  we no longer refer to valid memory. (closes issue #12712)
	  Reported by: tomo1657 Patches: 12712.patch uploaded by putnopvut
	  (license 60) Tested by: tomo1657

2008-05-23 18:09 +0000 [r118129]  Tilghman Lesher <tlesher@digium.com>

	* res/res_odbc.c: Protect the object from changing while the 'odbc
	  show' CLI command is running (Closes issue #12704)

2008-05-23 17:12 +0000 [r118101]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_chanisavail.c, CHANGES: add option 'a' to chanisavail.
	  If you give chanisavail a list of channels, it will only return
	  the first available channel. When this option is set, it will
	  return all the available channels from the given list. (closes
	  issue #12248) Reported by: dagmoller Patches:
	  app_chanisavail-snv.patch-v2.txt uploaded by dagmoller (license
	  436) - major changes by me because russellb pointed out some
	  buffer overflows and codeguideline issues. Converted it all to
	  the ast_str_* api Tested by: dagmoller, mvanbaak

2008-05-23 13:00 +0000 [r118053]  Tilghman Lesher <tlesher@digium.com>

	* /, doc/cli.txt (added): Merged revisions 118052 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118052 | tilghman | 2008-05-23 07:59:16 -0500 (Fri, 23 May 2008)
	  | 3 lines Add information on using the Asterisk console,
	  including tab command line completion. (Closes issue #12681)
	  ........

2008-05-23 12:37 +0000 [r118049]  Russell Bryant <russell@digium.com>

	* include/asterisk/utils.h, /, main/utils.c: Merged revisions
	  118048 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r118048 | russell | 2008-05-23 07:30:53 -0500 (Fri, 23 May 2008)
	  | 9 lines Don't declare a function that takes variable arguments
	  as inline, because it's not valid, and on some compilers, will
	  emit a warning.
	  http://gcc.gnu.org/onlinedocs/gcc/Inline.html#Inline (closes
	  issue #12289) Reported by: francesco_r Patches by Tilghman, final
	  patch by me ........

2008-05-23 10:33 +0000 [r118020]  Philippe Sultan <philippe.sultan@gmail.com>

	* channels/chan_gtalk.c, res/res_jabber.c: - remove whitespaces
	  between tags in received XML packets before giving them to the
	  parser ; - report Gtalk error messages from a buddy to the
	  console. This patch makes Asterisk "Google Jingle" (chan_gtalk)
	  implementation work with Empathy. Note that this is only true for
	  audio streams, not video. Thank you to PH for his great help!
	  (closes issue #12647) Reported by: PH Patches: trunk-12647-1.diff
	  uploaded by phsultan (license 73) Tested by: phsultan, PH

2008-05-22 21:43 +0000 [r117988]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_usbradio.c: Split the compile flags out and wire up
	  some dependencies

2008-05-22 21:42 +0000 [r117983-117986]  Tilghman Lesher <tlesher@digium.com>

	* pbx/pbx_realtime.c, configs/pbx_realtime.conf (added): Add a
	  compatibility option for upgrading realtime extensions

	* channels/chan_vpb.cc: Fix trunk breakage

2008-05-22 20:01 +0000 [r117950]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_usbradio.c, apps/app_rpt.c: A couple more places
	  the frame data change was missed.

2008-05-22 18:54 +0000 [r117900]  Tilghman Lesher <tlesher@digium.com>

	* /, main/asterisk.c: Merged revisions 117899 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117899 | tilghman | 2008-05-22 13:53:53 -0500 (Thu, 22 May 2008)
	  | 2 lines Also remove preamble from asynchronous events (reported
	  by jsmith on #asterisk-dev) ........

2008-05-22 17:50 +0000 [r117834-117870]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_nbs.c: one more place I forgot

	* channels/chan_console.c: chan_console fixes because of
	  ast_frame.data => ast_frame.data.ptr

2008-05-22 17:10 +0000 [r117828]  Jason Parker <jparker@digium.com>

	* funcs/func_speex.c, codecs/codec_speex.c,
	  formats/format_ogg_vorbis.c, apps/app_jack.c: Fix a few places
	  where frame data was used directly.

2008-05-22 17:08 +0000 [r117802-117825]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_misdn.c: oops

	* channels/chan_misdn.c: forgot chan_misdn

	* main/udptl.c, channels/chan_local.c, main/frame.c,
	  codecs/codec_adpcm.c, apps/app_test.c, apps/app_alarmreceiver.c,
	  formats/format_sln16.c, formats/format_wav_gsm.c,
	  apps/app_ices.c, channels/chan_iax2.c, main/indications.c,
	  channels/chan_skinny.c, formats/format_pcm.c, apps/app_zapscan.c,
	  main/features.c, channels/chan_alsa.c, formats/format_h263.c,
	  apps/app_externalivr.c, formats/format_jpeg.c,
	  apps/app_milliwatt.c, formats/format_gsm.c, apps/app_dial.c,
	  codecs/codec_g722.c, formats/format_wav.c, codecs/codec_g726.c,
	  apps/app_disa.c, include/asterisk/channel.h,
	  channels/iax2-parser.c, apps/app_speech_utils.c,
	  channels/chan_misdn.c, apps/app_zapbarge.c, main/audiohook.c,
	  apps/app_chanspy.c, formats/format_g726.c,
	  channels/chan_unistim.c, apps/app_meetme.c, formats/format_sln.c,
	  codecs/codec_gsm.c, res/res_musiconhold.c, channels/chan_gtalk.c,
	  apps/app_followme.c, codecs/codec_zap.c, formats/format_ilbc.c,
	  main/channel.c, channels/chan_phone.c, res/res_agi.c,
	  apps/app_mp3.c, main/app.c, codecs/codec_resample.c,
	  formats/format_h264.c, include/asterisk/frame.h,
	  channels/chan_mgcp.c, codecs/codec_lpc10.c, apps/app_nbscat.c,
	  codecs/codec_a_mu.c, channels/chan_zap.c, channels/chan_sip.c,
	  apps/app_festival.c, codecs/codec_alaw.c, main/slinfactory.c,
	  main/translate.c, res/res_adsi.c, channels/chan_console.c,
	  apps/app_queue.c, channels/chan_oss.c, main/rtp.c,
	  channels/chan_jingle.c, formats/format_vox.c, main/abstract_jb.c,
	  channels/chan_h323.c, main/file.c, apps/app_sms.c,
	  formats/format_g723.c, codecs/codec_ulaw.c, main/dsp.c,
	  formats/format_g729.c: - revert change to ast_queue_hangup and
	  create ast_queue_hangup_with_cause - make data member of the
	  ast_frame struct a named union instead of a void Recently the
	  ast_queue_hangup function got a new parameter, the hangupcause
	  Feedback came in that this is no good and that instead a new
	  function should be created. This I did. The hangupcause was
	  stored in the seqno member of the ast_frame struct. This is not
	  very elegant, and since there's already a data member that one
	  should be used. Problem is, this member was a void *. Now it's a
	  named union so it can hold a pointer, an uint32 and there's a
	  padding in case someone wants to store another type in there in
	  the future. This commit is so massive, because all ast_frame.data
	  uses have to be altered to ast_frame.data.data Thanks russellb
	  and kpfleming for the feedback. (closes issue #12674) Reported
	  by: mvanbaak

2008-05-22 16:05 +0000 [r117794]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Committing a fix pointed out by Atis Lezdins on
	  the asterisk-dev list. Thanks!

2008-05-22 15:49 +0000 [r117792]  Sean Bright <sean.bright@gmail.com>

	* configs/jabber.conf.sample: Minor text fix. roster -> resource.

2008-05-22 13:40 +0000 [r117756]  Russell Bryant <russell@digium.com>

	* build_tools/make_buildopts_h, main/asterisk.c: Store build-time
	  options as a string in AST_BUILDOPTS in buildopts.h. Also,
	  display this information in the "core show settings" CLI command.
	  This is useful if you want to verify that you're running a build
	  with DONT_OPTIMIZE, DEBUG_THREADS, etc.

2008-05-22 05:10 +0000 [r117725]  Tilghman Lesher <tlesher@digium.com>

	* doc/externalivr.txt, apps/app_externalivr.c, CHANGES: Enhance
	  ExternalIVR with new options and commands. (closes issue #12705)
	  Reported by: ctooley Patches:
	  new_externalivr_argument_format-v2.diff uploaded by ctooley
	  (license 136) new_externalivr_documentation.diff uploaded by
	  ctooley (license 136) and a few additional fixes by me

2008-05-21 22:34 +0000 [r117693]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/logger.h, utils/refcounter.c, main/logger.c,
	  utils/hashtest.c, utils/ael_main.c, utils/hashtest2.c: This
	  change makes it so that logs will report the correct source of
	  verbose messages. Until this change, all verbose messages in
	  Asterisk's log files reported logger.c as the source of the
	  message.

2008-05-21 21:31 +0000 [r117628-117658]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_zap.c, /: Merged revisions 117582 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117582 | jpeeler | 2008-05-21 15:11:14 -0500 (Wed, 21 May 2008)
	  | 2 lines Ensure that passed in zt_chan_conf structure is not
	  modified in mkintf. ........

	* channels/chan_zap.c, /: Merged revisions 117462 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117462 | jpeeler | 2008-05-21 11:58:40 -0500 (Wed, 21 May 2008)
	  | 3 lines Pass a pointer for the conf parameter to the function
	  mkintf rather than the whole zt_chan_conf structure. Another
	  commit is following to make sure the zt_chan_conf structure is
	  not modified. ........

2008-05-21 20:27 +0000 [r117625]  Mark Michelson <mmichelson@digium.com>

	* doc/manager_1_1.txt, apps/app_queue.c: Add a new manager event,
	  AgentRingNoAnswer to app_queue. (closes issue #12591) Reported
	  by: CCHAsteria Patches: app_queue_RNA_event.diff uploaded by
	  CCHAsteria (license 477)

2008-05-21 19:39 +0000 [r117575]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 117574 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117574 | file | 2008-05-21 16:38:28 -0300 (Wed, 21 May 2008) | 2
	  lines Apply the autoframing setting to dialogs that do not get
	  matched against a user or peer. ........

2008-05-21 18:43 +0000 [r117520]  Tilghman Lesher <tlesher@digium.com>

	* /, main/asterisk.c: Merged revisions 117519 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117519 | tilghman | 2008-05-21 13:40:14 -0500 (Wed, 21 May 2008)
	  | 3 lines Strip the preamble from the output also when -rx is not
	  being used (Related to issue #12702) ........

2008-05-21 18:31 +0000 [r117517]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Optimize the update_realtime_member_field
	  function by not having to query the database for the member and
	  instead using a cached uniqueid. Special thanks to atis for
	  creating this and for keeping it up to date with necessary
	  changes (closes issue #11896) Reported by: atis Patches:
	  realtime_uniqueid_v6.patch uploaded by atis (license 242) Tested
	  by: atis

2008-05-21 18:29 +0000 [r117481-117515]  Russell Bryant <russell@digium.com>

	* /, main/asterisk.c: Merged revisions 117514 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117514 | russell | 2008-05-21 13:28:46 -0500 (Wed, 21 May 2008)
	  | 4 lines Don't filter the magic character in the network
	  verboser. It gets filtered once it reaches the client. (related
	  to issue #12702, pointed out by tilghman) ........

	* /, main/asterisk.c, pbx/pbx_gtkconsole.c: Merged revisions 117507
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117507 | russell | 2008-05-21 13:19:34 -0500 (Wed, 21 May 2008)
	  | 7 lines 1) Don't print the verbose marker in front of every
	  message from ast_verbose() being sent to remote consoles. 2) Fix
	  pbx_gtkconsole to filter out the verbose marker. (related to
	  issue #12702) ........

	* /, main/asterisk.c: Merged revisions 117479 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117479 | russell | 2008-05-21 13:11:51 -0500 (Wed, 21 May 2008)
	  | 6 lines Don't display the verbose marker for calls to
	  ast_verbose() that do not include a VERBOSE_PREFIX in front of
	  the message. (closes issue #12702) Reported by: johnlange Patched
	  by me ........

2008-05-21 13:39 +0000 [r117431]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_externalivr.c: On socket-based connections, there is no
	  error FD, so don't try waiting on one. (closes issue #12697)
	  Reported by: ctooley Patches:
	  fix_externalivr_waitfor_nandfds-v3.diff uploaded by ctooley
	  (license 136)

2008-05-21 11:24 +0000 [r117401]  Luigi Rizzo <rizzo@icir.org>

	* channels/console_gui.c: do not die on SDL_ACTIVEEVENT reporting
	  lost focus.

2008-05-21 02:20 +0000 [r117367]  Mark Michelson <mmichelson@digium.com>

	* main/config.c: Be sure that we cache included files for each
	  source file which loads a configuration file. As it was, only the
	  first did so. This led to a problem if the included file was
	  changed (but not the configuration file which includes it) and
	  the second source file attempted to reload the configuration. It
	  would not see that the included file had changed. In this
	  particular example, res_phoneprov and chan_sip both loaded
	  sip.conf, which included a file call sip.peers.conf. Since
	  res_phoneprov was the first to load sip.conf, only it cached the
	  fact that sip.conf included sip.peers.conf. If sip.peers.conf
	  were changed and sip.conf were not and a sip reload were issued
	  (meaning that chan_sip attempts to reload sip.conf only if it and
	  its included files have changed) the changes made to
	  sip.peers.conf would not be seen and therefore no action would be
	  taken. (closes issue #12693) Reported by: marsosa

2008-05-21 01:00 +0000 [r117335]  Steve Murphy <murf@digium.com>

	* utils/ael_main.c: These changes were made via the comments
	  atis_work made at 4:30am (Mountain Time zone- US) in
	  #asterisk-dev on 20 May 2008. He noted that a backslash was being
	  inserted before commas in app call arguments in the
	  extensions.conf.aeldump file that you get from aelparse with the
	  -w arg. This was being generated from code left over from 1.4,
	  where commas were substituted with '|', and any remaining commas
	  needed to be escaped. Many thanks to atis for his comment; please
	  let us know if these changes break anything!

2008-05-20 18:07 +0000 [r117266-117297]  Luigi Rizzo <rizzo@icir.org>

	* main/manager.c: + Implement a variant of astman_get_header() to
	  return the first or last match, and possibly skip empty fields.
	  The function is useful (and used here) when a form submits
	  multiple 'Action' fields to the Manager. This change slightly
	  modifies the current behaviour, but only in the case the user
	  supplies multiple 'Action: ' lines and the first ones are empty,
	  so the change is totally harmless. + Fix style on a couple of "if
	  (displayconnects)" statements; + Expand a bit the 'Manager Test'
	  interface, to make it slightly more user friendly. But also
	  comment that the HTML should not be embedded in the C source.
	  None of this stuff needs to be applied to 1.4.

	* main/http.c: Document the possible presence of multiple variables
	  with the same name in http queries, which might confuse the
	  manager. Replace calls to ast_uri_decode() with a local function
	  that also replaces '+' with ' ', as this is the normal encoding
	  for spaces in http requests. This allows passing cli commands to
	  the manager through the http interface.

	* main/http.c: Reverse the check for Cookie: and remove leftover
	  code implementing the same thing. Add an ast_debug() call to help
	  debugging the url matching.

2008-05-20 16:25 +0000 [r117262-117264]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES, res/res_odbc.c: Increase limit of unshared connections
	  from 1023 to 4.2 billion. (Related to issue #12677)

	* res/res_odbc.c: Revert part of previous fix, and heavily comment
	  the logic for object destruction, for future users. (Closes issue
	  #12677)

2008-05-19 20:45 +0000 [r117212]  Russell Bryant <russell@digium.com>

	* main/channel.c: Minor formatting change to test a mantis change
	  ... (issue #12674)

2008-05-19 20:06 +0000 [r117182]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_zap.c, CHANGES, configs/zapata.conf.sample: Change
	  the default for the pridialplan parameter to the far more common
	  case of 'unknown', and better document the use of each parameter.
	  (closes issue #12633) Reported by: tzafrir Patches:
	  pridialplan_unknown_2.diff uploaded by tzafrir (license 46)

2008-05-19 16:53 +0000 [r117133-117136]  Joshua Colp <jcolp@digium.com>

	* res/res_smdi.c, /: Merged revisions 117135 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117135 | file | 2008-05-19 13:50:52 -0300 (Mon, 19 May 2008) | 6
	  lines Use the right pthread lock and condition when waiting.
	  (closes issue #12664) Reported by: tomo1657 Patches:
	  res_smdi.c.patch uploaded by tomo1657 (license 484) ........

	* res/res_odbc.c: Remove a premature mutex destroy (the destruction
	  callback will end up destroying it) and use a callback to purge
	  remaining classes. (closes issue #12677) Reported by: falves11

2008-05-19 16:07 +0000 [r117088]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/utils.h, /: Merged revisions 117086 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r117086 | tilghman | 2008-05-19 11:05:05 -0500 (Mon, 19
	  May 2008) | 2 lines The addition of usleep(2) within ast_assert
	  requires the inclusion of the unistd.h header ........

2008-05-19 16:03 +0000 [r117085]  Joshua Colp <jcolp@digium.com>

	* main/logger.c: The logger closes the files it is logging to when
	  reloading so we have to read in the logger configuration even if
	  it has not changed so that the logs get opened again. (closes
	  issue #12665) Reported by: DennisD

2008-05-19 15:47 +0000 [r117084]  Luigi Rizzo <rizzo@icir.org>

	* channels/console_gui.c: trap potential failures of SDL when
	  SDL_WINDOWID is pointing to a random window. This commit is
	  essentially a workaround for some undesirable behaviour of SDL;
	  we should not be doing this in the application, but in the
	  library.

2008-05-19 15:24 +0000 [r117082]  Joshua Colp <jcolp@digium.com>

	* /, channels/h323/ast_h323.cxx: Merged revisions 117081 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r117081 | file | 2008-05-19 12:22:10 -0300 (Mon, 19 May 2008) | 6
	  lines Make chan_h323 work with pwlib 1.12.0 (closes issue #12682)
	  Reported by: bamby Patches: pwlib_nopipe.diff uploaded by bamby
	  (license 430) ........

2008-05-19 14:54 +0000 [r117024-117053]  Luigi Rizzo <rizzo@icir.org>

	* configs/oss.conf.sample: fix example configuration for video
	  support in chan_oss

	* channels/console_gui.c: Some fixes to the code to support running
	  on an externally supplied window. SDL (at least recent 1.2.x
	  versions) has the ability to run the graphic output into an
	  externally supplied window, whose ID in the environment variable
	  SDL_WINDOWID. Ideally, applications should run unchanged
	  irrespective of who creates the window. Unfortunately, SDL does
	  not subscribe to mouse, key and resize events on externally
	  supplied windows, so we need to do ask for these events
	  explicitly. On passing, also add some code to handle
	  SDL_ACTIVEEVENT so if the X11 window is killed while we are
	  active, we call "stop now" to terminate the asterisk instance.

	* channels/console_video.c: Allow users to specify 'startgui=1' in
	  oss.conf so that the graphic screen for the video console is
	  activated at startup.

2008-05-19 03:44 +0000 [r116979]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 116978 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r116978 | russell | 2008-05-18 22:44:04 -0500 (Sun, 18
	  May 2008) | 4 lines Avoid access of uninitialized memory. This
	  caused a bunch of crashes for me while doing load testing of
	  development branch where I'm working on some performance
	  improvements. ........

2008-05-18 21:15 +0000 [r116948]  Tilghman Lesher <tlesher@digium.com>

	* utils/astcanary.c: Add a set of text to the file astcanary uses
	  to communicate back the main Asterisk process, which explains the
	  purpose for the file being there. This should assist people who
	  find the file and wonder why it exists.

2008-05-18 19:58 +0000 [r116919]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Remove duplicate colon on Reason header
	  (closes issue #12678)

2008-05-17 19:39 +0000 [r116800-116884]  Joshua Colp <jcolp@digium.com>

	* channels/iax2-parser.h, channels/chan_iax2.c: Improve native
	  transfers when a chain of IAX2 connections are in use. (closes
	  issue #7567) Reported by: tjd Patches: bug_7567_update_v2.diff
	  uploaded by snuffy (license 35)

	* channels/chan_sip.c: Try to fix attended transfers.

	* /, channels/chan_skinny.c: Merged revisions 116799 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r116799 | file | 2008-05-16 17:28:11 -0300 (Fri, 16 May
	  2008) | 4 lines Check to make sure an RTP structure exists before
	  calling ast_rtp_new_source on it. (closes issue #12669) Reported
	  by: sbisker ........

2008-05-16 20:00 +0000 [r116797]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Try to see if we can make our ringback
	  situation a little better

2008-05-16 17:08 +0000 [r116765]  Sean Bright <sean.bright@gmail.com>

	* channels/xpmr/xpmr.c: Compile under dev-mode, please.

2008-05-16 00:51 +0000 [r116731]  Jim Dixon <telesistant@hotmail.com>

	* channels/chan_usbradio.c, channels/xpmr/xpmr.h,
	  channels/xpmr/sinetabx.h, channels/Makefile,
	  channels/xpmr/xpmr.c, apps/app_rpt.c, channels/xpmr/xpmr_coef.h:
	  Bring all app_rpt and chan_usbradio stuff up to date

2008-05-15 22:05 +0000 [r116694]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/utils.h, include/asterisk/strings.h: Add an
	  extra check in ast_strlen_zero, and make ast_assert() not print
	  the file, line, and function name twice. (Closes issue #12650)

2008-05-15 21:54 +0000 [r116663]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_sip.c: Fixes a problem I was having with two SIP
	  phones using Packet2Packet bridging dropping audio nearly
	  immediately. The problem was that the lock on the SIP dialog was
	  not being unlocked while the bridge was still active. (Related to
	  issue #12566)

2008-05-15 17:58 +0000 [r116631]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_csv.c: Don't unload config on reload, when config has not
	  changed. (Closes issue #12652)

2008-05-15 15:40 +0000 [r116590-116594]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: When counting urgent messages when using
	  IMAP storage, take into account that the urgent messages are not
	  in their own folder but are actually "flagged" messages in the
	  INBOX. (closes issue #12659) Reported by: jaroth Patches:
	  urgentfolder_v2.patch uploaded by jaroth (license 50) Tested by:
	  jaroth

	* UPGRADE.txt, apps/app_voicemail.c: Modify externnotify to take
	  the number of urgent voicemails as a final argument instead of
	  the string "Urgent" (closes issue #12660) Reported by: jaroth
	  Patches: externnotify.patch uploaded by jaroth (license 50)

	* apps/app_voicemail.c: Prevent crashes from occurring due to a
	  strcmp of a NULL pointer. (closes issue #12661) Reported by:
	  jaroth Patches: urgentcompare.patch uploaded by jaroth (license
	  50)

2008-05-15 10:56 +0000 [r116557]  Luigi Rizzo <rizzo@icir.org>

	* main/manager.c, funcs/func_timeout.c, main/features.c,
	  apps/app_waituntil.c, main/utils.c, main/taskprocessor.c,
	  main/sched.c: Use casts or intermediate variables to remove a
	  number of platform/compiler-dependent warnings when handing
	  struct timeval fields, both reading and printing them. It is a
	  lost battle to handle the different ways struct timeval is
	  handled on the various platforms and compilers, so try to be
	  pragmatic and go through int/long which are universally
	  supported.

2008-05-14 22:15 +0000 [r116522]  Mark Michelson <mmichelson@digium.com>

	* CHANGES, apps/app_chanspy.c: Adding a new option to Chanspy().
	  The 'd' option allows for the spy to press DTMF digits to switch
	  between spying modes. Pressing 4 activates spy mode, pressing 5
	  activates whisper mode, and pressing 6 activates barge mode. Use
	  of this feature overrides the normal operation of DTMF numbers.
	  This feature is courtesy of Switchvox.

2008-05-14 21:54 +0000 [r116471]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Fix pedanticness.

2008-05-14 21:40 +0000 [r116469]  Russell Bryant <russell@digium.com>

	* main/channel.c, main/udptl.c, include/asterisk/utils.h, /,
	  channels/chan_agent.c, main/abstract_jb.c,
	  include/asterisk/channel.h, main/rtp.c, main/sched.c: Merged
	  revisions 116463 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r116463 | russell | 2008-05-14 16:32:00 -0500 (Wed, 14 May 2008)
	  | 4 lines Add ast_assert(), which can be used to handle fatal
	  errors. It is only compiled in if dev-mode is enabled, and only
	  aborts if DO_CRASH is defined. (inspired by issue #12650)
	  ........

2008-05-14 21:39 +0000 [r116467]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_agi.c: Merged revisions 116466 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r116466 | tilghman | 2008-05-14 16:38:09 -0500 (Wed, 14 May 2008)
	  | 7 lines Avoid zombies when the channel exits before the AGI.
	  (closes issue #12648) Reported by: gkloepfer Patches:
	  20080514__bug12648.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: gkloepfer ........

2008-05-14 21:11 +0000 [r116461]  Joshua Colp <jcolp@digium.com>

	* main/pbx.c: Add a missing context unlock. (closes issue #12649)
	  Reported by: ys Patches: pbx.c.diff uploaded by ys (license 281)

2008-05-14 20:43 +0000 [r116407-116410]  Jason Parker <jparker@digium.com>

	* /, configs/voicemail.conf.sample: Merged revisions 116409 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r116409 | qwell | 2008-05-14 15:43:08 -0500 (Wed, 14 May 2008) |
	  1 line Document exitcontext in app_voicemail sample config
	  ........

	* apps/app_voicemail.c: Voicemail "* exit" should not require an
	  exitcontext to be specified. The behavior in 1.4 was that it
	  would use the current context if an exitcontext existed. (closes
	  issue #12605) Reported by: kenjreno Patches: 12605-starexit.diff
	  uploaded by qwell (license 4) Tested by: file

2008-05-14 18:54 +0000 [r116350-116353]  Joshua Colp <jcolp@digium.com>

	* /, main/Makefile: Merged revisions 116352 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r116352 | file | 2008-05-14 15:53:39 -0300 (Wed, 14 May 2008) | 4
	  lines Add linux-gnueabi in. (closes issue #12529) Reported by:
	  tzafrir ........

	* res/res_config_ldap.c: Make the ldap version setting work without
	  having both version and protocol set. (closes issue #12613)
	  Reported by: suretec

2008-05-14 16:53 +0000 [r116298]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_externalivr.c: Merged revisions 116296 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r116296 | tilghman | 2008-05-14 11:46:48 -0500 (Wed, 14
	  May 2008) | 2 lines Detect another way for a connection to have
	  gone away. (closes issue #12618) Reported by: ctooley Patches:
	  1.4-externalivr-test_fd.diff uploaded by ctooley (license 136)
	  trunk-externalivr-test_fd.diff uploaded by ctooley (license 136)
	  ........

2008-05-14 16:52 +0000 [r116297]  Jeff Peeler <jpeeler@digium.com>

	* main/pbx.c, main/features.c: Fixed a few problems with
	  multiparking: call not being parked in the correct parking spot,
	  caller not being notified of parking spot position, and
	  improperly hanging up the call during a transfer due to timing
	  out (not providing the extension in which to transfer).

2008-05-14 14:16 +0000 [r116179-116240]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Don't add linefeed on received MESSAGE

	* channels/chan_sip.c: Properly declare charset for text messages.

	* CREDITS, main/frame.c, channels/chan_sip.c,
	  include/asterisk/rtp.h, CHANGES, include/asterisk/frame.h,
	  main/rtp.c: Adding spport for T.140 RED - Simple RTP redundancy
	  to prevent packet loss in text stream Work sponsored by Omnitor
	  AB, Stockholm, Sweden (http://www.omnitor.se)

	* /, channels/chan_sip.c: Merged revisions 116230 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r116230 | oej | 2008-05-14 14:51:06 +0200 (Ons, 14 Maj 2008) | 3
	  lines Accept text messages even with Content-Type:
	  text/plain;charset=Södermanländska ........

	* main/manager.c, pbx/pbx_spool.c, channels/chan_sip.c, CHANGES,
	  sample.call: Add support for codec settings in originate via call
	  file and manager. This is to enable video and text in originated
	  calls. Development sponsored by Omnitor AB, Sweden.
	  (http://www.omnitor.se)

	* res/res_agi.c: Formatting changes (coding guidelines) while
	  thinking about something else...

	* channels/chan_sip.c: Reformatting

	* channels/chan_sip.c: Adding comments

	* pbx/pbx_spool.c: Doxygen formatting change only

2008-05-14 00:20 +0000 [r116089-116138]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_skinny.c: Undo inadvertent changes to chan_skinny
	  caused by the merging of urgent messaging support. Thanks to
	  Damien Wedhorn for pointing out the problem.

	* main/channel.c, /, include/asterisk/lock.h: Merged revisions
	  116088 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r116088 | mmichelson | 2008-05-13 18:47:49 -0500 (Tue, 13 May
	  2008) | 12 lines A change to the way channel locks are handled
	  when DEBUG_CHANNEL_LOCKS is defined. After debugging a deadlock,
	  it was noticed that when DEBUG_CHANNEL_LOCKS is enabled in
	  menuselect, the actual origin of channel locks is obscured by the
	  fact that all channel locks appear to happen in the function
	  ast_channel_lock(). This code change redefines ast_channel_lock
	  to be a macro which maps to __ast_channel_lock(), which then
	  relays the proper file name, line number, and function name
	  information to the core lock functions so that this information
	  will be displayed in the case that there is some sort of locking
	  error or core show locks is issued. ........

2008-05-13 21:18 +0000 [r116001-116039]  Russell Bryant <russell@digium.com>

	* channels/chan_local.c, /: Merged revisions 116038 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r116038 | russell | 2008-05-13 16:17:23 -0500 (Tue, 13
	  May 2008) | 24 lines Fix a deadlock involving channel autoservice
	  and chan_local that was debugged and fixed by mmichelson and me.
	  We observed a system that had a bunch of threads stuck in
	  ast_autoservice_stop(). The reason these threads were waiting
	  around is because this function waits to ensure that the channel
	  list in the autoservice thread gets rebuilt before the stop()
	  function returns. However, the autoservice thread was also
	  locked, so the autoservice channel list was never getting
	  rebuilt. The autoservice thread was stuck waiting for the channel
	  lock on a local channel. However, the local channel was locked by
	  a thread that was stuck in the autoservice stop function. It
	  turned out that the issue came down to the local_queue_frame()
	  function in chan_local. This function assumed that one of the
	  channels passed in as an argument was locked when called.
	  However, that was not always the case. There were multiple cases
	  in which this channel was not locked when the function was
	  called. We fixed up chan_local to indicate to this function
	  whether this channel was locked or not. The previous assumption
	  had caused local_queue_frame() to improperly return with the
	  channel locked, where it would then never get unlocked. (closes
	  issue #12584) (related to issue #12603) ........

	* main/autoservice.c, /: Merged revisions 115990 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115990 | russell | 2008-05-13 16:05:57 -0500 (Tue, 13 May 2008)
	  | 5 lines Fix an issue that I noticed in autoservice while
	  mmichelson and I were debugging a different problem. I noticed
	  that it was theoretically possible for two threads to attempt to
	  start the autoservice thread at the same time. This change makes
	  the process of starting the autoservice thread, thread-safe.
	  ........

2008-05-13 20:29 +0000 [r115945]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_alsa.c: Merged revisions 115944 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r115944 | file | 2008-05-13 17:28:23 -0300 (Tue, 13 May
	  2008) | 4 lines Use the right flag to open the audio in
	  non-blocking. (closes issue #12616) Reported by:
	  nicklewisdigiumuser ........

2008-05-13 20:18 +0000 [r115939-115941]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Need to clear calling_party_cat variable
	  after we retrieve it

	* channels/chan_zap.c: Add support for receiving calling party
	  category

2008-05-13 18:38 +0000 [r115886]  Tilghman Lesher <tlesher@digium.com>

	* /, main/asterisk.c: Merged revisions 115884 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115884 | tilghman | 2008-05-13 13:36:13 -0500 (Tue, 13 May 2008)
	  | 3 lines If the socket dies (read returns 0=EOF), return
	  immediately. (Closes issue #12637) ........

2008-05-13 17:42 +0000 [r115847-115850]  Russell Bryant <russell@digium.com>

	* funcs/func_speex.c, apps/app_skel.c, apps/app_jack.c:
	  Re-introduce proper error handling that was removed in recent
	  commits.

	* res/res_smdi.c: Initialize the start time in smdi_msg_wait.
	  Somehow this code got lost in trunk.

2008-05-12 20:34 +0000 [r115813]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/install_prereq (added): Add a script which
	  installs every package needed for a Debian install of Asterisk,
	  and includes possible support (to be contributed) for various
	  other distributions. (closes issue #10523) Reported by: tzafrir
	  Patches: install_prereq_2 uploaded by tzafrir (license 46)

2008-05-12 18:39 +0000 [r115784]  Olle Johansson <oej@edvina.net>

	* main/features.c, doc/tex/channelvariables.tex: Add support for
	  playing an audio file for caller and callee at start and stop of
	  monitoring (one-touch monitor). Keep messages short, since the
	  other party is waiting while one party hear the message...

2008-05-12 17:55 +0000 [r115737]  Mark Michelson <mmichelson@digium.com>

	* main/utils.c: Merged revisions 115735 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115735 | mmichelson | 2008-05-12 12:51:14 -0500 (Mon, 12 May
	  2008) | 7 lines If a thread holds no locks, do not print any
	  information on the thread when issuing a core show locks command.
	  This will help to de-clutter output somewhat. Russell said it
	  would be fine to place this improvement in the 1.4 branch, so
	  that's why it's going here too. ........

2008-05-12 16:35 +0000 [r115705]  Jason Parker <jparker@digium.com>

	* apps/app_queue.c: Correctly document state interface for
	  AddQueueMember. Discovered while looking at issue #12626.

2008-05-12 15:17 +0000 [r115669]  Brett Bryant <bbryant@digium.com>

	* channels/chan_iax2.c: A small change to fix iax2 native bridging.

2008-05-11 03:23 +0000 [r115598-115600]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c, configure, include/asterisk/autoconfig.h.in,
	  configure.ac: Add Zap MTP2 support to chan_zap

	* channels/chan_zap.c: Open up audio channel when we get ACM on SS7
	  event

2008-05-10 14:19 +0000 [r115596]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_pgsql.c: Ensure that "calldate" is acceptable for a
	  column name.

2008-05-10 03:30 +0000 [r115593-115595]  Claude Patry <cpatry@gmail.com>

	* configs/queues.conf.sample: fix a sample since we now required ,
	  and not | for the arguments separator

	* apps/app_skel.c, apps/app_jack.c: ameliorate load and unload to
	  dont use DECLINED or FAILED, when theres no .conf involved.

	* funcs/func_speex.c: since we unregister, that has not been
	  properly registered, i standardized this.

2008-05-09 22:36 +0000 [r115588-115591]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Remove a debug line

	* channels/chan_unistim.c, include/asterisk/app.h, main/manager.c,
	  channels/chan_sip.c, channels/chan_skinny.c, UPGRADE.txt,
	  main/app.c, CHANGES, channels/chan_iax2.c, apps/app_voicemail.c:
	  Adding support for "urgent" voicemail messages. Messages which
	  are marked "urgent" are considered to be higher priority than
	  other messages and so they will be played before any other
	  messages in a user's mailbox. There are two ways to leave an
	  urgent message. 1. send the 'U' option to VoiceMail(). 2. Set
	  review=yes in voicemail.conf. This will give instructions for a
	  caller to mark a message as urgent after the message has been
	  recorded. I have tested that this works correctly with file and
	  ODBC storage, and James Rothenberger (who wrote initial support
	  for this feature) has tested its use with IMAP storage. (closes
	  issue #11817) Reported by: jaroth Based on branch
	  http://svn.digium.com/svn/asterisk/team/jrothenberger/asterisk-urgent
	  Tested by: putnopvut, jaroth

2008-05-09 20:05 +0000 [r115584-115586]  Brett Bryant <bbryant@digium.com>

	* CHANGES: Update CHANGES file for previous commit of ENUM and
	  TXCIDNAME changes.

	* funcs/func_enum.c, include/asterisk/enum.h, main/enum.c: The
	  following patch adds new options and alters the default behavior
	  of the ENUM* functions. The TXCIDNAME lookup function has also
	  gotten a new paramater. The new options for ENUM* functions
	  include 'u', 's', 'i', and 'd' which return the full uri, trigger
	  isn specific rewriting, look for branches into an infrastructure
	  enum tree, or do a direct dns lookup of a number respectively.
	  The new paramater for TXCIDNAME adds a zone-suffix argument for
	  looking up caller id's in DNS that aren't e164.arpa. This patch
	  is based on the original code from otmar, modified by snuffy, and
	  tested by jtodd, me, and others. (closes issue #8089) Reported
	  by: otmar Patches: 20080508_bug8089-1.diff - original code by
	  otmar (license 480), - revised by snuffy (license 35) Tested by:
	  oej, otmar, jtodd, Corydon76, snuffy, alexnikolov, bbryant

2008-05-09 17:28 +0000 [r115582]  Tilghman Lesher <tlesher@digium.com>

	* configs/voicemail.conf.sample, CHANGES, apps/app_voicemail.c:
	  Allow a password change to be validated by an external script.
	  (closes issue #12090) Reported by: jaroth Patches:
	  vm-check-newpassword.diff.txt uploaded by mvanbaak (license 7)
	  20080509__bug12090.diff.txt uploaded by Corydon76 (license 14)

2008-05-09 16:36 +0000 [r115580]  Joshua Colp <jcolp@digium.com>

	* /, configure, include/asterisk/autoconfig.h.in, configure.ac:
	  Merged revisions 115579 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115579 | file | 2008-05-09 13:34:08 -0300 (Fri, 09 May 2008) | 2
	  lines Improve res_ninit and res_ndestroy autoconf logic on the
	  Darwin platform. ........

2008-05-08 19:20 +0000 [r115552-115569]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 115568 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r115568 | russell | 2008-05-08 14:19:50 -0500 (Thu, 08
	  May 2008) | 2 lines Remove debug output. ........

	* /, channels/chan_iax2.c: Merged revisions 115565 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r115565 | russell | 2008-05-08 14:15:25 -0500
	  (Thu, 08 May 2008) | 33 lines Merged revisions 115564 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r115564 | russell | 2008-05-08 14:14:04 -0500 (Thu, 08 May 2008)
	  | 25 lines Fix a race condition that bbryant just found while
	  doing some IAX2 testing. He was running Asterisk trunk running
	  IAX2 calls through a few Asterisk boxes, however, the audio was
	  extremely choppy. We looked at a packet trace and saw a storm of
	  INVAL and VNAK frames being sent from one box to another. It
	  turned out that what had happened was that one box tried to send
	  a CONTROL frame before the 3 way handshake had completed. So,
	  that frame did not include the destination call number, because
	  it didn't have it yet. Part of our recent work for security
	  issues included an additional check to ensure that frames that
	  are supposed to include the destination call number have the
	  correct one. This caused the frame to be rejected with an INVAL.
	  The frame would get retransmitted for forever, rejected every
	  time ... This race condition exists in all versions that got the
	  security changes, in theory. However, it is really only likely
	  that this would cause a problem in Asterisk trunk. There was a
	  control frame being sent (SRCUPDATE) at the _very_ beginning of
	  the call, which does not exist in 1.2 or 1.4. However, I am
	  fixing all versions that could potentially be affected by the
	  introduced race condition. These changes are what bbryant and I
	  came up with to fix the issue. Instead of simply dropping control
	  frames that get sent before the handshake is complete, the code
	  attempts to wait a little while, since in most cases, the
	  handshake will complete very quickly. If it doesn't complete
	  after yielding for a little while, then the frame gets dropped.
	  ........ ................

	* /, channels/chan_sip.c: Merged revisions 115561 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115561 | russell | 2008-05-08 11:11:33 -0500 (Thu, 08 May 2008)
	  | 3 lines Don't give up on attempting an outbound registration if
	  we receive a 408 Timeout. (closes issue #12323) ........

	* /, contrib/scripts/postgres_cdr.sql (removed): Merged revisions
	  115557 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115557 | russell | 2008-05-08 10:37:49 -0500 (Thu, 08 May 2008)
	  | 3 lines remove postgres_cdr.sql, as the CDR schema is in
	  realtime_pgsql.sql, as well (closes issue #9676) ........

	* contrib/init.d/rc.debian.asterisk, /: Merged revisions 115554 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115554 | russell | 2008-05-08 10:32:08 -0500 (Thu, 08 May 2008)
	  | 3 lines Don't exit the script if Asterisk is not running.
	  (closes issue #12611) ........

	* main/pbx.c, /: Merged revisions 115551 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115551 | russell | 2008-05-08 10:24:54 -0500 (Thu, 08 May 2008)
	  | 4 lines Don't use a channel before checking for channel
	  allocation failure. (closes issue #12609) Reported by: edantie
	  ........

2008-05-08 15:04 +0000 [r115548]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Remove unused code as well as demote an
	  error message to a debug message

2008-05-08 14:41 +0000 [r115537-115546]  Russell Bryant <russell@digium.com>

	* contrib/init.d/rc.debian.asterisk, /: Merged revisions 115545 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115545 | russell | 2008-05-08 09:40:53 -0500 (Thu, 08 May 2008)
	  | 4 lines Use the same method for executing Asterisk as the rest
	  of the script. (closes issue #12611) Reported by: b_plessis
	  ........

	* main/sched.c: Fix up a problem that was introduced into the
	  scheduler when it was converted to use doubly linked lists. The
	  schedule() function had an optimization that had it try to guess
	  which direction would be better for the traversal to insert the
	  task into the scheduler queue. However, if the code chose the
	  path where it traversed the queue in reverse, and the result was
	  that the task should be at the head of the queue, then the code
	  would actually put it at the tail, instead. (Problem found by
	  bbryant, debugged and fixed by bbryant and me)

2008-05-07 20:22 +0000 [r115525-115535]  Tilghman Lesher <tlesher@digium.com>

	* sounds/Makefile: Advance to next sounds release

	* res/res_odbc.c: Don't free the object on destroy, as astobj2
	  takes care of that for you

2008-05-07 18:33 +0000 [r115513-115523]  Russell Bryant <russell@digium.com>

	* res/res_config_ldap.c: Only save a password if a username exists.
	  (closes issue #12600) Reported By: suretec Patch by me

	* res/res_config_ldap.c: Use the default that the log output claims
	  will be used for the basedn (closes issue #12599) Reported by:
	  suretec Patches: 12599.patch uploaded by juggie (license 24)

	* channels/chan_h323.c: Let chan_h323 build in dev mode

	* include/asterisk/dlinkedlists.h (added): re-add dlinkedlists.h to
	  trunk, oops!

	* /, include/asterisk/dlinkedlists.h (removed),
	  channels/chan_iax2.c: Merged revisions 115512 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r115512 | russell | 2008-05-07 11:24:09 -0500
	  (Wed, 07 May 2008) | 11 lines Merged revisions 115511 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r115511 | russell | 2008-05-07 11:22:49 -0500 (Wed, 07 May 2008)
	  | 3 lines Remove remnants of dlinkedlists. I didn't actually use
	  them in the final version of my IAX2 improvements. ........
	  ................

2008-05-07 13:49 +0000 [r115509]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/asterisk.ldap-schema,
	  contrib/scripts/asterisk.ldif: Update typos in description fields
	  (closes issue #12598) Reported by: suretec Patches:
	  asterisk_schema_changes.patch uploaded by suretec (license 70)

2008-05-07 13:41 +0000 [r115507]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Remove redundant header getting. (closes
	  issue #12597) Reported by: hooi

2008-05-06 20:15 +0000 [r115473]  Mark Michelson <mmichelson@digium.com>

	* utils/refcounter.c: Get refcounter to build with LOW_MEMORY
	  defined

2008-05-06 19:55 +0000 [r115419-115423]  Jason Parker <jparker@digium.com>

	* /, contrib/scripts/get_ilbc_source.sh: Merged revisions 115422
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r115422 | qwell | 2008-05-06 14:55:29 -0500
	  (Tue, 06 May 2008) | 15 lines Merged revisions 115421 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r115421 | qwell | 2008-05-06 14:54:57 -0500 (Tue, 06 May 2008) |
	  7 lines read requires an argument on some non-bash shells (closes
	  issue #12593) Reported by: bkruse Patches:
	  getilbc.sh_12593_v1.diff uploaded by bkruse (license 132)
	  ........ ................

	* /, res/res_musiconhold.c: Merged revisions 115418 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r115418 | qwell | 2008-05-06 14:34:58 -0500 (Tue, 06 May
	  2008) | 7 lines Switch to using ast_random() rather than just
	  rand(). This does not fix the bug reported, but I believe it is
	  correct. (from issue #12446) Patches: bug_12446.diff uploaded by
	  snuffy (license 35) ........

2008-05-06 19:32 +0000 [r115416]  Tilghman Lesher <tlesher@digium.com>

	* /, main/asterisk.c: Merged revisions 115415 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115415 | tilghman | 2008-05-06 14:31:39 -0500 (Tue, 06 May 2008)
	  | 2 lines Don't print the terminating NUL. (Closes issue #12589)
	  ........

2008-05-06 15:14 +0000 [r115344]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Change some NOTICE log messages to debug.

2008-05-06 13:55 +0000 [r115342]  Joshua Colp <jcolp@digium.com>

	* /, configure, configure.ac: Merged revisions 115341 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r115341 | file | 2008-05-06 10:54:15 -0300 (Tue, 06 May
	  2008) | 2 lines Add in missing argument. ........

2008-05-05 23:38 +0000 [r115334-115337]  Tilghman Lesher <tlesher@digium.com>

	* res/res_odbc.c: Merge refcounting of res_odbc

	* /, main/logger.c, main/asterisk.c: Merged revisions 115333 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115333 | tilghman | 2008-05-05 17:50:31 -0500 (Mon, 05 May 2008)
	  | 7 lines Separate verbose output from CLI output, by using a
	  preamble. (closes issue #12402) Reported by: Corydon76 Patches:
	  20080410__no_verbose_in_rx_output.diff.txt uploaded by Corydon76
	  (license 14) 20080501__no_verbose_in_rx_output__1.4.diff.txt
	  uploaded by Corydon76 (license 14) ........

2008-05-05 22:14 +0000 [r115329]  Mark Michelson <mmichelson@digium.com>

	* main/config.c: #execing the same file multiple times led to
	  warning messages saying that the same file was being #included
	  twice. This was due to the fact that #exec created a temporary
	  file which was then #included. The name of the temporary file was
	  the name of the #exec'd file, with the Unix timestamp and thread
	  ID concatenated. The issue was that if multiple #exec statements
	  of the same file were reached in the same second, then the result
	  was that the temporary files would have duplicate names. To
	  resolve this, the temporary file now has microsecond resolution
	  for the timestamp portion. (closes issue #12574) Reported by:
	  jmls Patches: 12574.patch uploaded by putnopvut (license 60)
	  Tested by: jmls, putnopvut

2008-05-05 22:13 +0000 [r115328]  Joshua Colp <jcolp@digium.com>

	* funcs/func_speex.c, /, build_tools/menuselect-deps.in, configure,
	  include/asterisk/autoconfig.h.in, codecs/codec_speex.c,
	  configure.ac: Merged revisions 115327 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115327 | file | 2008-05-05 19:10:05 -0300 (Mon, 05 May 2008) | 2
	  lines Make sure that either the main speex library contains
	  preprocess functions or that speexdsp does. If both fail then
	  speex stuff can not be built. ........

2008-05-05 22:01 +0000 [r115324]  Russell Bryant <russell@digium.com>

	* main/event.c: Simplify code by using a taskprocessor for
	  dispatching events in the Asterisk core.

2008-05-05 21:43 +0000 [r115321]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 115320 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115320 | mmichelson | 2008-05-05 16:41:34 -0500 (Mon, 05 May
	  2008) | 13 lines Don't consider a caller "handled" until the
	  caller is bridged with a queue member. There was too much of an
	  opportunity for the member to hang up (either during a delay,
	  announcement, or overly long agi) between the time that he
	  answered the phone and the time when he actually was bridged with
	  the caller. The consequence of this was that if the member hung
	  up in that interval, then proper abandonment details would not be
	  noted in the queue log if the caller were to hang up at any point
	  after the member hangup. (closes issue #12561) Reported by:
	  ablackthorn ........

2008-05-05 20:28 +0000 [r115315]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Remove my rant, since I have now replaced
	  the rant with code.

2008-05-05 20:22 +0000 [r115309-115313]  Tilghman Lesher <tlesher@digium.com>

	* Makefile, /: Merged revisions 115312 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115312 | tilghman | 2008-05-05 15:17:55 -0500 (Mon, 05 May 2008)
	  | 2 lines Reverse order, such that user configs override default
	  selections ........

	* include/asterisk/res_odbc.h, /: Merged revisions 115308 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115308 | tilghman | 2008-05-05 14:55:55 -0500 (Mon, 05 May 2008)
	  | 2 lines Err, the documentation on the return value of
	  ast_odbc_backslash_is_escape is exactly backwards. ........

2008-05-05 19:50 +0000 [r115305]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 115304 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115304 | russell | 2008-05-05 14:49:25 -0500 (Mon, 05 May 2008)
	  | 5 lines Avoid putting opaque="" in Digest authentication. This
	  patch came from switchvox. It fixes authentication with Primus in
	  Canada, and has been in use for a very long time without causing
	  problems with any other providers. (closes issue AST-36) ........

2008-05-05 19:42 +0000 [r115301-115302]  Tilghman Lesher <tlesher@digium.com>

	* UPGRADE.txt: Note change for ExecIf syntax (caught by jmls on
	  IRC)

	* main/manager.c, CHANGES: Optionally display the value of several
	  variables within the Status command. (Closes issue AST-34)

2008-05-05 13:52 +0000 [r115290]  Joshua Colp <jcolp@digium.com>

	* apps/app_chanspy.c: Document the 'B' option of app_chanspy.
	  (closes issue #12582) Reported by: IgorG Patches:
	  app_chanspy_B_option.diff uploaded by IgorG (license 20)

2008-05-05 10:55 +0000 [r115288]  Kevin P. Fleming <kpfleming@digium.com>

	* UPGRADE.txt: clarify wording

2008-05-05 03:25 +0000 [r115286]  Tilghman Lesher <tlesher@digium.com>

	* contrib/init.d/rc.debian.asterisk,
	  contrib/init.d/rc.mandrake.asterisk, /,
	  contrib/init.d/rc.redhat.asterisk,
	  contrib/init.d/rc.gentoo.asterisk,
	  contrib/init.d/rc.slackware.asterisk,
	  contrib/scripts/safe_asterisk, contrib/init.d/rc.suse.asterisk:
	  Merged revisions 115285 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115285 | tilghman | 2008-05-04 22:22:25 -0500 (Sun, 04 May 2008)
	  | 7 lines When starting Asterisk, bug out if Asterisk is already
	  running. (closes issue #12525) Reported by: explidous Patches:
	  20080428__bug12525.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: mvanbaak ........

2008-05-04 02:11 +0000 [r115277-115283]  Joshua Colp <jcolp@digium.com>

	* /, configure, acinclude.m4: Merged revisions 115282 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r115282 | file | 2008-05-03 23:09:44 -0300 (Sat, 03 May
	  2008) | 2 lines Expand the test function for GCC attributes so
	  that more complex attributes are properly recognized. ........

	* /, include/asterisk/compiler.h: Merged revisions 115279 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115279 | file | 2008-05-03 22:50:59 -0300 (Sat, 03 May 2008) | 2
	  lines For my next trick I will make these work with what our
	  autoconf header file gives us. ........

	* /, configure, acinclude.m4: Merged revisions 115276 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r115276 | file | 2008-05-03 22:43:26 -0300 (Sat, 03 May
	  2008) | 2 lines Treat warnings as errors when checking if a GCC
	  attribute exists. We have to do this as GCC will just ignore the
	  attribute and pop up a warning, it won't actually fail to
	  compile. ........

2008-05-03 04:23 +0000 [r115268-115274]  Dwayne M. Hubbard <dhubbard@digium.com>

	* apps/app_voicemail.c: app_voicemail uses a taskprocessor for mwi
	  notification subscriptions

	* main/pbx.c: pbx uses a taskprocessor for device state changes

	* apps/app_queue.c: app_queue uses a taskprocessor for device state
	  changes

	* include/asterisk/taskprocessor.h (added), main/Makefile,
	  main/taskprocessor.c (added), include/asterisk/_private.h,
	  main/asterisk.c: A taskprocessor is an object that has a name, a
	  task queue, and an event processing thread. Modules reference a
	  taskprocessor, push tasks into the taskprocessor as needed, and
	  unreference the taskprocessor when the taskprocessor is no longer
	  needed. A task wraps a callback function pointer and a data
	  pointer and is managed internal to the taskprocessor subsystem.
	  The callback function is responsible for releasing task data.
	  Taskprocessor API * ast_taskprocessor_get(..) - returns a
	  reference to a taskprocessor * ast_taskprocessor_unreference(..)
	  - releases reference to a taskprocessor *
	  ast_taskprocessor_push(..) - push a task into a taskprocessor
	  queue Check doxygen for more details

2008-05-02 14:51 +0000 [r115197-115199]  Mark Michelson <mmichelson@digium.com>

	* res/snmp/agent.c: Make res/snmp/agent.c build

	* /, include/asterisk/sched.h: Merged revisions 115196 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r115196 | mmichelson | 2008-05-02 09:28:19 -0500 (Fri,
	  02 May 2008) | 6 lines Clarify a comment that was, well, just
	  wrong. It turns out that ignoring the way that macros expand.
	  Instead, I have clarified in the comment why the macro will work
	  even if the scheduler id for the task to be deleted changes
	  during the execution of the macro. ........

2008-05-02 02:56 +0000 [r115104-115159]  Tilghman Lesher <tlesher@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  include/asterisk/config.h, include/asterisk/compiler.h: Okay,
	  maybe FreeBSD will like this better.

	* include/asterisk/logger.h, channels/chan_sip.c,
	  include/asterisk/config.h, include/asterisk/sched.h,
	  main/asterisk.c, main/config.c, main/sched.c,
	  apps/app_voicemail.c: Add attributes to various API calls, to
	  help track down bugs (and remove a deprecated function)

	* include/asterisk/res_odbc.h, /: Merged revisions 115102 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115102 | tilghman | 2008-05-01 18:20:25 -0500 (Thu, 01 May 2008)
	  | 2 lines Change the comment of deprecated to an actual compiler
	  deprecation ........

2008-05-01 23:09 +0000 [r115078]  Brett Bryant <bbryant@digium.com>

	* channels/chan_zap.c, configure, configure.ac, CHANGES: Add two
	  new console commands "pri show version" and "ss7 show version"
	  that will show the version of each library respectively.

2008-05-01 23:06 +0000 [r115076]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c, main/pbx.c, apps/app_read.c,
	  funcs/func_timeout.c, apps/app_readexten.c, apps/app_disa.c,
	  include/asterisk/channel.h, apps/app_queue.c, CHANGES,
	  apps/app_speech_utils.c, main/cli.c, main/channel.c, main/dial.c,
	  main/manager.c, apps/app_dumpchan.c, res/res_agi.c, main/app.c,
	  include/asterisk/pbx.h, apps/app_rpt.c: Modify TIMEOUT() to be
	  accurate down to the millisecond. (closes issue #10540) Reported
	  by: spendergrass Patches: 20080417__bug10540.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: blitzrage

2008-05-01 19:05 +0000 [r115021]  Russell Bryant <russell@digium.com>

	* doc/smdi.txt, res/res_smdi.c, CHANGES: Merge changes from
	  team/russell/smdi-msg-searching This commit adds some new
	  features to the SMDI_MSG_RETRIEVE() dialplan function.
	  Previously, this function only allowed searching by the
	  forwarding station. I have added some options to allow you to
	  also search for messages in the queue by the message desk
	  terminal ID, as well as the message desk number. This originally
	  came up as a suggestion on the asterisk-dev mailing list.

2008-05-01 19:00 +0000 [r115018]  Tilghman Lesher <tlesher@digium.com>

	* /, main/utils.c: Merged revisions 115017 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r115017 | tilghman | 2008-05-01 13:59:08 -0500 (Thu, 01 May 2008)
	  | 6 lines '#' is another reserved character for URIs that also
	  needs to be escaped. (closes issue #10543) Reported by: blitzrage
	  Patches: 20080418__bug10543.diff.txt uploaded by Corydon76
	  (license 14) ........

2008-05-01 18:28 +0000 [r114977]  Brett Bryant <bbryant@digium.com>

	* funcs/func_speex.c: Add "read" capability to new libspeex
	  functions in func_speex.c. func_speex.c is based on contributions
	  from Switchvox.

2008-05-01 17:28 +0000 [r114931]  Russell Bryant <russell@digium.com>

	* UPGRADE.txt: Clarify the deprecation notice about Macro() to note
	  that it will not be removed for the sake of backwards
	  compatibility, since it is a non-trivial task to convert existing
	  large dialplans that depend on Macro() to use GoSub(), instead.

2008-05-01 16:57 +0000 [r114926]  Brett Bryant <bbryant@digium.com>

	* funcs/func_speex.c (added), include/asterisk/audiohook.h,
	  main/audiohook.c, CHANGES: Add two new dialplan functions from
	  libspeex for applying audio gain control and denoising to a
	  channel, AGC() and DENOISE(). Also included, is a change to the
	  audiohook API to add a new function (ast_audiohook_remove) that
	  can remove an audiohook from a channel before it is detached.
	  This code is based on a contribution from Switchvox.

2008-05-01 16:49 +0000 [r114922]  Jason Parker <jparker@digium.com>

	* channels/chan_zap.c: Allow dringXrange to properly default to 10,
	  as was done in 1.4. dringXrange is a new feature that was added,
	  and it attempted to default, but only when the option was
	  specified. (closes issue #12536) Reported by: bjm Patches:
	  12536-dringXrange.diff uploaded by qwell (license 4) Tested by:
	  bjm

2008-04-30 20:51 +0000 [r114912]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Add
	  support for specifying the registration expiry on a per
	  registration basis in the register line. This comes from a
	  Switchvox patch. (issue AST-24)

2008-04-30 19:30 +0000 [r114906]  Mark Michelson <mmichelson@digium.com>

	* configs/queues.conf.sample, CHANGES, apps/app_queue.c: Adding new
	  configuration options to app_queue. This adds two new values to
	  announce-position, "limit" and "more," as well as a new option,
	  announce-position-limit. For more information on the use of these
	  options, see CHANGES or configs/queues.conf.sample. (closes issue
	  #10991) Reported by: slavon Patches: app_q.diff uploaded by
	  slavon (license 288) Tested by: slavon, putnopvut

2008-04-30 19:21 +0000 [r114904]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_meetme.c, apps/app_minivm.c, apps/app_morsecode.c,
	  apps/app_macro.c, apps/app_externalivr.c, apps/app_chanspy.c,
	  apps/app_stack.c, apps/app_speech_utils.c, apps/app_voicemail.c,
	  apps/app_while.c: Lock around variables retrieved, and copy the
	  values, if they stay persistent, since another thread could
	  remove them. (closes issue #12541) Reported by: snuffy Patches:
	  bug_12156_apps.diff uploaded by snuffy (license 35) Several
	  additional changes by me

2008-04-30 16:55 +0000 [r114899]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 114890 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114890 | oej | 2008-04-30 18:23:17 +0200 (Ons, 30 Apr 2008) | 7
	  lines Don't crash on bad SIP replys. Fix created in Huntsville
	  together with Mark M (putnopvut) (closes issue #12363) Reported
	  by: jvandal Tested by: putnopvut, oej ........

2008-04-30 16:34 +0000 [r114892]  Russell Bryant <russell@digium.com>

	* /, channels/chan_console.c, channels/chan_iax2.c: Merged
	  revisions 114891 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114891 | russell | 2008-04-30 11:30:01 -0500 (Wed, 30 Apr 2008)
	  | 28 lines Merge changes from team/russell/iax2_find_callno and
	  iax2_find_callno_1.4 These changes address a critical performance
	  issue introduced in the latest release. The fix for the latest
	  security issue included a change that made Asterisk randomly
	  choose call numbers to make them more difficult to guess by
	  attackers. However, due to some inefficient (this is by far, an
	  understatement) code, when Asterisk chose high call numbers,
	  chan_iax2 became unusable after just a small number of calls. On
	  a small embedded platform, it would not be able to handle a
	  single call. On my Intel Core 2 Duo @ 2.33 GHz, I couldn't run
	  more than about 16 IAX2 channels. Ouch. These changes address
	  some performance issues of the find_callno() function that have
	  bothered me for a very long time. On every incoming media frame,
	  it iterated through every possible call number trying to find a
	  matching active call. This involved a mutex lock and unlock for
	  each call number checked. So, if the random call number chosen
	  was 20000, then every media frame would cause 20000 locks and
	  unlocks. Previously, this problem was not as obvious since
	  Asterisk always chose the lowest call number it could. A second
	  container for IAX2 pvt structs has been added. It is an astobj2
	  hash table. When we know the remote side's call number, the pvt
	  goes into the hash table with a hash value of the remote side's
	  call number. Then, lookups for incoming media frames are a very
	  fast hash lookup instead of an absolutely insane array traversal.
	  In a quick test, I was able to get more than 3600% more IAX2
	  channels on my machine with these changes. ........

2008-04-30 16:14 +0000 [r114888]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_console.c: Fixes a bug where if a stream monitor
	  thread was not created (caused from failure of opening or
	  starting the stream) pthread_cancel was called with an invalid
	  thread ID.

2008-04-30 14:49 +0000 [r114876-114884]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/iax2.h, channels/chan_iax2.c: Merged revisions 114880
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114880 | kpfleming | 2008-04-30 09:46:57 -0500 (Wed, 30 Apr
	  2008) | 2 lines use the ARRAY_LEN macro for indexing through the
	  iaxs/iaxsl arrays so that the size of the arrays can be adjusted
	  in one place, and change the size of the arrays from 32768 calls
	  to 2048 calls when LOW_MEMORY is defined ........

	* /, Makefile.rules: Merged revisions 114875 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114875 | kpfleming | 2008-04-30 07:14:07 -0500 (Wed, 30 Apr
	  2008) | 2 lines pay attention to *all* header files for
	  dependency tracking, not just the local ones (inspired by r578 of
	  asterisk-addons by tilghman) ........

2008-04-30 05:05 +0000 [r114874]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: Document the Incomplete application addition.

2008-04-29 22:54 +0000 [r114866]  Jeff Peeler <jpeeler@digium.com>

	* channels/iax2-provision.c: Fixes a problem where all the
	  templates were marked as dead no matter what. The templates
	  should only be marked as dead if a configuration file has been
	  successfully loaded and has changes. Bug found while making API
	  documentation for 1.6.0.

2008-04-29 21:07 +0000 [r114857]  Mark Michelson <mmichelson@digium.com>

	* apps/app_chanspy.c: Patching app_chanspy to jibe better with what
	  is documented. This allows for a colon-delimited list of
	  spygroups to be specified when calling the ChanSpy application
	  with the 'g' option. Prior to this, you could only specify a
	  single group when using the 'g' option. I also have upped the
	  maximum number of spygroups to 128 and added a #define so that
	  this can be easily increased or decreased later. (closes issue
	  #12497) Reported by: jsmith Patches:
	  app_chanspy_multiple_groups_v2.patch uploaded by jsmith (license
	  15) Tested by: atis, jvandal

2008-04-29 20:05 +0000 [r114852]  Jason Parker <jparker@digium.com>

	* phoneprov/polycom.xml: Fix formatting

2008-04-29 19:42 +0000 [r114849]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 114848 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114848 | mmichelson | 2008-04-29 14:40:06 -0500 (Tue, 29 Apr
	  2008) | 14 lines Use the MACRO_CONTEXT and MACRO_EXTEN channel
	  variables instead of the channel's macrocontext and macroexten
	  fields. This is needed because if macros are daisy-chained, the
	  incorrect context and extension are placed on the new channel. I
	  also added locking to the channel prior to accessing these
	  variables as noted in trunk's janitor project file. (closes issue
	  #12549) Reported by: darren1713 Patches:
	  app_queue.c.macroextenpatch uploaded by darren1713 (license 116)
	  (with modifications from me) Tested by: putnopvut ........

2008-04-29 18:58 +0000 [r114845]  Kevin P. Fleming <kpfleming@digium.com>

	* main/features.c: fix this logic to actually be correct... the fd
	  can't be *both* -1 and an array index to be checked in rfds/efds
	  (bug found by gcc-4.3)

2008-04-29 18:48 +0000 [r114832-114841]  Mark Michelson <mmichelson@digium.com>

	* UPGRADE.txt, apps/app_directory.c: Make app_directory dependent
	  on app_voicemail. This is because the function which says the
	  person's name is handled inside app_voicemail now.

	* apps/app_directory.c, apps/app_voicemail.c: Since there is now a
	  globally available function for saying someone's name, a LOT of
	  functions in app_directory can be removed since the ODBC-specific
	  lookups are accomplished within app_voicemail. This change
	  greatly reduces the amount of lines in app_directory that were
	  solely for the purpose of looking up a name when ODBC_STORAGE is
	  specified for voicemail. This commit also makes the name-saying
	  interruptable via DTMF.

	* apps/app_directory.c: Fix a crash happening in app_directory.
	  This crash would occur if a users.conf existed.

2008-04-29 17:10 +0000 [r114830]  Jason Parker <jparker@digium.com>

	* res/res_config_pgsql.c, /: Merged revisions 114829 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114829 | qwell | 2008-04-29 12:08:55 -0500 (Tue, 29 Apr
	  2008) | 1 line Change warning message to debug, since there are
	  cases where 0 results is perfectly fine. ........

2008-04-29 12:54 +0000 [r114824]  Kevin P. Fleming <kpfleming@digium.com>

	* /, contrib/scripts/get_ilbc_source.sh: Merged revisions 114823
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r114823 | kpfleming | 2008-04-29 07:53:12 -0500
	  (Tue, 29 Apr 2008) | 10 lines Merged revisions 114822 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r114822 | kpfleming | 2008-04-29 07:52:32 -0500 (Tue, 29 Apr
	  2008) | 2 lines stop script from appending source code if run
	  multiple times ........ ................

2008-04-28 22:38 +0000 [r114813]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/app.h, main/app.c, CHANGES, apps/app_chanspy.c,
	  apps/app_voicemail.c: Adding a new option 'n' to app_chanspy.
	  This option allows for the name of the spied-on party to be
	  spoken instead of the channel name or number. This was
	  accomplished by adding a new function pointer to point to a
	  function in app_voicemail which retrieves the name file and plays
	  it. This makes for an easy way that applications may play a
	  user's name should it be necessary. app_directory, in particular,
	  can be simplified greatly by this change. This change comes as a
	  suggestion from Switchvox, which already has this feature. AST-23

2008-04-28 17:00 +0000 [r114776]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Fix deadlock issue in chan_zap with libss7
	  due to channel variables being set with the channel pvt lock
	  being held. #12512

2008-04-28 16:37 +0000 [r114773]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c, main/pbx.c, include/asterisk/pbx.h: Add
	  incomplete matching to PBX code and app_dial (closes issue
	  #12351) Reported by: Corydon76 Patches:
	  20080402__pbx_incomplete__3.diff.txt uploaded by Corydon76
	  (license 14) pbx_incomplete_with_timeout.diff uploaded by fabled
	  (license 448) Tested by: Corydon76, fabled

2008-04-28 13:42 +0000 [r114713]  Joshua Colp <jcolp@digium.com>

	* configure, configure.ac: Update autoconf logic with latest API
	  change for libss7.

2008-04-28 04:53 +0000 [r114706-114709]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_jingle.c, /, channels/chan_gtalk.c: Merged
	  revisions 114708 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114708 | tilghman | 2008-04-27 23:47:39 -0500 (Sun, 27 Apr 2008)
	  | 5 lines When modules are embedded, they take on a different
	  name, without the ".so" extension. Specifically check for this
	  name, when we're checking if a module is loaded. (Closes issue
	  #12534) ........

	* apps/app_voicemail.c: Fix breakage caused by #12028. (Closes
	  issue #12535)

2008-04-27 22:54 +0000 [r114703]  Russell Bryant <russell@digium.com>

	* channels/chan_skinny.c: s/chan_zap/chan_skinny/

2008-04-27 15:17 +0000 [r114700]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: Make MWI in chan_skinny event based
	  modeled after chan_zap and chan_mgcp. (closes issue #12214)
	  Reported by: DEA Patches: chan_skinny-vm-events-v3.txt uploaded
	  by DEA (license 3) Tested by: DEA and me

2008-04-27 01:28 +0000 [r114696]  Sean Bright <sean.bright@gmail.com>

	* /, configure, configure.ac: Merged revisions 114695 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114695 | seanbright | 2008-04-26 21:26:15 -0400 (Sat,
	  26 Apr 2008) | 5 lines When we don't explicitly pass a path to
	  the --with-tds configure option, we may end up finding tds.h in
	  /usr/local/include instead of /usr/include. If this happens, the
	  grep that looks for the version (from tdsver.h) will fail and
	  we'll have some problems during the build. ........

2008-04-26 15:08 +0000 [r114683-114692]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: Unleak reference

	* /, contrib/scripts/vmail.cgi: Merged revisions 114689 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114689 | tilghman | 2008-04-26 08:15:21 -0500 (Sat, 26 Apr 2008)
	  | 6 lines Clicking forward without selecting a message leaves an
	  errant .lock file. (closes issue #12528) Reported by: pukepail
	  Patches: patch.diff uploaded by pukepail (license 431) ........

	* channels/chan_sip.c: Add 'sip qualify peer <peer>' command (with
	  AMI SIPqualifypeer) (closes issue #12524) Reported by: ctooley
	  Patches: sip_qualify_peer.diff.2 uploaded by ctooley (license
	  136) some modifications for trunk by Corydon76 Tested by:
	  Corydon76

2008-04-25 22:24 +0000 [r114678]  Mark Michelson <mmichelson@digium.com>

	* CHANGES, apps/app_chanspy.c: Adding a new option, 'B' to
	  app_chanspy. This option allows the spy to barge on the call. It
	  is like the existing whisper option, except that it allows the
	  spy to talk to both sides of the conversation on which he is
	  spying. This feature has existed in Switchvox, and this merges
	  the functionality into Asterisk. (AST-32)

2008-04-25 22:04 +0000 [r114674-114676]  Russell Bryant <russell@digium.com>

	* pbx/pbx_lua.c: Lock the channel around datastore access (closes
	  issue #12527) Reported by: mnicholson Patches: pbx_lua4.diff
	  uploaded by mnicholson (license 96)

	* /, channels/chan_iax2.c: Merged revisions 114673 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114673 | russell | 2008-04-25 16:54:40 -0500 (Fri, 25
	  Apr 2008) | 3 lines Use consistent logic for checking to see if a
	  call number has been chosen yet. Also, remove some redundant
	  logic I recently added in a fix. ........

2008-04-25 20:20 +0000 [r114665-114667]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c, apps/app_waitforring.c, apps/app_minivm.c,
	  apps/app_zapscan.c, apps/app_sms.c, apps/app_externalivr.c,
	  apps/app_followme.c, apps/app_queue.c, apps/app_rpt.c,
	  apps/app_playback.c, apps/app_parkandannounce.c,
	  apps/app_speech_utils.c: Whitespace changes only

	* main/app.c: Oops, this isn't necessarily AGI that is forking
	  anymore

2008-04-25 19:33 +0000 [r114663]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 114662 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114662 | mmichelson | 2008-04-25 14:32:02 -0500 (Fri, 25 Apr
	  2008) | 4 lines Move the unlock of the spyee channel to outside
	  the start_spying() function so that the channel is not unlocked
	  twice when using whisper mode. ........

2008-04-25 18:32 +0000 [r114660]  Jason Parker <jparker@digium.com>

	* apps/app_directed_pickup.c, apps/app_pickupchan.c (removed):
	  Merge app_pickupchan with app_directed_pickup, for AST-27.
	  Initially, this was to be a new feature, with a patch from
	  Switchvox, but after discussions, it was noted that this feature
	  already existed in trunk. The resulting discussions ended in a
	  comment that was along the lines of "the patch provided here is a
	  lot smaller than what is already in trunk, because it doesn't
	  create a new application and duplicate existing code" It was
	  decided that these two applications could be easily merged to
	  reduce code duplication. SO, that's what this does.

2008-04-25 18:18 +0000 [r114656]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: This patch allows for forwarding a message
	  with a "comment" attachment if using IMAP storage for voicemail.
	  The comment will be recorded and attached as a second attachment
	  in addition to the original message. This will be invoked if you
	  choose to prepend a message the way you would with file or ODBC
	  storage (closes issue #12028) Reported by: jaroth Patches:
	  forward_with_comment_v2.patch uploaded by jaroth (license 50)
	  Tested by: jaroth

2008-04-25 18:18 +0000 [r114655]  Russell Bryant <russell@digium.com>

	* main/features.c: Merge code from team/russell/parking_updates Add
	  some additional features to the core park_call_full() function,
	  and expose them as options to the Park() application. The
	  functionality being added is the ability to specify a custom
	  return extension/context/priority, a custom timeout, and a couple
	  of options. The options are to play ringing instead of MOH to the
	  parked caller, and to randomize parking spot selection. (code
	  inspired by the patch in AST-17, code from switchvox)

2008-04-25 16:25 +0000 [r114651]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fix a memory leak and protect against
	  potential dereferences of a NULL pointer.

2008-04-25 13:56 +0000 [r114644]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_console.c: Speaking of building...

2008-04-24 22:16 +0000 [r114637]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_dial.c, channels/chan_unistim.c, channels/chan_local.c,
	  channels/chan_zap.c, channels/chan_sip.c, apps/app_disa.c,
	  apps/app_alarmreceiver.c, include/asterisk/channel.h,
	  channels/chan_gtalk.c, apps/app_followme.c, apps/app_queue.c,
	  channels/chan_iax2.c, channels/chan_oss.c, main/channel.c,
	  channels/chan_jingle.c, channels/chan_misdn.c,
	  channels/chan_skinny.c, channels/chan_h323.c,
	  channels/chan_alsa.c, apps/app_externalivr.c,
	  channels/chan_mgcp.c: Pass the hangup cause all the way to the
	  calling app/channel. (closes issue #11328) Reported by: rain
	  Patches: 20071207__pass_cause_in_hangup_control_frame.diff.txt
	  uploaded by Corydon76 (license 14) brought up-to-date to trunk by
	  me

2008-04-24 22:11 +0000 [r114635]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Hey look, it builds. (closes issue #12519)
	  Reported by: falves11

2008-04-24 21:35 +0000 [r114625-114633]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 114632 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114632 | mmichelson | 2008-04-24 16:35:08 -0500 (Thu, 24 Apr
	  2008) | 11 lines Re-invite RTP during a masquerade so that, for
	  instance, an AMI redirect of two channels which are natively
	  bridged will preserve audio on both channels. This prevents a
	  problem with Asterisk not re-inviting due to one of the channels
	  having being a zombie. (closes issue #12513) Reported by:
	  mneuhauser Patches:
	  asterisk-1.4-114602_restore-RTP-on-fixup.patch uploaded by
	  mneuhauser (license 425) ........

	* /, apps/app_queue.c: Merged revisions 114628 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114628 | mmichelson | 2008-04-24 15:43:03 -0500 (Thu, 24 Apr
	  2008) | 8 lines Output of channel variables when
	  eventwhencalled=vars was set was being truncated two characters.
	  This patch corrects the problem. (closes issue #12493) Reported
	  by: davidw ........

	* channels/chan_local.c, /: Merged revisions 114624 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114624 | mmichelson | 2008-04-24 15:04:24 -0500 (Thu,
	  24 Apr 2008) | 10 lines Resolve a deadlock in chan_local by
	  releasing the channel lock temporarily. (closes issue #11712)
	  Reported by: callguy Patches: 11712.patch uploaded by putnopvut
	  (license 60) Tested by: acunningham ........

2008-04-24 19:54 +0000 [r114617-114622]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_local.c, /: Merged revisions 114621 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114621 | tilghman | 2008-04-24 14:53:36 -0500 (Thu, 24
	  Apr 2008) | 4 lines Ensure that when we set the accountcode, it
	  actually shows up in the CDR. (Fix for AMI Originate) (Closes
	  issue #12007) ........

	* apps/app_meetme.c: Fix DST calculation, and fix bug in
	  calculation of whether conf has started yet or not (Closes issue
	  #12292) Reported by: DEA Patches: app_meetme-rt-dst-sched-fix.txt
	  uploaded by DEA (license 3)

2008-04-24 16:47 +0000 [r114612]  Jason Parker <jparker@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 51989 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4 (closes
	  issue #12496) Reported by: daniele Patches:
	  misdn-moh-1.6.0-beta7.1.patch uploaded by daniele (license 471)
	  Tested by: daniele Technically, I didn't use the patch above
	  except to find out what revision to merge - but it's the same
	  thing as this revision. ........ r51989 | crichter | 2007-01-24
	  06:57:22 -0600 (Wed, 24 Jan 2007) | 1 line added fix from #8899
	  ........

2008-04-24 15:56 +0000 [r114609]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 114608 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114608 | russell | 2008-04-24 10:55:21 -0500 (Thu, 24
	  Apr 2008) | 4 lines Fix a silly mistake in a change I made
	  yesterday that caused chan_iax2 to blow up very quickly. (issue
	  #12515) ........

2008-04-24 14:59 +0000 [r114606]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 114603 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114603 | oej | 2008-04-24 16:55:18 +0200 (Tor, 24 Apr 2008) | 3
	  lines Only have one max-forwards header in outbound REFERs.
	  Discovered in the Asterisk SIP Masterclass in Orlando. Thanks
	  Joe! ........

2008-04-24 14:55 +0000 [r114598-114604]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Change a verbose message to debug. (closes
	  issue #12514)

	* /, main/http.c: Merged revisions 114600 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114600 | russell | 2008-04-23 17:18:12 -0500 (Wed, 23 Apr 2008)
	  | 6 lines Improve some broken cookie parsing code. Previously,
	  manager login over HTTP would only work if the mansession_id
	  cookie was first. Now, the code builds a list of all of the
	  cookies in the Cookie header. This fixes a problem observed by
	  users of the Asterisk GUI. (closes AST-20) ........

	* /, apps/app_chanspy.c: Merged revisions 114597 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114597 | russell | 2008-04-23 15:49:18 -0500 (Wed, 23 Apr 2008)
	  | 10 lines Fix an issue that caused getting the correct next
	  channel to not always work. Also, remove setting the amount of
	  time to wait for a digit from 5 seconds back down to 1/10 of a
	  second. I believe this was so the beep didn't get played over and
	  over really fast, but a while back I put in another fix for that
	  issue. (closes issue #12498) Reported by: jsmith Patches:
	  app_chanspy_channel_walk.trunk.patch uploaded by jsmith (license
	  15) ........

2008-04-23 18:33 +0000 [r114595]  Jason Parker <jparker@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 114594 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114594 | qwell | 2008-04-23 13:28:44 -0500 (Wed, 23 Apr
	  2008) | 8 lines Fix reload/unload for res_musiconhold module.
	  (closes issue #11575) Reported by: sunder Patches:
	  M11575_14_rev3.diff uploaded by junky (license 177)
	  bug11575_trunk.diff.txt uploaded by jamesgolovich (license 176)
	  ........

2008-04-23 18:01 +0000 [r114588-114592]  Russell Bryant <russell@digium.com>

	* main/manager.c, /, include/asterisk/manager.h: Merged revisions
	  114591 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114591 | russell | 2008-04-23 12:55:31 -0500 (Wed, 23 Apr 2008)
	  | 5 lines Store the manager session ID explicitly as 4 byte ID
	  instead of a ulong. The mansession_id cookie is coded to be
	  limited to 8 characters of hex, and this could break logins from
	  64-bit machines in some cases. (inspired by AST-20) ........

	* /, channels/chan_iax2.c: Merged revisions 114587 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114587 | russell | 2008-04-23 12:16:32 -0500 (Wed, 23
	  Apr 2008) | 2 lines Fix find_callno_locked() to actually return
	  the callno locked in some more cases. ........

2008-04-23 16:53 +0000 [r114585]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 114584 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114584 | oej | 2008-04-23 18:51:41 +0200 (Ons, 23 Apr 2008) | 2
	  lines Add 502 support for both directions, not only one... (see
	  r114571) ........

2008-04-23 14:55 +0000 [r114580]  Joshua Colp <jcolp@digium.com>

	* main/pbx.c, /: Merged revisions 114579 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114579 | file | 2008-04-23 11:54:11 -0300 (Wed, 23 Apr 2008) | 4
	  lines Instead of stopping dialplan execution when SayNumber
	  attempts to say a large number that it can not print out a
	  message informing the user and continue on. (closes issue #12502)
	  Reported by: bcnit ........

2008-04-23 00:58 +0000 [r114575-114577]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/logger.h, include/asterisk/astobj.h,
	  apps/app_voicemail.c: Round 2 of IMAP_STORAGE app_voicemail.c
	  fixes: This fixes a bug that was thought to be fixed already.
	  app_voicemail, if using IMAP_STORAGE, has a problem because the
	  IMAP header files include syslog.h, which define LOG_WARNING and
	  LOG_DEBUG to be different than what Asterisk uses for those same
	  macros. This was "fixed" in the past by including all the IMAP
	  header files prior to including asterisk.h. This fix worked...
	  unless you were to try to compile with MALLOC_DEBUG. MALLOC_DEBUG
	  prepends the inclusion of astmm.h to every file, which means that
	  no matter what order the includes are in in app_voicemail, the
	  unexpected values for LOG_WARNING and LOG_DEBUG will be in place.
	  The action taken for this fix was to define AST_LOG_* macros in
	  addition to the LOG_* macros already defined. These new macros
	  are used in app_voicemail.c, logger.h, and astobj.h right now,
	  and their use will be encouraged in the future. In consideration
	  of those who have written third-party modules which use the LOG_*
	  macros, these will NOT be removed from the source, however future
	  use of these macros is discouraged.

	* apps/app_voicemail.c: Round 1 of IMAP_STORAGE-related
	  app_voicemail changes This makes IMAP_STORAGE include the proper
	  headers if you have specified the "system" option for --with-imap
	  when running the configure script and your IMAP-related headers
	  exist in /usr/include/c-client. This change is due to a hasty
	  merge of a 1.4 change I made.

2008-04-22 23:58 +0000 [r114572]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 114571 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114571 | tilghman | 2008-04-22 18:51:44 -0500 (Tue, 22 Apr 2008)
	  | 2 lines Treat a 502 just like a 503, when it comes to
	  processing a response code ........

2008-04-22 22:17 +0000 [r114559]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 114558 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22
	  Apr 2008) | 5 lines When we receive a full frame that is supposed
	  to contain our call number, ensure that it has the correct one.
	  (closes issue #10078) (AST-2008-006) ........

2008-04-22 21:57 +0000 [r114553]  Steve Murphy <murf@digium.com>

	* main/pbx.c: (closes issue #12469) Reported by: triccyx I had a
	  bit a problem reproducing this in my setup (trying not to disturb
	  my other stuff) but finally, I got it. The problem appears to be
	  that the extension is being added in replace mode, which kinda
	  assumes that the pattern trie has been formed, when in fact, in
	  this case, it was not. The checks being done are not nec. when
	  the tree is not yet formed, as changes like this will be
	  summarized when the trie is formed in the future. I tested the
	  fix, and the crash no longer happens. Feel free to open the bug
	  again if this fix doesn't cure the problem.

2008-04-22 20:25 +0000 [r114548]  Russell Bryant <russell@digium.com>

	* main/channel.c: re-add a fix that got lost with a recent change

2008-04-22 18:14 +0000 [r114540]  Jason Parker <jparker@digium.com>

	* main/pbx.c, include/asterisk/pbx.h, apps/app_queue.c: Allow
	  setqueuevar=yes (et al) to work, after changes to
	  pbx_builtin_setvar() (closes issue #12490) Reported by: bcnit
	  Patches: 12490-queuevars-3.diff uploaded by qwell (license 4)
	  Tested by: qwell

2008-04-22 18:04 +0000 [r114533-114538]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 114537 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114537 | russell | 2008-04-22 13:03:33 -0500 (Tue, 22
	  Apr 2008) | 9 lines If the dial string passed to the call channel
	  callback does not indicate an extension, then consider the
	  extension on the channel before falling back to the default.
	  (closes issue #12479) Reported by: darren1713 Patches:
	  exten_dial_fix_chan_iax2.c.patch uploaded by darren1713 (license
	  116) ........

	* CHANGES, apps/app_jack.c: Add a c() option for the Jack()
	  application and JACK_HOOK() funciton for supplying a custom
	  client name. Using the channel name is still the default. This
	  was done at the request of Jared Smith.

2008-04-22 15:54 +0000 [r114529]  Joshua Colp <jcolp@digium.com>

	* configs/sip_notify.conf.sample, channels/chan_sip.c: Add support
	  for authenticating on a NOTIFY request. This is useful for phones
	  that require it when sending them a special packet to get them to
	  do something (such as reload their configuration). (closes issue
	  #9896) Reported by: IgorG Patches: sipnotify-113980-v14.patch
	  uploaded by IgorG (license 20)

2008-04-22 15:46 +0000 [r114527]  Russell Bryant <russell@digium.com>

	* main/manager.c: Correct action_ping() and action_events() with
	  regards to Manager 1.1 documentation. Also, fix a bug in
	  xml_translate(). (closes issue #11649) Reported by: ys Patches:
	  trunk_manager.c.diff uploaded by ys (license 281)

2008-04-22 14:38 +0000 [r114520]  Steve Murphy <murf@digium.com>

	* channels/chan_sip.c, main/utils.c: Hopefully, this will resolve
	  the issues that russellb had with this log_show_lock(). I
	  gathered the code that filled the string, and put it in a
	  different func which I cryptically call
	  "append_lock_information()". Now, both log_show_lock(), and
	  handle_show_locks() both call this code to do the work. Tested,
	  seems to work fine. Also, log_show_lock was modified to use the
	  ast_str stuff, along with checking for successful ast_str
	  creation, and freeing the ast_str obj when finished. A break was
	  inserted to terminate the search for the lock; we should never
	  see it twice. An example usage in chan_sip.c was created as a
	  comment, for instructional purposes.

2008-04-21 23:42 +0000 [r114487]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_unistim.c, channels/chan_zap.c,
	  channels/chan_sip.c, include/asterisk/channel.h,
	  channels/chan_gtalk.c, channels/chan_console.c,
	  channels/chan_iax2.c, configs/features.conf.sample,
	  configs/iax.conf.sample, channels/chan_jingle.c,
	  channels/chan_skinny.c, funcs/func_channel.c, main/features.c,
	  apps/app_dumpchan.c, configs/sip.conf.sample,
	  channels/chan_mgcp.c: (closes issue #6113) Reported by: oej
	  Tested by: jpeeler This patch implements multiple parking lots
	  for parked calls. The default parkinglot is used by default,
	  however setting the channel variable PARKINGLOT in the dialplan
	  will allow use of any other configured parkinglot. See
	  configs/features.conf.sample for more details on setting up
	  another non-default parkinglot. Also, one can (currently) set the
	  default parkinglot to use in the driver configuration file via
	  the parkinglot option. Patch initially written by oej, brought up
	  to date and finalized by mvanbaak, and then stabilized and
	  converted to astobj2 by me.

2008-04-21 22:50 +0000 [r114456]  Doug Bailey <dbailey@digium.com>

	* phoneprov/polycom.xml: Change the time zone offset from a hard
	  code to use res_phoneprov variables

2008-04-21 21:13 +0000 [r114423]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-vtest17, main/ast_expr2.y,
	  doc/tex/channelvariables.tex, doc/tex/ael.tex, CHANGES,
	  pbx/ael/ael-test/ael-ntest24/extensions.ael (added),
	  pbx/ael/ael-test/ref.ael-test18, pbx/ael/ael-test/ael-ntest24
	  (added), pbx/ael/ael-test/ref.ael-test19, main/ast_expr2.c,
	  pbx/ael/ael-test/ref.ael-ntest10, main/ast_expr2.h,
	  pbx/ael/ael-test/ref.ael-test1, main/ast_expr2f.c,
	  pbx/ael/ael-test/ref.ael-test3, pbx/ael/ael-test/ref.ael-ntest24
	  (added), pbx/ael/ael-test/ref.ael-test5,
	  pbx/ael/ael-test/ref.ael-test8, pbx/ael/ael-test/ref.ael-vtest13,
	  main/ast_expr2.fl: (closes issue #12467) Reported by: atis Tested
	  by: murf This upgrade adds the ~~ (concatenation) string operator
	  to expr2. While not needed in normal runtime pbx operation, it is
	  needed when raw exprs are being syntax checked. This plays into
	  future syntax- unification plans. By permission of atis, this
	  addition in trunk and the reason of why things are as they are
	  will suffice to close this bug. I also added a short note about
	  the previous addition of "sip show sched" to the CLI in CHANGES,
	  which I discovered I forgot in a previous commit.

2008-04-21 18:44 +0000 [r114389]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Add support for generic name transmission
	  (#12484) on SS7 in chan_zap

2008-04-21 15:34 +0000 [r114327]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_authenticate.c: This removes an invalid warning message
	  for an incorrectly entered pin, but more importantly removes an
	  inapplicable check. If the first argument passed to
	  app_authenticate does not contain a '/', the argument should be
	  treated as the sole fixed "password" to match against and that is
	  all. (Previous behavior was attempting to open a file based on
	  the pin.)

2008-04-21 15:01 +0000 [r114325]  Russell Bryant <russell@digium.com>

	* doc/janitor-projects.txt: Add a simple janitor project

2008-04-21 14:40 +0000 [r114320-114323]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 114322 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114322 | file | 2008-04-21 11:39:32 -0300 (Mon, 21 Apr 2008) | 4
	  lines Only drop audio if we receive it without a progress
	  indication. We allow other frames through such as DTMF because
	  they may be needed to complete the call. (closes issue #12440)
	  Reported by: aragon ........

	* res/res_config_ldap.c: Only print out the error message if
	  ldap_modify_ext_s actually returns an error, and not success.
	  (closes issue #12438) Reported by: gservat Patches:
	  res_config_ldap.c-patch-code uploaded by gservat (license 466)

2008-04-20 14:52 +0000 [r114314]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_pgsql.c: Minor logging cleanups

2008-04-19 16:58 +0000 [r114303]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: SS7:Added - Generic Name / Access Transport
	  / Redirecting Number handling. #12425

2008-04-19 00:15 +0000 [r114295]  Sean Bright <sean.bright@gmail.com>

	* utils: Ignore refcounter

2008-04-18 21:51 +0000 [r114276-114285]  Russell Bryant <russell@digium.com>

	* main/manager.c, /: Merged revisions 114284 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114284 | russell | 2008-04-18 16:48:06 -0500 (Fri, 18 Apr 2008)
	  | 2 lines Don't destroy a manager session if poll() returns an
	  error of EAGAIN. ........

	* Makefile, /: Merged revisions 114278 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114278 | russell | 2008-04-18 15:01:09 -0500 (Fri, 18 Apr 2008)
	  | 2 lines ensure directories are created before we try to install
	  stuff into them ........

	* Makefile, /: Merged revisions 114275 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114275 | russell | 2008-04-18 14:58:55 -0500 (Fri, 18 Apr 2008)
	  | 2 lines SUBDIRS_INSTALL is already listed as a subtarget for
	  bininstall ........

2008-04-18 19:35 +0000 [r114261-114271]  Joshua Colp <jcolp@digium.com>

	* channels/chan_unistim.c: Make sure ADSI is marked as unavailable
	  on Unistim channels so voicemail does not try to do some ADSI
	  jazz. (closes issue #12460) Reported by: PerryB

	* apps/app_meetme.c, CHANGES: Add MEETME_INFO dialplan function
	  that allows querying various properties of a Meetme conference.
	  (closes issue #11691) Reported by: junky Patches:
	  meetme_info.patch uploaded by jpeeler (license 325)

2008-04-18 18:03 +0000 [r114259]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_zap.c, /, main/callerid.c: Merged revisions 114257
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114257 | mmichelson | 2008-04-18 12:44:29 -0500 (Fri, 18 Apr
	  2008) | 6 lines Clearing up error messages so they make a bit
	  more sense. Also removing a redundant error message. Issue AST-15
	  ........

2008-04-18 16:11 +0000 [r114254]  Joshua Colp <jcolp@digium.com>

	* res/res_config_ldap.c: If the parsing of the config file fails
	  make sure we unlock ldap_lock. (closes issue #12477) Reported by:
	  IgorG

2008-04-18 16:05 +0000 [r114253]  Doug Bailey <dbailey@digium.com>

	* res/res_http_post.c: Add g__object_unref to clean up gmime
	  message object

2008-04-18 13:38 +0000 [r114246]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_sip.c: Merged revisions 114245 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114245 | seanbright | 2008-04-18 09:33:32 -0400 (Fri, 18 Apr
	  2008) | 1 line Only complete the SIP channel name once for 'sip
	  show channel <channel>' ........

2008-04-18 06:53 +0000 [r114243]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_setcallerid.c, /: Merged revisions 114242 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114242 | tilghman | 2008-04-18 01:49:16 -0500 (Fri, 18
	  Apr 2008) | 3 lines For consistency sake, ensure that the values
	  that ${CALLINGPRES} returns are valid as an input to
	  SetCallingPres. (Closes issue #12472) ........

2008-04-17 22:24 +0000 [r114231-114233]  Russell Bryant <russell@digium.com>

	* main/autoservice.c, /: Merged revisions 114230 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114230 | russell | 2008-04-17 17:15:43 -0500 (Thu, 17 Apr 2008)
	  | 6 lines Remove redundant safety net. The check for the
	  autoservice channel list state accomplishes the same goal in a
	  better way. (issue #12470) Reported By: atis ........

	* main/utils.c: Make this file compile. The variable str is never
	  set anywhere. Furthermore, it duplicates a lot of code. I will
	  leave it to murf to clean up.

2008-04-17 21:09 +0000 [r114229]  Jeff Peeler <jpeeler@digium.com>

	* CHANGES: added info describing DNS manager

2008-04-17 21:04 +0000 [r114208-114227]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 114226 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114226 | mmichelson | 2008-04-17 16:03:29 -0500 (Thu, 17 Apr
	  2008) | 9 lines Declaration of the peer channel in this scope was
	  making it so the peer variable defined in the outer scope was
	  never set properly, therefore making iterating through the
	  channel list always restart from the beginning. This bug would
	  have affected anyone who called chanspy without specifying a
	  first argument. (closes issue #12461) Reported by: stever28
	  ........

	* main/frame.c, /, include/asterisk/dsp.h,
	  include/asterisk/frame.h, main/dsp.c: Merged revisions 114207 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114207 | mmichelson | 2008-04-17 11:28:03 -0500 (Thu, 17 Apr
	  2008) | 12 lines It was possible for a reference to a frame which
	  was part of a freed DSP to still be referenced, leading to memory
	  corruption and eventual crashes. This code change ensures that
	  the dsp is freed when we are finished with the frame. This change
	  is very similar to a change Russell made with translators back a
	  month or so ago. (closes issue #11999) Reported by: destiny6628
	  Patches: 11999.patch uploaded by putnopvut (license 60) Tested
	  by: destiny6628, victoryure ........

2008-04-17 16:25 +0000 [r114205]  Russell Bryant <russell@digium.com>

	* Makefile, /: Merged revisions 114204 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114204 | russell | 2008-04-17 11:23:45 -0500 (Thu, 17 Apr 2008)
	  | 3 lines Fix the bininstall target to install from subdirs, as
	  well. (closes issue AST-8, patch from bmd at switchvox) ........

2008-04-17 15:12 +0000 [r114202]  Tilghman Lesher <tlesher@digium.com>

	* doc/CODING-GUIDELINES: fileio.h does not exist; io.h does,
	  though.

2008-04-17 14:45 +0000 [r114201]  Steve Murphy <murf@digium.com>

	* channels/chan_sip.c: Thanks to snuff for finding these omissions

2008-04-17 13:46 +0000 [r114199]  Philippe Sultan <philippe.sultan@gmail.com>

	* /, res/res_jabber.c: Merged revisions 114198 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114198 | phsultan | 2008-04-17 15:42:23 +0200 (Thu, 17 Apr 2008)
	  | 2 lines Use keepalives effectively in order diagnose bug
	  #12432. ........

2008-04-17 12:59 +0000 [r114196]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_agi.c: Merged revisions 114195 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114195 | tilghman | 2008-04-17 07:56:38 -0500 (Thu, 17 Apr 2008)
	  | 8 lines Add special case for when the agi cannot be executed,
	  to comply with the documentation that we return failure in that
	  case. (closes issue #12462) Reported by: fmueller Patches:
	  20080416__bug12462.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: fmueller ........

2008-04-17 12:25 +0000 [r114192-114194]  Sean Bright <sean.bright@gmail.com>

	* CHANGES: Update the CHANGES file with yesterday's ChanSpy change.
	  Sorry Kevin, just saw your e-mail.

	* /, apps/app_chanspy.c: Merged revisions 114191 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114191 | seanbright | 2008-04-17 06:51:20 -0400 (Thu, 17 Apr
	  2008) | 1 line Make sure we have enough room for the recording's
	  filename. ........

2008-04-16 23:53 +0000 [r114190]  Steve Murphy <murf@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES,
	  doc/chan_sip-perf-testing.txt (added): This is the scariest
	  commit I've done in a long time. This is the astobj2-ification of
	  chan_sip. I've tested a number of scenarios like crazy. It used
	  to have 4x the call setup/teardown performance of trunk, but now
	  it's roughly at parity. I will attempt to find the bottlenecks
	  and get it back to the 4x mark. The changes made were somewhat
	  invasive, but the value to the community of these upgrades
	  outweighs waiting further for more testing. Every change being
	  made to chan_sip was lousing this code up when we tried to merge.
	  Peers, Users, Dialogs, are all now astobj2 objects, indexed via
	  hashtables. Refcounting is used to track objects and free them at
	  the bitter end of their lives. Please file issues on
	  bugs.digium.com, and PLEASE, please, please be patient. One
	  natural advantage to all the hash-table work is that loading
	  large sip.conf files full of thousands of peers now goes much
	  faster. One more please: PLEASE help thrash this code and test
	  it.

2008-04-16 22:57 +0000 [r114188]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/logger.h, apps/app_nbscat.c,
	  include/asterisk/app.h, apps/app_festival.c, apps/app_mp3.c,
	  res/res_agi.c, apps/app_zapras.c, main/logger.c, main/app.c,
	  apps/app_externalivr.c, apps/app_ices.c, res/res_musiconhold.c,
	  main/asterisk.c: Standardized routines for forking processes
	  (keeps all the specialized code in one place).

2008-04-16 20:54 +0000 [r114187]  Steve Murphy <murf@digium.com>

	* main/utils.c, include/asterisk/lock.h: A small enhancement-- I
	  added the routine log_show_lock to utils.c, which if the
	  mentioned lock has been acquired, this routine will log to the
	  console the normal info about that lock you'd see from the CLI
	  when you do a 'core show locks'. It's solely for debug-- if the
	  lock is NOT acquired, there is no output. I use it to show
	  'unexpected' locks, to see where/why a lock is pre-locked. This
	  command is to be called from points of interest, like just before
	  a trylock, and helps to spot fleeting, highly temporal locks that
	  normally are not locked...

2008-04-16 20:47 +0000 [r114185]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c, /: Merged revisions 114184 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114184 | kpfleming | 2008-04-16 15:46:38 -0500 (Wed, 16 Apr
	  2008) | 6 lines use the ZT_SET_DIALPARAMS ioctl properly by
	  initializing the structure to all zeroes in case it contains
	  fields that we don't write values into (which it does as of
	  Zaptel 1.4.10) (closes issue #12456) Reported by: fnordian
	  ........

2008-04-16 20:28 +0000 [r114172-114183]  Steve Murphy <murf@digium.com>

	* main/event.c: Introducing a small optimization to
	  event_unsubscribe; events now use a Doubly-Linked list for
	  events, gives fast deletions, for the sake of channel driver mwi
	  events. From team/murf/bug11210.

	* include/asterisk/sched.h, CHANGES, main/sched.c: Introducing a
	  small upgrade to the ast_sched_xxx facility, to keep it from
	  eating up lots of cpu cycles. See CHANGES. From the
	  team/murf/bug11210 branch.

	* utils/Makefile, utils/refcounter.c (added),
	  include/asterisk/astobj2.h, CHANGES, main/astobj2.c: Introducing
	  various astobj2 enhancements, chief being a refcount tracing
	  feature, and various documentation updates in astobj2.h, and the
	  addition of standalone utility, refcounter, that will filter the
	  trace output for unbalanced, unfreed objects. This comes from the
	  team/murf/bug11210 branch.

	* tests/test_dlinklists.c (added), include/asterisk/dlinkedlists.h
	  (added), CHANGES: Introducing doubly linked lists to trunk from
	  branch team/murf/bug11210.

2008-04-16 12:23 +0000 [r114165]  Sean Bright <sean.bright@gmail.com>

	* apps/app_chanspy.c: Add the ability to disable channel technology
	  name playback when speaking the current channel name

2008-04-15 20:51 +0000 [r114152]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_pgsql.c: Oops, buffer wasn't long enough for query

2008-04-15 20:39 +0000 [r114150-114151]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 114148 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114148 | oej | 2008-04-15 22:26:05 +0200 (Tis, 15 Apr 2008) | 2
	  lines Handle subscribe queues in all situations... Thanks to
	  festr_ on irc for telling me about this bug. ........

	* channels/chan_sip.c: Adding chanvar to SIPPEER from 1.4 branch

2008-04-15 20:27 +0000 [r114149]  Jason Parker <jparker@digium.com>

	* apps/app_directory.c: If somebody enters a digit during
	  ast_stream_and_wait, the return value is the digit, which we need
	  to use later.

2008-04-15 19:59 +0000 [r114146]  Steve Murphy <murf@digium.com>

	* main/pbx.c: These changes: a. fix a self-found problem with
	  SPAWN-ing an extension, where matches were not being found b.
	  correct some wording in a comment c. Add some debug for future
	  debugging.

2008-04-15 17:54 +0000 [r114143]  Sean Bright <sean.bright@gmail.com>

	* apps/app_chanspy.c: I'm not sure why, but "this" bothers me. Ba
	  dum dum.

2008-04-15 17:21 +0000 [r114131-114141]  Jason Parker <jparker@digium.com>

	* channels/chan_unistim.c: Shorten the mac address pattern, since
	  some phones use different identifiers (such as the i2050
	  softphone). (closes issue #12398) Reported by: c_hans Patches:
	  chan_unistim_svn.diff uploaded by c (license 460) Tested by:
	  c_hans

	* /, contrib/scripts/autosupport: Merged revisions 114138 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114138 | qwell | 2008-04-15 12:17:18 -0500 (Tue, 15 Apr 2008) |
	  7 lines Update Digium autosupport script, for more useful
	  information. (closes issue #12452) Reported by: angler Patches:
	  autosupport.diff uploaded by angler (license 106) ........

	* /, apps/app_queue.c: Merged revisions 114133 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114133 | qwell | 2008-04-15 11:18:08 -0500 (Tue, 15 Apr 2008) |
	  8 lines Allow autofill to work in the general section of
	  queues.conf. Additionally, don't try to (re)set options when they
	  have empty values in realtime (all unset columns would have an
	  empty value). (closes issue #12445) Reported by: atis Patches:
	  12445-autofill.diff uploaded by qwell (license 4) ........

	* main/channel.c: Convert several DEBUG logs into ast_debug.
	  (closes issue #12444) Reported by: IgorG Patches:
	  channel_c_debug.diff uploaded by IgorG (license 20)

2008-04-14 19:58 +0000 [r114124-114127]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c: Need a new buffer for each loop

	* res/res_phoneprov.c: Don't unref user twice on failure. Also,
	  when adding sorted list of users, it is best to check the entry
	  already in the list for a "next" entry instead of the newly
	  created entry...

2008-04-14 18:34 +0000 [r114121]  Jason Parker <jparker@digium.com>

	* /, channels/chan_h323.c: Merged revisions 114120 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114120 | qwell | 2008-04-14 13:31:57 -0500 (Mon, 14 Apr
	  2008) | 7 lines The call_token on the pvt can occasionally be
	  NULL, causing a crash. If it is NULL, we can skip this channel,
	  since it can't the one we're looking for. (closes issue #9299)
	  Reported by: vazir ........

2008-04-14 17:42 +0000 [r114118]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c, /: Merged revisions 114117 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114117 | mmichelson | 2008-04-14 12:41:03 -0500 (Mon, 14 Apr
	  2008) | 11 lines Increase the retry count when attempting to show
	  channels. This apparently cleared an issue someone was seeing
	  when attempting to show channels when the load was high. (closes
	  issue #11667) Reported by: falves11 Patches: 11677.txt uploaded
	  by russell (license 2) Tested by: falves11 ........

2008-04-14 16:32 +0000 [r114115]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/astcli: Make tab-completion work for all cases

2008-04-14 16:25 +0000 [r114113]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c, /, apps/app_queue.c: Merged revisions 114112 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114112 | mmichelson | 2008-04-14 11:24:22 -0500 (Mon, 14 Apr
	  2008) | 9 lines If the datastore has been moved to another
	  channel due to a masquerade, then freeing the datastore here
	  causes an eventual double free when the new channel hangs up. We
	  should only free the datastore if we were able to successfully
	  remove it from the channel we are referencing (i.e. the datastore
	  was not moved). (closes issue #12359) Reported by: pguido
	  ........

2008-04-14 15:36 +0000 [r114109]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c: During hangup it is possible for p->chan
	  or p->owner to be NULL, so just return what the channel is
	  bridged to instead of what they are *really* bridged to. Thanks
	  Matt Nicholson!

2008-04-14 15:01 +0000 [r114107]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c, /: Merged revisions 114106 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114106 | mmichelson | 2008-04-14 09:58:02 -0500 (Mon, 14 Apr
	  2008) | 5 lines Save a local copy of the generate callback prior
	  to unlocking the channel in case the generate callback goes NULL
	  on us after the channel is unlocked. Thanks to Russell for
	  pointing this need out to me. ........

2008-04-14 14:53 +0000 [r114101-114104]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 114103 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114103 | file | 2008-04-14 11:52:46 -0300 (Mon, 14 Apr 2008) | 4
	  lines It is possible for the remote side to say they want T38 but
	  not give any capabilities. (closes issue #12414) Reported by: MVF
	  ........

	* /, main/rtp.c: Merged revisions 114100 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114100 | file | 2008-04-14 10:52:49 -0300 (Mon, 14 Apr 2008) | 4
	  lines Don't change the SSRC when a new source comes into play,
	  this might happen quite often and depending on the remote side...
	  they might not like this. (closes issue #12353) Reported by:
	  dimas ........

2008-04-14 02:55 +0000 [r114096-114098]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/astcli: Add tab command-line completion (Closes
	  issue #12428)

	* apps/app_meetme.c: Use ast_mkdir instead of mkdir (Closes issue
	  #12430)

2008-04-12 16:21 +0000 [r114092-114093]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Make sure linkset is locked exiting
	  ss7_start_call

	* channels/chan_zap.c: Make sure we start incoming calls on SS7
	  with echo cancellation enabled. Also make sure when completing a
	  COT we call ss7_start_call with the proper locks held. Lastly,
	  make sure if we fail to get a channel from zt_new that we don't
	  assume it's there.

2008-04-11 23:26 +0000 [r114085-114090]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_pgsql.c: If any field is not null, but has no default,
	  then it must be set or the insert will fail. (Closes issue
	  #12285)

	* configs/res_ldap.conf.sample: Make the sample config match the
	  contributed LDAP schema (Closes issue #12421)

	* res/res_config_ldap.c: Use the correct function for free'ing
	  objects, and maybe we won't crash. (closes issue #12163) Reported
	  by: gservat Patches: 20080411__bug12163.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: gservat

2008-04-11 22:48 +0000 [r114080-114084]  Terry Wilson <twilson@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 114083 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r114083 | twilson | 2008-04-11 17:32:51 -0500 (Fri, 11
	  Apr 2008) | 7 lines Several places in the code called
	  find_callno() (which releases the lock on the pvt structure) and
	  then immediately locked the call and did things with it.
	  Unfortunately, the call can disappear between the find_callno and
	  the lock, causing Bad Stuff(tm) to happen. Added
	  find_callno_locked() function to return the callno withtout
	  unlocking for instances that it is needed. (issue #12400)
	  Reported by: ztel ........

	* res/res_phoneprov.c: Make sure that ${LINE} is set even if
	  linenumber is not set in users.conf

2008-04-11 22:09 +0000 [r114077]  Doug Bailey <dbailey@digium.com>

	* phoneprov/polycom_line.xml: Change the number of line keys per
	  registration from 2 to 1

2008-04-11 21:04 +0000 [r114067]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c: Fix the fact that global_variables 1)
	  weren't being updated on reload (thanks for the report, Doug),
	  and 2) weren't actually being appended to the list of profile
	  variables because build_profile was called before the list was
	  populated. Also needed to free the contents returned by
	  load_file().

2008-04-11 15:49 +0000 [r114064]  Mark Michelson <mmichelson@digium.com>

	* /, main/features.c: Merged revisions 114063 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114063 | mmichelson | 2008-04-11 10:44:28 -0500 (Fri, 11 Apr
	  2008) | 11 lines Fix a race condition that may happen between a
	  sip hangup and a "core show channel" command. This patch adds
	  locking to prevent the resulting crash. (closes issue #12155)
	  Reported by: tsearle Patches: show_channels_crash2.patch uploaded
	  by tsearle (license 373) Tested by: tsearle ........

2008-04-11 14:54 +0000 [r114061]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_ldap.c: Errors are all greater than 0 (closes
	  issue #12422) Reported by: nito Patches:
	  res_config_ldap_result_check_patch.diff uploaded by nito (license
	  340)

2008-04-10 22:02 +0000 [r114052]  Mark Michelson <mmichelson@digium.com>

	* utils/Makefile, main/manager.c, /, utils/astman.c,
	  utils/hashtest.c, main/utils.c, include/asterisk/lock.h,
	  utils/ael_main.c, utils/hashtest2.c, utils/conf2ael.c,
	  utils/check_expr.c: Merged revisions 114051 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114051 | mmichelson | 2008-04-10 15:59:49 -0500 (Thu, 10 Apr
	  2008) | 3 lines Fix 1.4 build when LOW_MEMORY is enabled.
	  ........

2008-04-10 20:28 +0000 [r114049]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c, CHANGES: A 'b' option has been added which
	  causes chan_local to return the actual channel that is behind it
	  when queried. This is useful for transfer scenarios as the actual
	  channel will be transferred, not the Local channel. If you have
	  been using Local channels as queue members and having issues when
	  the agent did a blind transfer this option may solve the issue.

2008-04-10 19:58 +0000 [r114046]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 114045 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114045 | mmichelson | 2008-04-10 14:55:33 -0500 (Thu, 10 Apr
	  2008) | 6 lines Be sure that we're not about to set bridgepvt
	  NULL prior to dereferencing it. (closes issue #11775) Reported
	  by: fujin ........

2008-04-10 19:04 +0000 [r114042]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/astcli: The hydra grows yet another head...
	  (closes issue #12401) Reported by: davevg Patches: astcli.diff2
	  uploaded by davevg (license 209) Tested by: davevg, Corydon76

2008-04-10 17:27 +0000 [r114036]  Jason Parker <jparker@digium.com>

	* /, main/file.c: Merged revisions 114035 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114035 | qwell | 2008-04-10 12:26:10 -0500 (Thu, 10 Apr 2008) |
	  10 lines Only try to prefix language if we are not using an
	  absolute path (suffix it otherwise).
	  en/var/lib/asterisk/sounds/blah.gsm is a very silly path. (closes
	  issue #12379) Reported by: kuj Patches: 12379-absolutepath.diff
	  uploaded by qwell (license 4) Tested by: kuj, qwell ........

2008-04-10 15:10 +0000 [r114022-114030]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_meetme.c: Merged revisions 114029 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114029 | file | 2008-04-10 12:09:04 -0300 (Thu, 10 Apr 2008) | 6
	  lines Create the directory where name recordings will go if it
	  does not exist. (closes issue #12311) Reported by: rkeene
	  Patches: 12311-mkdir.diff uploaded by qwell (license 4) ........

	* apps/app_voicemail.c: Don't hardcode ru into the digits filename
	  so that languageprefix can work. (closes issue #12404) Reported
	  by: IgorG Patches: voicemail_ru_hardcoded-v1.patch uploaded by
	  IgorG (license 20)

	* channels/chan_unistim.c, channels/chan_skinny.c, main/rtp.c: Fix
	  spelling of existent in a few places. (closes issue #12409)
	  Reported by: candlerb

	* /, channels/chan_sip.c: Merged revisions 114021 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r114021 | file | 2008-04-10 10:27:11 -0300 (Thu, 10 Apr 2008) | 6
	  lines Don't add custom URI options if they don't exist OR they
	  are empty. (closes issue #12407) Reported by: homesick Patches:
	  uri_options-1.4.diff uploaded by homesick (license 91) ........

2008-04-09 22:32 +0000 [r113928-113980]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix a crash that happened due to accessing
	  free'd memory (closes issue #12396) Reported by: tcalosi Patches:
	  12396.patch uploaded by putnopvut (license 60) Tested by: tcalosi

	* /, channels/chan_sip.c: Merged revisions 113927 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113927 | mmichelson | 2008-04-09 15:54:31 -0500 (Wed, 09 Apr
	  2008) | 8 lines We need to set the persistant_route [sic]
	  parameter for the sip_pvt during the initial INVITE, no matter if
	  we're building the route set from an INVITE request or response.
	  (closes issue #12391) Reported by: benjaminbohlmann Tested by:
	  benjaminbohlmann ........

2008-04-09 19:00 +0000 [r113875]  Tilghman Lesher <tlesher@digium.com>

	* /, configs/cdr.conf.sample, cdr/cdr_csv.c: Merged revisions
	  113874 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113874 | tilghman | 2008-04-09 13:57:33 -0500 (Wed, 09 Apr 2008)
	  | 4 lines If the [csv] section does not exist in cdr.conf, then
	  an unload/load sequence is needed to correct the problem. Track
	  whether the load succeeded with a variable, so we can fix this
	  with a simple reload event, instead. ........

2008-04-09 18:05 +0000 [r113840]  Joshua Colp <jcolp@digium.com>

	* channels/chan_h323.c: Enable enough RTP bridging to allow P2P to
	  work. (closes issue #11901) Reported by: pj

2008-04-09 17:56 +0000 [r113838]  Jason Parker <jparker@digium.com>

	* contrib/scripts/astcli: Fix a small file handle "leak" pointed
	  out by jjshoe on #asterisk.

2008-04-09 17:48 +0000 [r113836]  Mark Michelson <mmichelson@digium.com>

	* main/pbx.c: There was a subtle logical difference between 1.4 and
	  trunk with regards to how timeouts were handled. In 1.4, if the
	  absolute timeout were reached on a call, no matter what the
	  return value of ast_spawn_extension was, the pbx would attempt to
	  go to the 'T' extension or hangup otherwise. The rearrangement of
	  this function in trunk made this check only happen in the case
	  that ast_spawn_extension returned 0. If ast_spawn_extension
	  returned 1, then the fact that the timeout expired resulted in a
	  no-op, and would cause an infinite loop to occur in
	  __ast_pbx_run. This change fixes this problem. Now timeouts will
	  behave as they did in 1.4 (closes issue #11550) Reported by: pj
	  Tested by: putnopvut

2008-04-09 17:41 +0000 [r113834]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Move all messages wrapped in skinnydebug
	  from debug to verbose. (closes issue #12224) Reported by: DEA
	  Patches: chan_skinny-debug-log.txt uploaded by DEA (license 3)

2008-04-09 16:52 +0000 [r113785]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 113784 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r113784 | file | 2008-04-09 13:50:45 -0300 (Wed, 09 Apr
	  2008) | 4 lines If we receive an AUTHREQ from the remote server
	  and we are unable to reply (for example they have a secret
	  configured, but we do not) then queue a hangup frame on the
	  Asterisk channel. This will cause the channel to hangup and a
	  HANGUP to be sent via IAX2 to the remote side which is the proper
	  thing to do in this scenario. (closes issue #12385) Reported by:
	  viraptor ........

2008-04-09 16:23 +0000 [r113731-113752]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: Mark recent additions from #11954 and #12254

	* configs/voicemail.conf.sample, apps/app_voicemail.c: Permit
	  message wrap-around during message retrieval. (closes issue
	  #12254) Reported by: andrew Patches: bug-12253.diff uploaded by
	  snuffy (license 35)

2008-04-09 14:41 +0000 [r113682]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 113681 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113681 | mmichelson | 2008-04-09 09:40:05 -0500 (Wed, 09 Apr
	  2008) | 9 lines If Asterisk receives a 488 on an INVITE (not a
	  reinvite), then we should not send a BYE. (closes issue #12392)
	  Reported by: fnordian Patches: chan_sip.patch uploaded by
	  fnordian (license 110) with small modification from me ........

2008-04-09 13:55 +0000 [r113647-113649]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c: Permit callee to continue in the dialplan, after
	  caller has hung up. (closes issue #11954) Reported by: johan
	  Patches: app_dial_rev104031.patch uploaded by johan (license 334)

	* contrib/scripts/astcli: Additional enhancements (closes issue
	  #12390) Reported by: tzafrir Patches: astcli_fixes.diff uploaded
	  by tzafrir (license 46)

2008-04-09 01:36 +0000 [r113597]  Terry Wilson <twilson@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 113596 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r113596 | twilson | 2008-04-08 20:34:25 -0500 (Tue, 08
	  Apr 2008) | 2 lines Initialize fr->cacheable to make valgrind
	  happy ........

2008-04-08 21:33 +0000 [r113559]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/astcli (added): Add commandline tool for doing
	  CLI commands through AMI (instead of using asterisk -rx) (closes
	  issue #12389) Reported by: davevg Patches: astcli uploaded by
	  davevg (license 209)

2008-04-08 18:49 +0000 [r113403-113505]  Jason Parker <jparker@digium.com>

	* /, channels/chan_skinny.c: Merged revisions 113504 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r113504 | qwell | 2008-04-08 13:48:55 -0500 (Tue, 08 Apr
	  2008) | 1 line Add a little more that is required for previously
	  added devices. ........

	* /, channels/chan_skinny.c: Merged revisions 113454 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r113454 | qwell | 2008-04-08 13:07:49 -0500 (Tue, 08 Apr
	  2008) | 4 lines Add support for several new(ish) devices - most
	  notably, 7942/7945, 7962/7965, 7975. Thanks to Greg Oliver for
	  providing me the required information. ........

	* main/features.c, include/asterisk/features.h: Move
	  AST_FEATURE_FLAG_* and FEATURE_RETURN_* to features.h so that
	  they can be used by modules. (closes issue #12384) Reported by:
	  fnordian Patches: features.patch uploaded by fnordian (license
	  110) (patch modified by me, to give FEATURE_RETURN_* an AST_
	  prefix)

	* /, main/asterisk.c: Merged revisions 113402 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113402 | qwell | 2008-04-08 11:56:52 -0500 (Tue, 08 Apr 2008) |
	  1 line Work around some silliness caused by sys/capability.h -
	  this should fix compile errors a number of users have been
	  experiencing. ........

2008-04-08 16:54 +0000 [r113349-113400]  Tilghman Lesher <tlesher@digium.com>

	* /, contrib/scripts/astgenkey.8: Merged revisions 113399 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113399 | tilghman | 2008-04-08 11:51:28 -0500 (Tue, 08 Apr 2008)
	  | 6 lines Add security note on astgenkey's manpage. (closes issue
	  #12373) Reported by: lmamane Patches: 20080406__bug12373.diff.txt
	  uploaded by Corydon76 (license 14) ........

	* /, channels/chan_sip.c: Merged revisions 113348 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113348 | tilghman | 2008-04-08 10:39:16 -0500 (Tue, 08 Apr 2008)
	  | 7 lines Move check for still-bridged channels out a little
	  further, to avoid possible deadlocks. (Closes issue #12252)
	  Reported by: callguy Patches: 20080319__bug12252.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: callguy ........

2008-04-08 15:05 +0000 [r113297]  Joshua Colp <jcolp@digium.com>

	* /, main/audiohook.c: Merged revisions 113296 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113296 | file | 2008-04-08 12:03:43 -0300 (Tue, 08 Apr 2008) | 4
	  lines If audio suddenly gets fed into one side of a channel after
	  a lapse of frames flush the other factory so that old audio does
	  not remain in the factory causing the sync code to not execute.
	  (closes issue #12296) Reported by: jvandal ........

2008-04-07 22:16 +0000 [r113245]  Tilghman Lesher <tlesher@digium.com>

	* configs/manager.conf.sample: Additional note

2008-04-07 21:49 +0000 [r113243]  Jason Parker <jparker@digium.com>

	* configs/manager.conf.sample: Document 'originate' permission in
	  manager sample config.

2008-04-07 21:35 +0000 [r113241]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_sip.c: Merged revisions 113013 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r113013 | jpeeler | 2008-04-07 10:18:10 -0500 (Mon, 07 Apr 2008)
	  | 15 lines Merged revisions 113012 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113012 | jpeeler | 2008-04-07 10:16:44 -0500 (Mon, 07 Apr 2008)
	  | 7 lines (closes issue #12362) (closes issue #12372) Reported
	  by: vinsik Tested by: tecnoxarxa This one line change makes an if
	  inside a for loop (in realtime_peer) check all the ast_variables
	  the loop was intending to test rather than just the first one.
	  ........ ................

2008-04-07 20:22 +0000 [r113207]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: This is a "fix" for something that's been
	  bugging the crap out of me for a while. The variable name "flag"
	  to distinguish between whether a message is being forwarded or is
	  new is not a helpful name. The newly added doxygen documentation
	  to app_voicemail is tremendously helpful, but I still just...hate
	  this variable name. I think is_new_message is more indicative of
	  what its purpose is.

2008-04-07 19:06 +0000 [r113172]  Tilghman Lesher <tlesher@digium.com>

	* /, funcs/func_strings.c: Merged revisions 113117 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r113117 | tilghman | 2008-04-07 12:51:49 -0500 (Mon, 07
	  Apr 2008) | 3 lines Force ast_mktime() to check for DST, since
	  strptime(3) does not. (Closes issue #12374) ........

2008-04-07 18:57 +0000 [r113170]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c: atoi(NULL) is bad

2008-04-07 18:02 +0000 [r113119]  Jason Parker <jparker@digium.com>

	* /, channels/chan_skinny.c, configs/skinny.conf.sample: Merged
	  revisions 113118 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113118 | qwell | 2008-04-07 13:00:09 -0500 (Mon, 07 Apr 2008) |
	  8 lines Allow playback with noanswer (and add earlyrtp option).
	  (closes issue #9077) Reported by: pj Patches: earlyrtp.diff
	  uploaded by wedhorn (license 30) Tested by: pj, qwell, DEA,
	  wedhorn ........

2008-04-07 16:12 +0000 [r113066]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c, /: Merged revisions 113065 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113065 | mmichelson | 2008-04-07 11:08:45 -0500 (Mon, 07 Apr
	  2008) | 13 lines This fix prevents a deadlock that was
	  experienced in chan_local. There was deadlock prevention in place
	  in chan_local, but it would not work in a specific case because
	  the channel was recursively locked. By unlocking the channel
	  prior to calling the generator's generate callback in
	  ast_read_generator_actions(), we prevent the recursive locking,
	  and therefore the deadlock. (closes issue #12307) Reported by:
	  callguy Patches: 12307.patch uploaded by putnopvut (license 60)
	  Tested by: callguy ........

2008-04-07 15:18 +0000 [r113013]  Jeff Peeler <jpeeler@digium.com>

	* /, channels/chan_sip.c: Merged revisions 113012 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r113012 | jpeeler | 2008-04-07 10:16:44 -0500 (Mon, 07 Apr 2008)
	  | 7 lines (closes issue #12362) (closes issue #12372) Reported
	  by: vinsik Tested by: tecnoxarxa This one line change makes an if
	  inside a for loop (in realtime_peer) check all the ast_variables
	  the loop was intending to test rather than just the first one.
	  ........

2008-04-07 14:54 +0000 [r113009]  Joshua Colp <jcolp@digium.com>

	* main/slinfactory.c, include/asterisk/slinfactory.h: Put my
	  slinfactory changes back in.

2008-04-05 13:24 +0000 [r112972]  Tilghman Lesher <tlesher@digium.com>

	* res/res_agi.c: AsyncAGI should not close the manager session on
	  error. (closes issue #12370) Reported by: srt Patches:
	  asterisk-12370.diff uploaded by srt (license 378)

2008-04-05 07:58 +0000 [r112906-112939]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c: Clean up some memory leak/ref counting
	  issues

	* phoneprov/000000000000-directory.xml, phoneprov/polycom.xml,
	  res/res_phoneprov.c, phoneprov/polycom_line.xml (added):
	  Multi-line support for phoneprov

2008-04-05 01:33 +0000 [r112874]  Steve Murphy <murf@digium.com>

	* channels/chan_sip.c: Found a little problem with the sip request
	  handling that could lead to a quick crash of asterisk, and a road
	  to a DOS attack if left unfixed. Attaching to a running asterisk
	  with "telnet hostname 5060", I would input "something", then hit
	  return three times, and asterisk crashes. I traced it to
	  handle_request_do(), which zeroes out the data (an ast_str ptr)
	  if the string is too short. Instead of freeing the struct and
	  nulling the pointer, it now just resets it, because this ast_str
	  is expected by the calling routine to still be there after
	  handle_request_do() returns. This appears to fix the crash. I
	  assume that it was introduced with ast_str's being adopted. It's
	  a subtle and easy-to-miss sort of problem. I also found all the
	  places where the req.data is freed, and made sure the ptr is
	  Nulled out as well; no good leaving bad ptrs laying around-- I
	  didn't need to do this, but it seemed a good thing to do...

2008-04-04 19:28 +0000 [r112785-112821]  Philippe Sultan <philippe.sultan@gmail.com>

	* /, channels/chan_gtalk.c: Merged revisions 112820 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r112820 | phsultan | 2008-04-04 21:26:15 +0200 (Fri, 04
	  Apr 2008) | 1 line Free newly allocated channel before returning
	  ........

	* /, channels/chan_gtalk.c: Merged revisions 112766 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r112766 | phsultan | 2008-04-04 19:16:59 +0200 (Fri, 04
	  Apr 2008) | 7 lines Prevent call connections when codecs don't
	  match. (closes issue #10604) Reported by: keepitcool Patches:
	  branch-1.4-10604-2.diff uploaded by phsultan (license 73) Tested
	  by: phsultan ........

2008-04-04 00:57 +0000 [r112714]  Dwayne M. Hubbard <dhubbard@digium.com>

	* main/asterisk.c: sleep long enough for the zaptel timer error
	  message to display before exit

2008-04-04 00:53 +0000 [r112712]  Joshua Colp <jcolp@digium.com>

	* /, main/Makefile: Merged revisions 112711 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r112711 | file | 2008-04-03 21:52:36 -0300 (Thu, 03 Apr 2008) | 2
	  lines Pass in the path to Zaptel for systems that install Zaptel
	  headers in a separate location. ........

2008-04-04 00:32 +0000 [r112653-112708]  Dwayne M. Hubbard <dhubbard@digium.com>

	* /: blocked for trunk....woot

	* main/asterisk.c: satisfy buildbot

	* main/asterisk.c: add a Zaptel timer check to verify the timer is
	  responding when Zaptel support is compiled into Asterisk and
	  Zaptel drivers are loaded. This will help people not waste their
	  valuable time debugging side effects.

2008-04-03 14:35 +0000 [r112600]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_zap.c, /: Merged revisions 112599 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r112599 | mmichelson | 2008-04-03 09:32:20 -0500 (Thu, 03 Apr
	  2008) | 9 lines Fix the testing of the "res" variable so that it
	  is more logically correct and makes the correct warning and debug
	  messages print. (closes issue #12361) Reported by: one47 Patches:
	  chan_zap_deferred_digit.patch uploaded by one47 (license 23)
	  ........

2008-04-03 07:49 +0000 [r112520-112564]  Tilghman Lesher <tlesher@digium.com>

	* formats/format_wav.c, main/file.c, include/asterisk/mod_format.h:
	  Use a 32k file buffer on recordings, which increases the
	  efficiency of file recording. (closes issue #11962) Reported by:
	  garlew Patches: recording.patch uploaded by garlew (license 376)
	  bug-11962.diff uploaded by snuffy (license 35)

	* channels/chan_misdn.c: Make MISDN generate channel rename events
	  when the name changes. (closes issue #11142) Reported by:
	  julianjm Patches: chan_misdn_tmpchan_trunk_v1.diff uploaded by
	  julianjm (license 99)

2008-04-02 17:36 +0000 [r112469]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c, /: Merged revisions 112468 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r112468 | mmichelson | 2008-04-02 12:36:04 -0500 (Wed, 02 Apr
	  2008) | 13 lines Fix a race condition in the manager. It is
	  possible that a new manager event could be appended during a
	  brief time when the manager is not waiting for input. If an event
	  comes during this period, we need to set an indicator that there
	  is an event pending so that the manager doesn't attempt to wait
	  forever for an event that already happened. (closes issue #12354)
	  Reported by: bamby Patches: manager_race_condition.diff uploaded
	  by bamby (license 430) (comments added by me) ........

2008-04-02 15:26 +0000 [r112431]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Since the SIP request structure gets reused
	  multiple times with TCP handling we have to clear the debug state
	  or else we will keep spitting out debug even after it has been
	  turned off. (closes issue #12169) Reported by: pj Patches:
	  12169-debugoff-2.diff uploaded by qwell (license 4) Tested by: pj

2008-04-02 15:25 +0000 [r112426]  Terry Wilson <twilson@digium.com>

	* build_tools/cflags.xml, include/asterisk/http.h, main/manager.c,
	  res/res_phoneprov.c, main/http.c, res/res_http_post.c (added):
	  Re-add HTTP post support by moving to res_http_post.c

2008-04-02 14:32 +0000 [r112394]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 112393 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r112393 | mmichelson | 2008-04-02 09:32:00 -0500 (Wed, 02 Apr
	  2008) | 6 lines Ensure that there is no timeout if none is
	  specified. (closes issue #12349) Reported by: johnlange ........

2008-04-01 22:55 +0000 [r112360]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_sip.c: Added dnsmgr status output for sip show
	  registry.

2008-04-01 22:45 +0000 [r112357]  Steve Murphy <murf@digium.com>

	* main/pbx.c: Bumped across another test set for the new exten
	  pattern matcher, which revealed a problem with the
	  CANMATCH/MATCHMORE modes. Direct matches were getting in the way.
	  Fixed.

2008-04-01 22:25 +0000 [r112351]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix a typo that prevented configuration of
	  non-dynamic peers.

2008-04-01 22:07 +0000 [r112321]  Jeff Peeler <jpeeler@digium.com>

	* CHANGES, channels/chan_iax2.c: Existing DNS manager lookups
	  extended to check for SRV records.

2008-04-01 20:02 +0000 [r112289]  Steve Murphy <murf@digium.com>

	* main/pbx.c: (closes issue #12298) Reported by: falves11 Patches:
	  12298.patch1 uploaded by murf (license 17) Tested by: murf I have
	  hopes that the changes made over the last few days will finalize
	  and solidify this code. While there are bound to be small tweaks
	  still needed, I feel that the job (at last) is somewhat
	  completed. Finally, I had a chance to comprehend how the scoring
	  of extension patterns was done in the previous version, and I've
	  come very close to using the exact same criteria in the new
	  pattern matching code. The left-right sorting is now replicated
	  in the trie structure itself, such that the first match found
	  will the 'best' match. Compared the results against 1.4 for
	  several extensions. Replicated falves11's setup and it works.
	  Used some devious patterns provided by jsmith, supplemented with
	  a few of my own. Looks good.

2008-04-01 18:27 +0000 [r112241-112252]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: Minor formatting cleanup. (closes issue
	  #12343) Reported by: travishein Patches:
	  app_voicemail_code_convention.patch uploaded by travishein
	  (license 385)

	* apps/app_voicemail.c: More voicemail doxygen additions/cleanup.
	  (issue #12343) Reported by: travishein Patches:
	  app_voicemail_code_documentation.patch uploaded by travishein
	  (license 385)

2008-04-01 18:23 +0000 [r112234]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_vpb.cc: Fix last commit

2008-04-01 18:06 +0000 [r112210]  Joshua Colp <jcolp@digium.com>

	* /, main/rtp.c: Merged revisions 112209 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r112209 | file | 2008-04-01 15:02:43 -0300 (Tue, 01 Apr 2008) | 4
	  lines Disable Packet2Packet bridging when we need to feed DTMF
	  frames into the core. Some implementations do not like how we
	  switch between things. (closes issue #12212) Reported by: bamby
	  ........

2008-04-01 17:53 +0000 [r112207]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_zap.c, main/dnsmgr.c, channels/chan_sip.c,
	  main/slinfactory.c, CHANGES, channels/chan_iax2.c,
	  include/asterisk/dnsmgr.h, include/asterisk/slinfactory.h: This
	  adds DNS SRV record support to DNS manager. If there is a SRV
	  record for a given domain, the hostname and port listed in the
	  SRV record will be used. If no SRV record exists or a SRV lookup
	  is not attempted, the DNS lookup on the specified domain will be
	  performed as normal. Chan_sip has been modified to take advantage
	  of the new SRV support.

2008-04-01 17:48 +0000 [r112155-112205]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 112204 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r112204 | file | 2008-04-01 14:43:46 -0300 (Tue, 01 Apr 2008) | 4
	  lines Do not pass audio until the remote side has indicated they
	  are providing early media, or if the channel has been answered.
	  (closes issue #11823) Reported by: SDamm ........

	* channels/chan_sip.c: Demote a log message down to a warning.
	  (closes issue #12345) Reported by: caio1982 Patches:
	  limit_msg.diff uploaded by caio1982 (license 22)

2008-04-01 17:23 +0000 [r112148]  Mark Michelson <mmichelson@digium.com>

	* /, main/dns.c: Merged revisions 112138 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r112138 | mmichelson | 2008-04-01 12:21:21 -0500 (Tue, 01 Apr
	  2008) | 10 lines Initialize the __res_state structure used for
	  dns purposes to all 0's prior to using it. This is due to
	  valgrind's complaints on issue #12284 as well as an excerpt found
	  in "Description" portion of the online man page found here:
	  http://www.iti.cs.tu-bs.de/cgi-bin/UNIXhelp/man-cgi?res_nquery+3RESOLV
	  (pertains to issue #12284 but does not necessarily close it)
	  ........

2008-04-01 16:50 +0000 [r112126]  Joshua Colp <jcolp@digium.com>

	* /, main/slinfactory.c, include/asterisk/slinfactory.h: Merged
	  revisions 112125 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r112125 | file | 2008-04-01 13:45:14 -0300 (Tue, 01 Apr 2008) | 5
	  lines Ensure that we do not exceed the hold's maximum size with a
	  single frame. (closes issue #12047) Reported by: fabianoheringer
	  Tested by: fabianoheringer ........

2008-04-01 16:35 +0000 [r112124]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c: Now that zaptel trunk has been removed, add
	  the PSTN deprecation notice to chan_zap, as well.

2008-03-31 22:16 +0000 [r112069-112071]  Jason Parker <jparker@digium.com>

	* channels/chan_usbradio.c: I missed a place when this define was
	  changed. (closes issue #12334) Reported by: ovi Patches:
	  12334-asterisk.patch uploaded by dimas (license 88)

	* /, apps/app_voicemail.c: Merged revisions 112068 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r112068 | qwell | 2008-03-31 16:48:05 -0500 (Mon, 31 Mar
	  2008) | 5 lines Fix a silly infinite loop when choosing an
	  invalid option. (closes issue #12315) Reported by: jmls ........

2008-03-31 21:01 +0000 [r112033-112035]  Terry Wilson <twilson@digium.com>

	* main/http.c: Yeah, simplify that logic a bit...

	* main/http.c: Handle blank prefix= in http.conf

2008-03-31 17:14 +0000 [r111996-111998]  Russell Bryant <russell@digium.com>

	* Makefile: Ensure configure gets run on a clean checkout. (closes
	  issue #12197) Reported by: juggie Patches: 12197.diff uploaded by
	  juggie (license 24)

	* channels/chan_sip.c: This fixes a high fence violation that
	  MALLOC_DEBUG reported to me.

2008-03-31 14:20 +0000 [r111961]  Joshua Colp <jcolp@digium.com>

	* res/res_config_sqlite.c: Initialize all these here tmp pointers
	  at declaration. They confused some compilers a wee bit. (closes
	  issue #12333) Reported by: ovi

2008-03-28 22:50 +0000 [r111908-111909]  Russell Bryant <russell@digium.com>

	* doc/janitor-projects.txt, include/asterisk/pbx.h: Make some notes
	  about common usage of pbx_builtin_getvar_helper() that is not
	  thread-safe.

	* main/dnsmgr.c: Note a minor race condition that I noticed while
	  reviewing Jeff's changes to this code.

2008-03-28 21:46 +0000 [r111857]  Jason Parker <jparker@digium.com>

	* codecs/gsm/inc/private.h, /: Merged revisions 111856 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r111856 | qwell | 2008-03-28 16:45:35 -0500 (Fri, 28 Mar
	  2008) | 12 lines Allow gsm to compile correctly on x86 with gcc4
	  optimizations. (closes issue #11243) Reported by: whiskerp
	  Patches: 11243-maybe-asm.diff uploaded by qwell (license 4)
	  Tested by: Seggy (IRC) Note: While I did write this patch, I
	  would not have found this if fossil had not reported and fixed
	  issue #12253. A huge thanks to him for helping to (indirectly)
	  find the problem here. ........

2008-03-28 20:03 +0000 [r111777-111811]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: This time the fix is proper for issue 12284.
	  I have tested it thoroughly and found that valgrind no longer
	  complains and that calls do complete correctly. The fix is along
	  the same lines as before: Make sure the final null terminator
	  gets copied into the new sip_request's data pointer. Without it,
	  parse_request will read and potentially write past the end of the
	  string, causing potential crashes. (closes issue #12284...for
	  real this time!) reported by falves11

	* channels/chan_sip.c, include/asterisk/strings.h: Temporary revert
	  of 111662. It's causing lots of trouble and appears to not be the
	  proper solution to the problem reported anyway. (related to issue
	  #12884)

2008-03-28 19:08 +0000 [r111721-111774]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: Replace magic number size from msgArray
	  array with a define. (same patch as before, I just split this
	  part out) (close issue #12326) Reported by: travishein Patches:
	  app_voicemail_code_documentation.patch uploaded by travishein
	  (license 385)

	* apps/app_voicemail.c: Add a bit of doxygen documentation for
	  app_voicemail. (issue #12326) Reported by: travishein Patches:
	  app_voicemail_code_documentation.patch uploaded by travishein
	  (license 385)

	* /, channels/chan_skinny.c: Merged revisions 111720 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r111720 | qwell | 2008-03-28 12:55:05 -0500 (Fri, 28 Mar
	  2008) | 1 line Remove unimplemented softkeys. Prompted by issue
	  #12325. ........

2008-03-28 16:36 +0000 [r111662]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c, include/asterisk/strings.h: The copy_request
	  function did not take into account the necessary null terminator
	  for the string to be copied into. This resulted in parse_request
	  reading invalid memory beyond the end of the string, and in some
	  cases led to crashes. Thanks to falves11 for providing the
	  valgrind output which led to the closure of this issue. (closes
	  issue #12284) Reported by: falves11

2008-03-28 16:20 +0000 [r111659]  Jason Parker <jparker@digium.com>

	* /, formats/format_wav_gsm.c: Merged revisions 111658 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r111658 | qwell | 2008-03-28 11:19:56 -0500 (Fri, 28 Mar
	  2008) | 8 lines The file size of WAV49 does not need to be an
	  even number. (closes issue #12128) Reported by: mdu113 Patches:
	  12128-noevenlength.diff uploaded by qwell (license 4) Tested by:
	  qwell, mdu113 ........

2008-03-28 14:37 +0000 [r111606]  Tilghman Lesher <tlesher@digium.com>

	* /, doc/valgrind.txt: Merged revisions 111605 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r111605 | tilghman | 2008-03-28 09:35:45 -0500 (Fri, 28 Mar 2008)
	  | 3 lines Update debugging text, since Valgrind eliminated the
	  --log-file-exactly option. (Closes issue #12320) ........

2008-03-28 00:55 +0000 [r111565]  Joshua Colp <jcolp@digium.com>

	* apps/app_queue.c: Forgetting to unregister a manager action is
	  bad, mmmk?

2008-03-28 00:12 +0000 [r111533]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix a crash that would happen when attempting
	  to unload the app_queue module. The problem was that when the
	  refcount on the queue hit 0, the destructor was called, and
	  inside the destructor, another function was called which would
	  increase the refcount back to 1 again and then decrease it again
	  back to 0 for every member in the queue. This meant that the
	  destructor was being recursively called, leading to a double free
	  of the queue. This is now fixed by making sure to unlink the
	  queue from the queues container prior to the final unref of the
	  queue.

2008-03-27 22:10 +0000 [r111500]  Terry Wilson <twilson@digium.com>

	* main/http.c: Fix another little http problem. In making it match
	  coding guidelines, a comparison was dropped

2008-03-27 21:25 +0000 [r111497]  Steve Murphy <murf@digium.com>

	* main/pbx.c: comment cleanup and iron out a really dumb mistake in
	  handling the '.'-wildcard in the new exten pattern matcher.

2008-03-27 19:26 +0000 [r111443]  Tilghman Lesher <tlesher@digium.com>

	* /, main/acl.c: Merged revisions 111442 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r111442 | tilghman | 2008-03-27 14:23:12 -0500 (Thu, 27 Mar 2008)
	  | 6 lines For FreeBSD, at least, the ifa_addr element could be
	  NULL. (closes issue #12300) Reported by: festr Patches:
	  acl.c.patch uploaded by festr (license 443) ........

2008-03-27 13:29 +0000 [r111360-111410]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /, apps/app_playback.c: Merged revisions 111391 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r111391 | murf | 2008-03-27 07:03:28 -0600 (Thu, 27 Mar 2008) | 9
	  lines These small documentation updates made in response to a
	  query in asterisk-users, where a user was using Playback, but
	  needed the features of Background, and had no idea that
	  Background existed, or that it might provide the features he
	  needed. I thought the best way to avert these kinds of queries
	  was to provide "See Also" references in all three of
	  "Background", "Playback", "WaitExten". Perhaps a project to do
	  this with all related apps is in order. ........

	* res/ael/pval.c, /, include/asterisk/pval.h, pbx/pbx_ael.c,
	  include/asterisk/ael_structs.h: Merged revisions 111341 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r111341 | murf | 2008-03-26 21:21:05 -0600 (Wed, 26 Mar 2008) |
	  15 lines (closes issue #12302) Reported by: pj Tested by: murf
	  These changes will set a channel variable ~~EXTEN~~ just before
	  generating code for a switch, with the value of ${EXTEN}. The
	  exten is marked as having a switch, and ever after that, till the
	  end of the exten, we substitute any ${EXTEN} with ${~~EXTEN~~}
	  instead in application arguments; (and the ${EXTEN: also). The
	  reason for this, is that because switches are coded using
	  separate extensions to provide pattern matching, and jumping
	  to/from these switch extensions messes up the ${EXTEN} value,
	  which blows the minds of users. ........

2008-03-27 00:27 +0000 [r111246-111295]  Jason Parker <jparker@digium.com>

	* main/frame.c: But we can change the API here.

	* main/frame.c, /: Merged revisions 111280 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r111280 | qwell | 2008-03-26 19:25:13 -0500 (Wed, 26 Mar 2008) |
	  1 line Put this flag back so we don't change the API. ........

	* main/frame.c, /: Merged revisions 111245 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r111245 | qwell | 2008-03-26 18:26:33 -0500 (Wed, 26 Mar 2008) |
	  9 lines Remove excessive smoother optimization that was causing
	  audio glitches (small "pops") after (about 200ms later) an
	  "incorrectly" sized frame was received. While it would be very
	  nice to keep this as optimized as possible, it makes no sense for
	  the smoother to be dropping random bits of audio like this. Isn't
	  that the whole point of a smoother? Closes issue #12093. ........

2008-03-26 21:23 +0000 [r111213]  Terry Wilson <twilson@digium.com>

	* main/http.c: Stupid strcasecmp function :-)

2008-03-26 20:34 +0000 [r111132-111185]  Tilghman Lesher <tlesher@digium.com>

	* channels/misdn_config.c: Oops, missed one

	* include/asterisk/linkedlists.h, main/config.c: Simplify new
	  macro, simplify configfile logic, now that list is sorted

2008-03-26 19:56 +0000 [r111130]  Joshua Colp <jcolp@digium.com>

	* /, contrib/scripts/autosupport: Merged revisions 111129 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r111129 | file | 2008-03-26 16:55:08 -0300 (Wed, 26 Mar 2008) | 6
	  lines Update autosupport script. (closes issue #12310) Reported
	  by: angler Patches: autosupport.diff uploaded by angler (license
	  106) ........

2008-03-26 19:52 +0000 [r111127]  Kevin P. Fleming <kpfleming@digium.com>

	* /, UPGRADE.txt: Merged revisions 111126 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r111126 | kpfleming | 2008-03-26 14:51:24 -0500
	  (Wed, 26 Mar 2008) | 10 lines Merged revisions 111125 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r111125 | kpfleming | 2008-03-26 14:49:30 -0500 (Wed, 26 Mar
	  2008) | 2 lines update UPGRADE notes to document usage of the
	  script ........ ................

2008-03-26 19:39 +0000 [r111123]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 111121 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r111121 | mmichelson | 2008-03-26 14:37:36 -0500 (Wed,
	  26 Mar 2008) | 4 lines This code change is made just for
	  clarification. It does exactly the same thing as before. It just
	  doesn't look as wrong. ........

2008-03-26 19:29 +0000 [r111083]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Add expiry value to the sip show
	  subscriptions CLI command. (closes issue #12025) Reported by: agx

2008-03-26 19:26 +0000 [r111067]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 111049 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r111049 | mmichelson | 2008-03-26 14:22:16 -0500 (Wed,
	  26 Mar 2008) | 9 lines Add a lock to the vm_state structure and
	  use the lock around mail_open calls to prevent concurrent access
	  of the same mailstream. This, along with trunk's ability to
	  configure TCP timeouts for IMAP storage will help to prevent
	  crashes and hangs when using voicemail with IMAP storage. (closes
	  issue #10487) Reported by: ewilhelmsen ........

2008-03-26 19:19 +0000 [r111036]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/linkedlists.h, CHANGES, main/config.c: Add a
	  linkedlist macro that maintains a sorted list

2008-03-26 19:16 +0000 [r111028]  Jason Parker <jparker@digium.com>

	* main/dsp.c: Only try to detect silence when we actually need to,
	  instead of...always. If this is wrong, I'd love to hear why.

2008-03-26 19:08 +0000 [r111025]  Kevin P. Fleming <kpfleming@digium.com>

	* /, contrib/scripts/get_ilbc_source.sh (added), codecs/ilbc:
	  Merged revisions 111024 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r111024 | kpfleming | 2008-03-26 14:06:56 -0500
	  (Wed, 26 Mar 2008) | 10 lines Merged revisions 111019 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r111019 | kpfleming | 2008-03-26 13:58:37 -0500 (Wed, 26 Mar
	  2008) | 2 lines add a script to make getting the iLBC source code
	  simple for end users ........ ................

2008-03-26 19:05 +0000 [r111022]  Jason Parker <jparker@digium.com>

	* channels/chan_usbradio.c, channels/chan_vpb.cc,
	  channels/chan_zap.c, include/asterisk/dsp.h, main/dsp.c: Large
	  cleanup of DSP code Per comments from dimas: 1. The code now
	  generates DTMF_BEGIN frames in addition to DTMF_END ones. 2.
	  "quelching" rewritten - now each detector (MF/DTMF/generic tone)
	  may mark fragment of a frame for suppression (squelching, muting)
	  with a call to mute_fragment. Actual muting happens only once at
	  the very end of ast_dsp_process where all marked fragments are
	  zeroed. This way every detector sees original data in the frame
	  without any piece of a frame being zeroed by a detector which was
	  run before. 3. DTMF detector tries to "mute" one block before and
	  one block after the block where actual tone was detected. Muting
	  of previois block is something new for this patch. Obviously this
	  operation is not always possible - if current frame does not
	  contain data for previous block - it is too late. But at least we
	  make our best. Muting of next block was already done by the old
	  code but it only affects part of the next block which is in the
	  frame being processed. New code keeps this information in state
	  structures so it will mute proper number of samples in the next
	  frame(s) too. 4. Removed ast_dsp_digitdetect and
	  ast_dsp_getdigits APIs because these are not used. 5. DSP API
	  extended a bit - ast_dsp_was_muted() function added which returns
	  true if DSP code was muting any fragment in the last frame.
	  chan_zap uses this function to decide it needs to turn on
	  confmute on the channel. This is to replace AST_FRAME_DTMF
	  'm'/'u' (mute/unmute) functionality. (closes issue #11968)
	  Reported by: dimas Patches: v2-11968-dsp.patch uploaded by dimas
	  (license 88) v4-11968-zap.patch uploaded by dimas (license 88)
	  Tested by: dimas, qwell

2008-03-26 19:05 +0000 [r111017-111021]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 111020 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r111020 | file | 2008-03-26 16:04:35 -0300 (Wed, 26 Mar 2008) | 4
	  lines If we are requested to authenticate a reinvite make sure
	  that it contains T38 SDP if need be. (closes issue #11995)
	  Reported by: fall ........

	* /, channels/chan_iax2.c: Merged revisions 110628 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r110628 | file | 2008-03-25 11:37:35 -0300 (Tue, 25 Mar
	  2008) | 4 lines Add an option (transmit_silence) which transmits
	  silence during both Record() and DTMF generation. The reason this
	  is an option is that in order to transmit silence we have to
	  setup a translation path. This may not be needed/wanted in all
	  cases. (closes issue #10058) Reported by: tracinet ........

2008-03-26 18:41 +0000 [r111012-111013]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: Oops, fix this, too

	* main/udptl.c, main/dnsmgr.c, include/asterisk/config.h,
	  channels/iax2-provision.c, main/enum.c, main/rtp.c,
	  main/config.c, main/loader.c, main/cdr.c, main/manager.c,
	  main/features.c, main/logger.c, main/http.c,
	  include/asterisk/udptl.h, main/asterisk.c, main/dsp.c: Add the
	  "config reload <conffile>" command, which allows you to tell
	  Asterisk to reload any file that references a given configuration
	  file.

2008-03-26 17:44 +0000 [r110963]  Kevin P. Fleming <kpfleming@digium.com>

	* /, UPGRADE.txt: Merged revisions 110962 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110962 | kpfleming | 2008-03-26 12:43:02 -0500 (Wed, 26 Mar
	  2008) | 2 lines add note that the user will need to enable
	  codec_ilbc to get it to build ........

2008-03-26 17:28 +0000 [r110911-110930]  Donny Kavanagh <donnyk@gmail.com>

	* Makefile: revert something dumb, because i was running svn diff
	  in a subfolder not the root of trunk, before doing my commit and
	  did not see it

	* Makefile, doc/snmp.txt: update documentation to reflect the
	  changes in the way configure detects net-snmp. (closes issue
	  #12067) Reported by: juggie Patches: 12067_snmp_doc.patch
	  uploaded by juggie (license 24) Tested by: juggie

2008-03-26 17:10 +0000 [r110881]  Kevin P. Fleming <kpfleming@digium.com>

	* codecs/ilbc/syntFilter.c (removed), /, codecs/ilbc/iCBConstruct.h
	  (removed), codecs/ilbc/syntFilter.h (removed),
	  codecs/ilbc/StateConstructW.c (removed), codecs/ilbc/packing.c
	  (removed), codecs/ilbc/StateConstructW.h (removed),
	  codecs/ilbc/libilbc.vcproj (removed), codecs/ilbc/packing.h
	  (removed), codecs/ilbc/getCBvec.c (removed),
	  codecs/ilbc/LPCdecode.c (removed), codecs/ilbc/enhancer.c
	  (removed), codecs/ilbc/lsf.c (removed), codecs/ilbc/iLBC_encode.c
	  (removed), codecs/ilbc/getCBvec.h (removed),
	  codecs/ilbc/LPCdecode.h (removed), codecs/ilbc/iLBC_define.h
	  (removed), codecs/ilbc/FrameClassify.c (removed),
	  codecs/ilbc/enhancer.h (removed), codecs/ilbc/lsf.h (removed),
	  codecs/ilbc/iLBC_encode.h (removed), codecs/ilbc/FrameClassify.h
	  (removed), codecs/ilbc/helpfun.c (removed), codecs/ilbc/doCPLC.c
	  (removed), codecs/ilbc/anaFilter.c (removed),
	  codecs/ilbc/helpfun.h (removed), codecs/ilbc/createCB.c
	  (removed), codecs/ilbc/doCPLC.h (removed),
	  codecs/ilbc/anaFilter.h (removed), UPGRADE.txt,
	  codecs/ilbc/iLBC_decode.c (removed), codecs/ilbc/constants.c
	  (removed), codecs/ilbc/createCB.h (removed), CHANGES,
	  codecs/ilbc/constants.h (removed), codecs/ilbc/iLBC_decode.h
	  (removed), codecs/ilbc/iCBSearch.c (removed), codecs/Makefile,
	  codecs/ilbc/filter.c (removed), codecs/ilbc/hpInput.c (removed),
	  codecs/ilbc/gainquant.c (removed), codecs/ilbc/hpOutput.c
	  (removed), codecs/ilbc/iCBSearch.h (removed),
	  codecs/ilbc/filter.h (removed), codecs/ilbc/hpInput.h (removed),
	  codecs/ilbc/gainquant.h (removed), codecs/ilbc/LPCencode.c
	  (removed), codecs/ilbc/hpOutput.h (removed),
	  codecs/ilbc/StateSearchW.c (removed), codecs/codec_ilbc.c,
	  codecs/ilbc/LPCencode.h (removed), codecs/ilbc/StateSearchW.h
	  (removed), codecs/ilbc/iCBConstruct.c (removed): Merged revisions
	  110880 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r110880 | kpfleming | 2008-03-26 09:42:35 -0700
	  (Wed, 26 Mar 2008) | 10 lines Merged revisions 110869 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r110869 | kpfleming | 2008-03-26 08:53:46 -0700 (Wed, 26 Mar
	  2008) | 2 lines due to licensing restrictions, we cannot
	  distribute the source code for iLBC encoding and decoding... so
	  remove it, and add instructions on how the user can obtain it
	  themselves ........ ................

2008-03-26 00:02 +0000 [r110831]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c: This ensures that the manager interface is not
	  enabled by default. Prior to this change, it was possible to
	  start Asterisk with the manager interface enabled, then either
	  comment out the enabled option or make manager.conf unopenable
	  and the manager interface would still be enabled.

2008-03-25 22:51 +0000 [r110780]  Jason Parker <jparker@digium.com>

	* /, cdr/cdr_custom.c: Merged revisions 110779 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110779 | qwell | 2008-03-25 17:51:17 -0500 (Tue, 25 Mar 2008) |
	  6 lines Make file access in cdr_custom similar to cdr_csv. Fixes
	  issue #12268. Patch borrowed from r82344 ........

2008-03-25 20:02 +0000 [r110726]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_sip.c: This one line change makes an if inside a
	  for loop (in realtime_peer) check all the ast_variables the loop
	  was intending to test rather than just the first one.

2008-03-25 17:46 +0000 [r110689-110691]  Tilghman Lesher <tlesher@digium.com>

	* configs/voicemail.conf.sample, configs/extensions.conf.sample:
	  Update sample configurations to make virtual hosting more
	  obvious. (closes issue #11969) Reported by: pprindeville Patches:
	  acme-virtualpbx.1.6.patch uploaded by pprindeville (license 347)

	* configs/extensions.conf.sample: Update the sample configuration,
	  to use Macro less (since it's now deprecated). (closes issue
	  #12293) Reported by: pprindeville Patches:
	  bugid-0012293.1.6.patch uploaded by pprindeville (license 347)

2008-03-25 15:44 +0000 [r110636-110639]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Oops here too. I need to stop coding for a
	  while...

	* /, channels/chan_sip.c: Merged revisions 110635 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110635 | mmichelson | 2008-03-25 10:40:33 -0500 (Tue, 25 Mar
	  2008) | 7 lines When reverting a commit, I accidentally left in
	  this bit which was an experiment to see what would happen. It
	  passed the compile test, and I didn't notice I had left this
	  change in too. So this is a revert of a revert...sort of.
	  ........

2008-03-25 15:18 +0000 [r110629-110631]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, channels/chan_sip.c, configs/sip.conf.sample,
	  CHANGES: Add a special dialplan variable to chan_sip which will
	  cause an audio file to be played upon completion of an attended
	  transfer. (closes issue #9239) Reported by: sunder

	* Makefile, /, main/app.c, include/asterisk/options.h,
	  main/asterisk.c: Merged revisions 110628 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110628 | file | 2008-03-25 11:37:35 -0300 (Tue, 25 Mar 2008) | 4
	  lines Add an option (transmit_silence) which transmits silence
	  during both Record() and DTMF generation. The reason this is an
	  option is that in order to transmit silence we have to setup a
	  translation path. This may not be needed/wanted in all cases.
	  (closes issue #10058) Reported by: tracinet ........

2008-03-25 10:54 +0000 [r110625]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Use the "Server" header when responding to
	  SIP requests. (closes issue #12278) Reported by: rjain Patches:
	  chan_sip.c.diff uploaded by rjain (license 226)

2008-03-24 20:14 +0000 [r110619-110621]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Remove the "Event: registration" header from
	  Asterisk-generated SIP REGISTER requests. rjain points out that
	  RFC 3265 specifies that the Event: header is not a valid header
	  for REGISTER requests and that the "registration" value is not
	  defined at IANA. (closes issue #12279) Reported by: rjain
	  Patches: chan_sip.c.diff uploaded by rjain (license 226)

	* channels/chan_sip.c: Merged revisions 110618 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110618 | mmichelson | 2008-03-24 14:17:41 -0500 (Mon, 24 Mar
	  2008) | 15 lines This is a revert for revision 108288. The reason
	  is that that revision was not for an actual bug fix per se, and
	  so it really should not have been in 1.4 in the first place.
	  Plus, people who compile with DO_CRASH are more likely to
	  encounter a crash due to this change. While I think the usage of
	  DO_CRASH in ast_sched_del is a bit absurd, this sort of change is
	  beyond the scope of 1.4 and should be done instead in a developer
	  branch based on trunk so that all scheduler functions are fixed
	  at once. I also am reverting the change to trunk and 1.6 since
	  they also suffer from the DO_CRASH potential. (closes issue
	  #12272) Reported by: qq12345 ........

2008-03-24 17:36 +0000 [r110615]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 110614 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r110614 | russell | 2008-03-24 12:34:56 -0500 (Mon, 24
	  Mar 2008) | 2 lines Turn a NOTICE into a DEBUG message. ........

2008-03-24 15:28 +0000 [r110610]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Only print out the set_address_from_contact
	  host verbose message if debugging is enabled on the dialog.
	  (closes issue #12280) Reported by: rjain Patches: chan_sip.c.diff
	  uploaded by rjain (license 226)

2008-03-21 21:52 +0000 [r110578]  Jason Parker <jparker@digium.com>

	* sounds/Makefile: Update to 1.4.11 core sounds.

2008-03-21 17:58 +0000 [r110542]  Joshua Colp <jcolp@digium.com>

	* include/asterisk/audiohook.h, main/audiohook.c: Merge over
	  ast_audiohook_volume branch. This adds API calls for use by
	  developers to adjust the volume on a channel.

2008-03-21 15:24 +0000 [r110499]  Russell Bryant <russell@digium.com>

	* configs/sip.conf.sample, CHANGES: Note that the TCP and TLS
	  support is currently considered experimental and is subject to
	  change while we work out the remaining issues.

2008-03-21 14:36 +0000 [r110475]  Jason Parker <jparker@digium.com>

	* /, codecs/gsm/Makefile: Merged revisions 110474 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110474 | qwell | 2008-03-21 09:32:52 -0500 (Fri, 21 Mar 2008) |
	  7 lines Don't attempt to do optimizations of gsm on mips
	  platforms either. (closes issue #12270) Reported by: zandbelt
	  Patches: 026-gsm-mips.patch uploaded by zandbelt (license 33)
	  ........

2008-03-21 01:44 +0000 [r110444]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: Add note of the added Directory options, from commit
	  110237 (closes issue #7151)

2008-03-20 23:14 +0000 [r110303-110396]  Russell Bryant <russell@digium.com>

	* main/autoservice.c, /: Merged revisions 110395 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110395 | russell | 2008-03-20 18:13:56 -0500 (Thu, 20 Mar 2008)
	  | 9 lines Shorten the ast_waitfor() timeout from 500 ms to 50 ms
	  in the autoservice thread. This really should not make a
	  difference except in very rare cases. That case would be that all
	  of the channels in autoservice are not generating any frames. In
	  that case, this change reduces the potential amount of time that
	  a thread waits in ast_autoservice_stop() for the autoservice
	  thread to wrap back around to the beginning of its loop. (closes
	  issue #12266, reported by dimas) ........

	* codecs/codec_g722.c: Use the correct buffer for
	  g722tolin16_sample. This shouldn't have caused any problems, but
	  Qwell noticed the typo here.

	* /, channels/chan_sip.c, channels/chan_iax2.c: Merged revisions
	  110336 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r110336 | russell | 2008-03-20 16:54:58 -0500
	  (Thu, 20 Mar 2008) | 14 lines Merged revisions 110335 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r110335 | russell | 2008-03-20 16:53:27 -0500 (Thu, 20 Mar 2008)
	  | 6 lines Fix some very broken code that was introduced in 1.2.26
	  as a part of the security fix. The dnsmgr is not appropriate
	  here. The dnsmgr takes a pointer to an address structure that a
	  background thread continuously updates. However, in these cases,
	  a stack variable was passed. That means that the dnsmgr thread
	  would be continuously writing to bogus memory. ........
	  ................

	* main/file.c: Fix a bug when using zaptel timing for playing back
	  files that have a sample rate other than 8 kHz. The issue here is
	  that format modules give a "whennext" sample value, which is used
	  to calculate when to set a timer for to retrieve the next frame.
	  However, the zaptel timer operates on 8 kHz samples, so this must
	  be taken into account. (another part of issue #12164, reported by
	  milazzo and jsmith, patch by me)

2008-03-20 18:01 +0000 [r110272]  Mark Michelson <mmichelson@digium.com>

	* main/dial.c: Add missing unlock

2008-03-20 17:45 +0000 [r110268-110270]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c, apps/app_minivm.c, include/asterisk/netsock.h,
	  main/netsock.c: Remove astobj.h from some places where it wasn't
	  needed

	* main/channel.c, res/res_musiconhold.c: Add some fixes that I made
	  in regards to wideband codec handling to get G.722 music on hold
	  working for me. (issue #12164, reported by milazzo and jsmith,
	  patches by me) res/res_musiconhold.c: - I moved a single line so
	  that the sample queue update happened before ast_write(). The
	  reason that this was a bug is that the G.722 frame originally
	  says it has 320 samples in it (which is correct). However, when
	  the frame is written to a channel that uses RTP, main/rtp.c
	  modifies the frame to cut the number of samples in half before it
	  sends it on the wire. This is to account for the stupid incorrect
	  G.722 spec that makes it so we have to lie about the number of
	  samples with RTP. I should probably go and re-work the RTP code
	  so it doesn't modify the frame so that a bug like this won't
	  happen in the future. However, this change to MOH is harmless.
	  main/channel.c: - I made two fixes in regards to generator
	  timing. Generators use samples for timing. However, this code
	  assumed 8 kHz samples. In one case, it was a hard coded 160
	  samples, that is now written as the sample rate / 50. The other
	  place was dealing with timing a generator based on frames coming
	  from the other direction. However, that would have only worked if
	  the sample rates for the formats in both directions were the
	  same. The code now takes into account that the sample rates may
	  differ, and scales the generator samples accordingly.

2008-03-20 05:06 +0000 [r110211-110237]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_directory.c, sounds/Makefile: Upgrade the sounds
	  version; add several directory enhancements: 1) Number of digits
	  to enter can now be configured 2) The digits can now match on
	  both first AND last name, instead of only one or the other
	  (Closes issue #7151)

	* channels/chan_vpb.cc: Fix recent trunk breakage

2008-03-19 22:58 +0000 [r110164]  Russell Bryant <russell@digium.com>

	* /, apps/app_meetme.c: Merged revisions 110163 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110163 | russell | 2008-03-19 17:57:59 -0500 (Wed, 19 Mar 2008)
	  | 5 lines Fix a bug where when calls on the trunk side hang up
	  while on hold, the state is not properly reflected. (closes issue
	  #11990, reported by anakaoka, patched by me) ........

2008-03-19 22:25 +0000 [r110132-110161]  Jason Parker <jparker@digium.com>

	* channels/chan_misdn.c, channels/chan_zap.c, channels/chan_sip.c,
	  channels/chan_h323.c, include/asterisk/dsp.h,
	  channels/chan_mgcp.c, main/dsp.c: Rename DSP_FEATURE_DTMF_DETECT,
	  because we are *NOT* only detecting DTMF digits. This was very
	  misleading. Early cleanup for issue #11968

	* channels/chan_usbradio.c, channels/chan_vpb.cc,
	  channels/chan_zap.c, channels/chan_sip.c, include/asterisk/dsp.h,
	  channels/chan_mgcp.c, main/dsp.c: Rename very poorly named
	  function to reflect what it actually does. This was causing quite
	  a bit of confusion for me...

2008-03-19 21:05 +0000 [r110087]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_sip.c, CHANGES: This change adds DNS manager
	  support for registrations not referencing a peer entry. It looks
	  like there is support for DNS manager for realtime peers as well,
	  however it is not implemented correctly. The improper usage
	  occurs when ast_dnsmgr_lookup is called with one of the arguments
	  being an address from the stack to be continually updated. The
	  variable from the stack will go out of scope and dnsmgr will
	  continue to try and update the memory there, causing possible
	  stack corruption. This problem will be worked on next as well as
	  adding DNS manager support for peer entries.

2008-03-19 20:34 +0000 [r110084]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 110083 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110083 | mmichelson | 2008-03-19 15:33:03 -0500 (Wed, 19 Mar
	  2008) | 4 lines Add a missing unlock in the case that memory
	  allocation fails in app_chanspy. Thanks to Russell for confirming
	  that this was an issue. ........

2008-03-19 19:13 +0000 [r110036]  Joshua Colp <jcolp@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 110035 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r110035 | file | 2008-03-19 16:11:33 -0300 (Wed, 19 Mar
	  2008) | 4 lines Add sanity checking for position resuming. We
	  *have* to make sure that the position does not exceed the total
	  number of files present, and we have to make sure that the
	  position's filename is the same as previous. These values can
	  change if a music class is reloaded and give unpredictable
	  behavior. (closes issue #11663) Reported by: junky ........

2008-03-19 18:57 +0000 [r110023]  Russell Bryant <russell@digium.com>

	* /: remove svnmerge-blocked property that is not supposed to be
	  here

2008-03-19 18:25 +0000 [r110020]  Joshua Colp <jcolp@digium.com>

	* /, main/rtp.c: Merged revisions 110019 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r110019 | file | 2008-03-19 15:20:28 -0300 (Wed, 19 Mar 2008) | 6
	  lines Make sure that the mark bit does not incorrectly cause
	  video frame timestamps to be calculated as if they are audio
	  frames. (closes issue #11429) Reported by: sperreault Patches:
	  11429-frametype.diff uploaded by qwell (license 4) ........

2008-03-19 17:15 +0000 [r109974]  Jason Parker <jparker@digium.com>

	* Makefile, build_tools/cflags.xml, build_tools/cflags-devmode.xml
	  (added), /: Merged revisions 109973 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109973 | qwell | 2008-03-19 12:12:52 -0500 (Wed, 19 Mar 2008) |
	  5 lines People report bugs about Asterisk crashing with DO_CRASH
	  enabled was getting a little silly... Now we only show certain
	  cflags when you run configure with --enable-dev-mode
	  (corresponding menuselect change to follow) ........

2008-03-19 16:54 +0000 [r109970]  Joshua Colp <jcolp@digium.com>

	* main/pbx.c, CHANGES: Add the ability to use a pattern match for a
	  hint. (closes issue #7767) Reported by: Corydon76 Patches:
	  20070314__simple_hint_lookup.diff.txt uploaded by Corydon76
	  pbx-trunk-98436.diff uploaded by plack (license 365)

2008-03-19 16:24 +0000 [r109942]  Steve Murphy <murf@digium.com>

	* /, main/config.c: Merged revisions 109908 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109908 | murf | 2008-03-19 09:41:13 -0600 (Wed, 19 Mar 2008) |
	  72 lines (closes issue #11442) Reported by: tzafrir Patches:
	  11442.patch uploaded by murf (license 17) Tested by: murf I
	  didn't give tzafrir very much time to test this, but if he does
	  still have remaining issues, he is welcome to re-open this bug,
	  and we'll do what is called for. I reproduced the problem, and
	  tested the fix, so I hope I am not jumping by just going ahead
	  and committing the fix. The problem was with what file_save does
	  with templates; firstly, it tended to print out multiple options:
	  [my_category](!)(templateref) instead of
	  [my_category](!,templateref) which is fixed by this patch.
	  Nextly, the code to suppress output of duplicate declarations
	  that would occur because the reader copies inherited declarations
	  down the hierarchy, was not working. Thus: [master-template](!)
	  mastervar = bar [template](!,master-template) tvar = value
	  [cat](template) catvar = val would be rewritten as: ;! ;!
	  Automatically generated configuration file ;! Filename:
	  experiment.conf (/etc/asterisk/experiment.conf) ;! Generator:
	  Manager ;! Creation Date: Tue Mar 18 23:17:46 2008 ;!
	  [master-template](!) mastervar = bar
	  [template](!,master-template) mastervar = bar tvar = value
	  [cat](template) mastervar = bar tvar = value catvar = val This
	  has been fixed. Since the config reader 'explodes' inherited vars
	  into the category, users may, in certain circumstances, see
	  output different from what they originally entered, but it should
	  be both correct and equivalent. ........

2008-03-19 16:21 +0000 [r109912-109926]  Kevin P. Fleming <kpfleming@digium.com>

	* res/res_phoneprov.c: ensure that res_phoneprov's HTTP handler
	  tells the dispatcher what method it can handle

	* main/manager.c, main/http.c: actually implement HTTP request
	  dispatching based on both URI and method; reduce duplication of
	  data when generating responses using ast_http_error()

2008-03-19 15:45 +0000 [r109910]  Russell Bryant <russell@digium.com>

	* main/pbx.c: Fix some more breakage that I introduced when
	  changing extension state callbacks to the list macros.

2008-03-19 15:41 +0000 [r109909]  Kevin P. Fleming <kpfleming@digium.com>

	* main/http.c: clean up code to conform to coding guidelines

2008-03-19 15:22 +0000 [r109833-109907]  Russell Bryant <russell@digium.com>

	* main/pbx.c: Remove an unneeded variable. This compiled, but I
	  missed the uninitialized warning because I always compile without
	  optimizations turned on. Sorry!

	* main/pbx.c: Convert handling of extension state callbacks to the
	  list macros.

	* main/pbx.c: Minor coding style changes, including adding handling
	  for memory allocation failure

	* main/http.c: Minor change to use Asterisk macros

	* /, main/utils.c: Merged revisions 109838 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109838 | russell | 2008-03-18 23:06:05 -0500 (Tue, 18 Mar 2008)
	  | 2 lines Tweak spacing in a recent change because I'm very
	  picky. ........

	* channels/chan_sip.c: Set req->data to NULL after free'ing to
	  ensure that it never gets accidentally double free'd. (reported
	  by dhubbard directly to me)

2008-03-18 23:32 +0000 [r109802]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_zap.c: Fix a typo which caused a double free in
	  chan_zap. This was discovered by Juggie while attempting to load
	  chan_zap. Apparently this would happen if an error were
	  encountered while trying to process zapata.conf.

2008-03-18 23:22 +0000 [r109775]  Tilghman Lesher <tlesher@digium.com>

	* configs/res_ldap.conf.sample, res/res_config_ldap.c: Change back
	  to using ldap_initialize() and let the user specify a URL
	  directly, instead of trying to piece it together, badly.

2008-03-18 22:36 +0000 [r109764]  Russell Bryant <russell@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 109763 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109763 | russell | 2008-03-18 17:34:42 -0500 (Tue, 18 Mar 2008)
	  | 3 lines Fix one place where the chanspy datastore isn't removed
	  from a channel. (issue #12243, reported by atis, patch by me)
	  ........

2008-03-18 22:32 +0000 [r109762]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/http.h, main/manager.c, res/res_phoneprov.c,
	  main/http.c, include/asterisk/_private.h: start the process of
	  changing HTTP request dispatching to do it based on *both* URI
	  and method, so that POST support can move into a module; move
	  http.c's private function prototypes into _private.h

2008-03-18 20:59 +0000 [r109714]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 109713 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109713 | mmichelson | 2008-03-18 15:52:15 -0500 (Tue, 18 Mar
	  2008) | 12 lines This patch makes it so that all queue member
	  status changes are handled through device state code. This
	  removes several problems people were seeing where their queue
	  members would get into an "unknown" state. Huge props go to atis
	  on this one since he was the one who found the code section that
	  was causing the problem and proposed the solution. I just wrote
	  what he suggested :) (closes issue #12127) Reported by: atis
	  Patches: 12127v3.patch uploaded by putnopvut (license 60) Tested
	  by: atis, jvandal ........

2008-03-18 20:13 +0000 [r109683]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_ldap.c: Set protocol version, port number
	  correctly. (closes issue #12211, closes issue #12209) Reported
	  by: sylvain

2008-03-18 20:02 +0000 [r109681]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Since a sip request's data field is now a
	  stringfield, we not only have to check if the string is
	  zero-length, but also if the data field is non-null. (closes
	  issue #12250) Reported by: caio1982

2008-03-18 19:53 +0000 [r109680]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/dbsep.cgi: Comment debug

2008-03-18 19:24 +0000 [r109651]  Jason Parker <jparker@digium.com>

	* /, codecs/log2comp.h: Merged revisions 109648 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109648 | qwell | 2008-03-18 14:23:44 -0500 (Tue, 18 Mar 2008) |
	  7 lines Allow codecs that use log2comp (g726) to compile
	  correctly on x86 with gcc4 optimizations. (closes issue #12253)
	  Reported by: fossil Patches: log2comp.patch uploaded by fossil
	  (license 140) ........

2008-03-18 18:58 +0000 [r109545-109621]  Mark Michelson <mmichelson@digium.com>

	* configs/queues.conf.sample, CHANGES, apps/app_queue.c: Add option
	  'randomperiodicannounce' to queues.conf. Setting this will allow
	  the list of periodic announcments specified to be played in a
	  random order instead of being played sequentially. (closes issue
	  #6681) Reported by: alt_phil Tested by: putnopvut

	* /, channels/chan_agent.c: Merged revisions 109575 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r109575 | mmichelson | 2008-03-18 12:58:11 -0500 (Tue,
	  18 Mar 2008) | 6 lines Make sure an agent doesn't try to send
	  dtmf to a NULL channel closes issue #12242 Reported by Yourname
	  ........

	* include/asterisk/astmm.h: Add format attribute to printf-style
	  functions in astmm.h

2008-03-18 16:23 +0000 [r109451-109475]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/misdn/isdn_lib.h, channels/chan_misdn.c,
	  channels/misdn/isdn_lib.c: fix up various warnings found via the
	  addition of format string checking... some of these were really,
	  really bad code

	* configure, include/asterisk/autoconfig.h.in, acinclude.m4: ensure
	  that dependencies on AST_C_DEFINE_CHECK symbols work properly

2008-03-18 15:43 +0000 [r109447]  Terry Wilson <twilson@digium.com>

	* include/asterisk/utils.h, cdr/cdr_sqlite3_custom.c,
	  apps/app_meetme.c, channels/chan_sip.c, apps/app_festival.c,
	  main/translate.c, res/res_phoneprov.c, main/jitterbuf.c,
	  utils/astman.c, main/utils.c, include/jitterbuf.h,
	  apps/app_queue.c, channels/chan_iax2.c, utils/frame.c,
	  main/cli.c, Makefile, funcs/func_enum.c, main/manager.c,
	  channels/chan_misdn.c, include/asterisk/astobj.h, res/res_agi.c,
	  main/features.c, apps/app_minivm.c, res/res_realtime.c,
	  utils/extconf.c, res/res_indications.c,
	  include/asterisk/strings.h, res/res_config_ldap.c,
	  main/asterisk.c, utils/check_expr.c, apps/app_voicemail.c: Go
	  through and fix a bunch of places where character strings were
	  being interpreted as format strings. Most of these changes are
	  solely to make compiling with -Wsecurity and -Wformat=2 happy,
	  and were not actual problems, per se. I also added format
	  attributes to any printf wrapper functions I found that didn't
	  have them. -Wsecurity and -Wmissing-format-attribute added to
	  --enable-dev-mode.

2008-03-18 15:13 +0000 [r109396]  Joshua Colp <jcolp@digium.com>

	* main/manager.c, main/logger.c: Make sure values are interpreted
	  as character strings and not format strings. (AST-2008-004)

2008-03-18 15:10 +0000 [r109394]  Jason Parker <jparker@digium.com>

	* /: Block this here. Already committed.

2008-03-18 15:08 +0000 [r109390]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c, main/rtp.c: Merged revisions 109386 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109386 | file | 2008-03-18 11:58:39 -0300 (Tue, 18 Mar 2008) | 3
	  lines Put a maximum limit on the number of payloads accepted, and
	  also make sure a given payload does not exceed our maximum value.
	  (AST-2008-002) ........

2008-03-18 15:07 +0000 [r109389]  Jason Parker <jparker@digium.com>

	* channels/chan_sip.c: Do not return with a successful
	  authentication if the From header ends up empty. (AST-2008-003)

2008-03-18 14:09 +0000 [r109357]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ael-ntest23/t1, pbx/ael/ael-test/ael-ntest23/t2,
	  pbx/ael/ael-test/ael-ntest23/t3, /, include/asterisk/extconf.h,
	  pbx/ael/ael-test/ael-ntest23/extensions.ael,
	  pbx/ael/ael-test/ael-ntest23 (added), utils/conf2ael.c,
	  pbx/ael/ael-test/ael-ntest23/t1/a.ael,
	  pbx/ael/ael-test/ael-ntest23/t1/b.ael,
	  pbx/ael/ael-test/ael-ntest23/t1/c.ael,
	  pbx/ael/ael-test/ael-ntest23/t2/d.ael,
	  pbx/ael/ael-test/ael-ntest23/t2/e.ael,
	  pbx/ael/ael-test/ael-ntest23/t2/f.ael, res/ael/ael_lex.c,
	  pbx/ael/ael-test/ref.ael-ntest23 (added),
	  pbx/ael/ael-test/ael-ntest23/t3/g.ael,
	  pbx/ael/ael-test/ael-ntest23/t3/h.ael, utils/ael_main.c,
	  pbx/ael/ael-test/ael-ntest23/t3/i.ael, utils/extconf.c,
	  pbx/ael/ael-test/ael-ntest23/t3/j.ael, res/ael/ael.flex,
	  pbx/ael/ael-test/ael-ntest23/qq.ael: Merged revisions 109309 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109309 | murf | 2008-03-18 00:37:15 -0600 (Tue, 18 Mar 2008) |
	  17 lines (closes issue #11903) Reported by: atis Many thanks to
	  atis for spotting this problem and reporting it. The fix was to
	  straighten out how items are placed on and removed from the file
	  stack. Regressions as well as the provided test case helped to
	  straighten out all code paths. valgrind was used to make sure all
	  memory allocated was freed. Sorry for not solving this earlier. I
	  got distracted. Added the ntest23 regression test, which is
	  mainly a copy of ntest22, but with a few juicy errors thrown in,
	  to replicate the kind of error that atis spotted. ........

2008-03-18 07:23 +0000 [r109316]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Add
	  manager peerstatus events when peer can't authenticate. (closes
	  issue #11959) Reported by: mostyn Patches: peerstatus3.patch
	  uploaded by mostyn (license 398)

2008-03-18 00:28 +0000 [r109282]  Sean Bright <sean.bright@gmail.com>

	* configure, configure.ac: Fix a typo

2008-03-17 22:10 +0000 [r109229]  Terry Wilson <twilson@digium.com>

	* build_tools/cflags.xml, build_tools/menuselect-deps.in,
	  configure, include/asterisk/autoconfig.h.in, main/Makefile,
	  configure.ac, main/http.c, main/minimime (removed),
	  build_tools/make_buildopts_h, makeopts.in: Replace minimime with
	  superior GMime library so that the entire contents of an http
	  post are not read into memory. This does introduce a dependency
	  on the GMime library for handling HTTP POSTs, but it is available
	  in most distros. If the library is present, then the compile flag
	  for ENABLE_UPLOADS is enabled by default in menuselect.

2008-03-17 22:06 +0000 [r109227]  Mark Michelson <mmichelson@digium.com>

	* /, main/utils.c: Merged revisions 109226 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109226 | mmichelson | 2008-03-17 17:05:49 -0500 (Mon, 17 Mar
	  2008) | 12 lines Fix a logic flaw in the code that stores lock
	  info which is displayed via the "core show locks" command. The
	  idea behind this section of code was to remove the previous lock
	  from the list if it was a trylock that had failed. Unfortunately,
	  instead of checking the status of the previous lock, we were
	  referencing the index immediately following the previous lock in
	  the lock_info->locks array. The result of this problem, under the
	  right circumstances, was that the lock which we currently in the
	  process of attempting to acquire could "overwrite" the previous
	  lock which was acquired. While this does not in any way affect
	  typical operation, it *could* lead to misleading "core show
	  locks" output. ........

2008-03-17 17:58 +0000 [r109172]  Michiel van Baak <michiel@vanbaak.info>

	* /: block rev 109171 that is already here

2008-03-17 17:47 +0000 [r109169]  Steve Murphy <murf@digium.com>

	* main/pbx.c, include/asterisk/pbx.h: (closes issue #12238)
	  Reported by: mvanbaak Tested by: murf, mvanbaak Due to a bug that
	  occurred when merge_contexts_and_delete scanned the "old" or
	  existing contexts, and found a context that doesn't exist in the
	  new set, yet owned by a different registrar. The context is
	  created in the new set, with the old registrar, and and all the
	  priorities and extens that have a different registrar are copied
	  into it. But, not the includes, ignorepats, and switches. I added
	  code to do this immediately after the context is created. This
	  still leaves a logical hole in the code. If you define a context
	  in two places, (eg. in extensions.conf and also in
	  extensions.ael), and they both have includes, but different in
	  composition, no new context will be generated, and therefore the
	  'old' includes, switches, and ignorepats will not be copied. I'd
	  have added code to simply add any non-duplicates into the 'new'
	  context that had a different registrar, but there is one big
	  complication: includes, and switches are definitely order
	  dependent. (ignorepats I'm not sure about). And we'll have to
	  develop some sort of policy about how we merge order dependent
	  lists, especially if the intersection of the two sets is empty.
	  (in other words, they do not have any elements in common). Do the
	  new go first, or the old? I've elected to punt this issue until a
	  user complains. Hopefully, this is pretty rare thing.

2008-03-17 17:43 +0000 [r109168]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: Update the directory of placed calls on
	  skinny phones when dialing a channel that does not provide
	  progress (analog ZAP lines) The phone does handle the double
	  update on calls to channels that do provide progress and wont
	  insert duplicate items (closes issue #12239) Reported by: DEA
	  Patches: chan_skinny-call-log.txt uploaded by DEA (license 3)

2008-03-17 17:31 +0000 [r109166]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, configure, configure.ac, acinclude.m4: don't define
	  Zaptel features as libraries, they aren't, and we don't want
	  '--with-zaptel-<foo>' configure options for them also some minor
	  cleanups

2008-03-17 16:47 +0000 [r109113]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Remove something that is never ever used.

2008-03-17 16:37 +0000 [r109111]  Jason Parker <jparker@digium.com>

	* configs/sip_notify.conf.sample: Add sample events for aastra
	  phones. aastra-check-cfg is the same as the other check-cfg
	  entries, and aastra-xml is to load a pre-configured xml script.
	  (closes issue #12229) Reported by: gowen72 Patches: aastra.patch
	  uploaded by gowen72 (license 432)

2008-03-17 16:26 +0000 [r109054-109108]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 109107 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109107 | file | 2008-03-17 13:24:29 -0300 (Mon, 17 Mar 2008) | 4
	  lines 200 OKs in response to a reinvite need to be sent reliably.
	  If the remote side does not receive one the dialog will be torn
	  down. (closes issue #12208) Reported by: atrash ........

	* channels/chan_sip.c: Make sure that the temporary sip_request
	  structure is empty so that copy_request doesn't think it already
	  has an ast_str. (closes issue #12231) Reported by: IgorG

2008-03-17 14:21 +0000 [r109024]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 109012 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r109012 | mmichelson | 2008-03-17 09:18:26 -0500 (Mon, 17 Mar
	  2008) | 6 lines Make sure that we release the lock on the spyee
	  channel if the spyee or spy has hung up (closes issue #12232)
	  Reported by: atis ........

2008-03-16 21:50 +0000 [r108962]  Michiel van Baak <michiel@vanbaak.info>

	* main/dial.c, /: Merged revisions 108961 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108961 | mvanbaak | 2008-03-16 22:47:10 +0100 (Sun, 16 Mar 2008)
	  | 7 lines add missing break to case AST_CONTROL_SRCUPDATE (closes
	  issue #12228) Reported by: andrew Patches: SRC.patch uploaded by
	  andrew (license 240) ........

2008-03-16 17:55 +0000 [r108927-108929]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: Remove an unnecessary thread attribute
	  instance

	* apps/app_voicemail.c: Fix polling for mailbox changes in
	  mailboxes that are not in the default vm context. (closes issue
	  #12223) Reported by: DEA Patches: vm-polled-imap.txt uploaded by
	  DEA (license 3)

2008-03-15 16:21 +0000 [r108740-108894]  Russell Bryant <russell@digium.com>

	* main/pbx.c: Remove a double write lock of the contexts lock in
	  ast_wrlock_contexts(). How did this ever work? (closes issue
	  #12219) Reported by: ys Patches: pbx.c.diff uploaded by ys
	  (license 281)

	* include/asterisk/dnsmgr.h: Doxygenify dnsmgr.h

	* Makefile: Make sure configure is run before menuselect on a clean
	  checkout (closes issue #12197) Reported by: juggie Patches:
	  12197.diff uploaded by juggie (license 24)

	* /, channels/chan_oss.c: Merged revisions 108796 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108796 | russell | 2008-03-14 15:09:22 -0500 (Fri, 14 Mar 2008)
	  | 5 lines Fix a channel name issue. chan_oss registers the
	  "Console" channel type, but it created channels with an "OSS"
	  prefix. (closes issue #12194, reported by davidw, patched by me)
	  ........

	* /, contrib/init.d/rc.suse.asterisk: Merged revisions 108792 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108792 | russell | 2008-03-14 15:04:35 -0500 (Fri, 14 Mar 2008)
	  | 4 lines Update the SuSE init script to start networking before
	  asterisk, as well. (closes issue #12200, reported by and change
	  suggested by reinerotto) ........

	* configure, acinclude.m4: Do a link test in AST_EXT_TOOL_CHECK()
	  to ensure we have all the required libs reported by the tool.
	  (closes issue #12067, reported by Juggie, patched by me)

2008-03-14 16:52 +0000 [r108738]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 108737 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108737 | mmichelson | 2008-03-14 11:44:08 -0500 (Fri, 14 Mar
	  2008) | 33 lines Fix a race condition in the SIP packet scheduler
	  which could cause a crash. chan_sip uses the scheduler API in
	  order to schedule retransmission of reliable packets (such as
	  INVITES). If a retransmission of a packet is occurring, then the
	  packet is removed from the scheduler and retrans_pkt is called.
	  Meanwhile, if a response is received from the packet as
	  previously transmitted, then when we ACK the response, we will
	  remove the packet from the scheduler and free the packet. The
	  problem is that both the ACK function and retrans_pkt attempt to
	  acquire the same lock at the beginning of the function call. This
	  means that if the ACK function acquires the lock first, then it
	  will free the packet which retrans_pkt is about to read from and
	  write to. The result is a crash. The solution: 1. If the ACK
	  function fails to remove the packet from the scheduler and the
	  retransmit id of the packet is not -1 (meaning that we have not
	  reached the maximum number of retransmissions) then release the
	  lock and yield so that retrans_pkt may acquire the lock and
	  operate. 2. Make absolutely certain that the ACK function does
	  not recursively lock the lock in question. If it does, then
	  releasing the lock will do no good, since retrans_pkt will still
	  be unable to acquire the lock. (closes issue #12098) Reported by:
	  wegbert (closes issue #12089) Reported by: PTorres Patches:
	  12098-putnopvutv3.patch uploaded by putnopvut (license 60) Tested
	  by: jvandal ........

2008-03-14 14:32 +0000 [r108683]  Jason Parker <jparker@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 108682 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r108682 | qwell | 2008-03-14 09:29:05 -0500 (Fri, 14 Mar
	  2008) | 4 lines Fix a potential segfault if chan (or
	  chan->music_state) is NULL. Closes issue #12210, credit to
	  edantie for pointing this out. ........

2008-03-13 23:12 +0000 [r108639]  Jeff Peeler <jpeeler@digium.com>

	* doc/externalivr.txt, apps/app_externalivr.c, CHANGES: documenting
	  changes as a result of adding TCP functionality to ExternalIVR

2008-03-13 21:47 +0000 [r108586]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c: Make this compile

2008-03-13 21:40 +0000 [r108531-108584]  Russell Bryant <russell@digium.com>

	* main/channel.c, /, include/asterisk/channel.h,
	  apps/app_chanspy.c: Merged revisions 108583 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108583 | russell | 2008-03-13 16:38:16 -0500 (Thu, 13 Mar 2008)
	  | 11 lines Fix another issue that was causing crashes in chanspy.
	  This introduces a new datastore callback, called chan_fixup().
	  The concept is exactly like the fixup callback that is used in
	  the channel technology interface. This callback gets called when
	  the owning channel changes due to a masquerade. Before this was
	  introduced, if a masquerade happened on a channel being spyed on,
	  the channel pointer in the datastore became invalid. (closes
	  issue #12187) (reported by, and lots of testing from atis) (props
	  to file for the help with ideas) ........

	* /, channels/chan_sip.c: Merged revisions 108530 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108530 | russell | 2008-03-13 16:06:33 -0500 (Thu, 13 Mar 2008)
	  | 10 lines Make a tweak that gets the LEDs on polycom phones to
	  blink when an extension that has been subscribed to goes on hold.
	  Otherwise, they just stay on like it does when an extension is in
	  use. (closes issue #11263) Reported by: russell Patches:
	  notify_hold.rev1.txt uploaded by russell (license 2) Tested by:
	  russell ........

2008-03-13 20:59 +0000 [r108529]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c: Fixing a potential buffer overflow in the manager
	  command ModuleCheck. Though this overflow is exploitable
	  remotely, we are NOT issuing a security advisory for this since
	  in order to exploit the overflow, the attacker would have to
	  establish an authenticated manager session AND have the system
	  privilege. By gaining this privilege, the attacker already has
	  more powerful weapons at his disposal than overflowing a buffer
	  with a malformed manager header, so the vulnerability in this
	  case really lies with the authentication method that allowed the
	  attacker to gain the system privilege in the first place.

2008-03-13 20:38 +0000 [r108523]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_externalivr.c: set variable to NULL to prevent
	  uninitialized warning

2008-03-13 20:35 +0000 [r108439-108508]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: Fix a place where configuration values
	  could cause an overflow of a buffer.

	* /, apps/app_followme.c: Merged revisions 108469 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108469 | russell | 2008-03-13 15:26:28 -0500 (Thu, 13 Mar 2008)
	  | 4 lines Fix a couple uses of sprintf. The second one could
	  actually cause an overflow of a stack buffer. It's not a security
	  issue though, it only depends on your configuration. ........

	* channels/chan_sip.c: Merge changes from
	  team/jamesgolovich/chan_sip-ast_str This set of changes removes
	  the hard coded maximum packet size of 4kB from chan_sip. It now
	  starts by allocating 1kB, and growing the buffer as needed to
	  accommodate large packets. (closes issue #8556, reported by
	  mikma, patch by jamesgolovich)

2008-03-13 18:59 +0000 [r108404]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_externalivr.c: (closes issue #11827) Reported by:
	  ctooley Patches: eivr_tcp_generic.patch uploaded by jpeeler
	  (license 325) This change adds the ability to communicate over a
	  TCP socket instead of forking a child process.

2008-03-12 22:49 +0000 [r108295-108346]  Russell Bryant <russell@digium.com>

	* main/http.c: Make the default prefix empty, like it was in
	  Asterisk 1.4. (closes issue #12198, reported by bkruse, patched
	  by me)

	* include/asterisk/http.h, main/tcptls.c, main/manager.c,
	  channels/chan_sip.c, res/res_phoneprov.c, main/http.c,
	  include/asterisk/tcptls.h: Rename ast_tcptls_server_instance to
	  session_instance, since this pertains to server and client usage.

2008-03-12 22:09 +0000 [r108289-108293]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Let's get this to compile

	* /, channels/chan_sip.c: Merged revisions 108288 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108288 | mmichelson | 2008-03-12 16:53:46 -0500 (Wed, 12 Mar
	  2008) | 14 lines Change AST_SCHED_DEL use to ast_sched_del for
	  autocongestion in chan_sip. The scheduler callback will always
	  return 0. This means that this id is never rescheduled, so it
	  makes no sense to loop trying to delete the id from the scheduler
	  queue. If we fail to remove the item from the queue once, it will
	  fail every single time. (Yes I realize that in this case, the
	  macro would exit early because the id is set to -1 in the
	  callback, but it still makes no sense to use that macro in favor
	  of calling ast_sched_del once and being done with it) This is the
	  first of potentially several such fixes. ........

2008-03-12 21:37 +0000 [r108286]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c, CHANGES, configs/zapata.conf.sample: add
	  support for named sections in zapata.conf, and fix a few bugs in
	  config file parsing (closes issue #9503) Reported by: tzafrir
	  Patches: fix_cleanups uploaded by tzafrir (license 46)
	  zapata_sections uploaded by tzafrir (license 46)
	  skipchannel_options uploaded by tzafrir (license 46) conf_sample
	  uploaded by tzafrir (license 46) patches updated by me to better
	  conform to coding guidelines and fix some problems

2008-03-12 21:19 +0000 [r108238]  Mark Michelson <mmichelson@digium.com>

	* /, include/asterisk/sched.h: Merged revisions 108227 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r108227 | mmichelson | 2008-03-12 16:16:28 -0500 (Wed,
	  12 Mar 2008) | 12 lines Added a large comment before the
	  AST_SCHED_DEL macro to explain its purpose as well as when it is
	  appropriate and when it is not appropriate to use it. I also
	  removed the part of the debug message that mentions that this is
	  probably a bug because there are some perfectly legitimate places
	  where ast_sched_del may fail to delete an entry (e.g. when the
	  scheduler callback manually reschedules with a new id instead of
	  returning non-zero to tell the scheduler to reschedule with the
	  same idea). I also raised the debug level of the debug message in
	  AST_SCHED_DEL since it seems like it could come up quite
	  frequently since the macro is probably being used in several
	  places where it shouldn't be. Also removed the redundant line,
	  file, and function information since that is provided by ast_log.
	  ........

2008-03-12 21:06 +0000 [r108226]  Joshua Colp <jcolp@digium.com>

	* main/slinfactory.c, include/asterisk/slinfactory.h: Doxygenify
	  slinfactory a bit.

2008-03-12 20:27 +0000 [r108191]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c: Merged revisions 108086 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108086 | kpfleming | 2008-03-12 14:16:07 -0500 (Wed, 12 Mar
	  2008) | 6 lines if we receive an INVITE with a Content-Length
	  that is not a valid number, or is zero, then don't process the
	  rest of the message body looking for an SDP closes issue #11475
	  Reported by: andrebarbosa ........

2008-03-12 19:59 +0000 [r108137]  Russell Bryant <russell@digium.com>

	* main/channel.c, /, apps/app_chanspy.c: Merged revisions 108135
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108135 | russell | 2008-03-12 14:57:42 -0500 (Wed, 12 Mar 2008)
	  | 40 lines (closes issue #12187, reported by atis, fixed by me
	  after some brainstorming on the issue with mmichelson) - Update
	  copyright info on app_chanspy. - Fix a race condition that caused
	  app_chanspy to crash. The issue was that the chanspy datastore
	  magic that was used to ensure that spyee channels did not
	  disappear out from under the code did not completely solve the
	  problem. It was actually possible for chanspy to acquire a
	  channel reference out of its datastore to a channel that was in
	  the middle of being destroyed. That was because datastore
	  destruction in ast_channel_free() was done near the end. So, this
	  left the code in app_chanspy accessing a channel that was
	  partially, or completely invalid because it was in the process of
	  being free'd by another thread. The following sort of shows the
	  code path where the race occurred:
	  =============================================================================
	  Thread 1 (PBX thread for spyee chan) || Thread 2 (chanspy)
	  --------------------------------------||-------------------------------------
	  ast_channel_free() || - remove channel from channel list || -
	  lock/unlock the channel to ensure || that no references retrieved
	  from || the channel list exist. ||
	  --------------------------------------||-------------------------------------
	  || channel_spy() - destroy some channel data || - Lock chanspy
	  datastore || - Retrieve reference to channel || - lock channel ||
	  - Unlock chanspy datastore
	  --------------------------------------||-------------------------------------
	  - destroy channel datastores || - call chanspy datastore d'tor ||
	  which NULL's out the ds' || - Operate on the channel ...
	  reference to the channel || || - free the channel || || || -
	  unlock the channel
	  --------------------------------------||-------------------------------------
	  =============================================================================
	  ........

2008-03-12 18:29 +0000 [r108084]  Joshua Colp <jcolp@digium.com>

	* /, include/asterisk/audiohook.h, main/audiohook.c,
	  apps/app_mixmonitor.c: Merged revisions 108083 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108083 | file | 2008-03-12 15:26:37 -0300 (Wed, 12 Mar 2008) | 4
	  lines Add a trigger mode that triggers on both read and write.
	  The actual function that returns the combined audio frame though
	  will wait until both sides have fed in audio, or until one side
	  stops (such as the case when you call Wait). (closes issue
	  #11945) Reported by: xheliox ........

2008-03-12 17:06 +0000 [r108032-108034]  Russell Bryant <russell@digium.com>

	* funcs/func_config.c: - Add Tilghman to the copyright info ... he
	  wrote the hard part :) - Remove some magic in unload_module that
	  isn't needed. Module use counts already ensure that the function
	  isn't going to be in use at this point.

	* main/channel.c, /: Merged revisions 108031 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r108031 | russell | 2008-03-12 11:59:07 -0500 (Wed, 12 Mar 2008)
	  | 4 lines Destroy the channel lock after the channel datastores.
	  (inspired by issue #12187) ........

2008-03-12 07:43 +0000 [r107878-107998]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: Deadlock fixes (closes issue #12143)
	  Reported by: kactus Patches: 20080312__bug12143__2.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: kactus

	* apps/app_dumpchan.c, apps/app_zapras.c, main/loader.c: Revert
	  several changes from revision 102525, as the changes were not
	  compatible, and, in fact, introduced regressions. (Closes issue
	  #12190)

	* funcs/func_config.c: Cache config files, when possible, for speed

	* contrib/scripts/iax-friends.sql, /,
	  contrib/scripts/sip-friends.sql: Merged revisions 107877 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107877 | tilghman | 2008-03-11 20:52:40 -0500 (Tue, 11 Mar 2008)
	  | 2 lines Document all of the possible realtime fields ........

2008-03-11 23:38 +0000 [r107827]  Jason Parker <jparker@digium.com>

	* /, doc/voicemail_odbc_postgresql.txt: Merged revisions 107826 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107826 | qwell | 2008-03-11 18:37:05 -0500 (Tue, 11 Mar 2008) |
	  7 lines Update documentation for pgsql ODBC voicemail. (closes
	  issue #12186) Reported by: jsmith Patches:
	  vm_pgsql_doc_update.patch uploaded by jsmith (license 15)
	  ........

2008-03-11 22:55 +0000 [r107791]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_curl.c, res/res_config_pgsql.c,
	  res/res_config_odbc.c, include/asterisk/config.h,
	  res/res_config_ldap.c, res/res_config_sqlite.c, main/config.c: An
	  offhand comment from Russell made me realize that the
	  configuration file caching would not work properly for users.conf
	  and any other file read from more than one place. I needed to add
	  the filename which requested the config file to get it to work
	  properly.

2008-03-11 22:54 +0000 [r107787-107790]  Russell Bryant <russell@digium.com>

	* funcs/func_config.c: remove documentation of an argument that i
	  did not implement

	* funcs/func_config.c (added), CHANGES: Add a trivial new dialplan
	  function, AST_CONFIG(), which allows you to access a variable
	  from an Asterisk configuration file in the dialplan, or anywhere
	  else where dialplan functions can be used. (Inspired by a
	  discussion with Tilghman and Pari)

2008-03-11 21:10 +0000 [r107721-107722]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_odbc.c: Convert prepare_and_execute to direct_execute for
	  speed (closes issue #11935) Reported by: falves11 Patches:
	  20080208__bug11935.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: falves11, Corydon76

	* contrib/scripts/dbsep.cgi (added), configs/dbsep.conf.sample
	  (added): Add contributed script for separation of database access
	  from Asterisk

2008-03-11 20:54 +0000 [r107719]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: This patch adds support for extended help
	  prompts in voicemail. These prompts are in the 1.4.9 sounds
	  release. (closes issue #11705) Reported by: jaroth Patches:
	  helpprompts.patch uploaded by jaroth (license 50)

2008-03-11 20:53 +0000 [r107718]  Jason Parker <jparker@digium.com>

	* channels/chan_jingle.c, /, channels/chan_gtalk.c: Merged
	  revisions 107714 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107714 | qwell | 2008-03-11 15:49:56 -0500 (Tue, 11 Mar 2008) |
	  5 lines Copy voicemail dependency logic for res_adsi to
	  chan_gtalk and chan_jingle (for jabber). (closes issue #12014)
	  Reported by: junky ........

2008-03-11 20:50 +0000 [r107715]  Kevin P. Fleming <kpfleming@digium.com>

	* /, Makefile.rules, channels/Makefile: Merged revisions 107713 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107713 | kpfleming | 2008-03-11 15:48:58 -0500 (Tue, 11 Mar
	  2008) | 2 lines get chan_vpb to build properly in dev mode
	  ........

2008-03-11 20:36 +0000 [r107638-107710]  Joshua Colp <jcolp@digium.com>

	* apps/app_page.c: Dial a device even if it's state is unknown.
	  (closes issue #12184) Reported by: bluecrow76 Patches:
	  asterisk-svn-app_page.c.devicestate_unknown.diff uploaded by
	  bluecrow76 (license 270)

	* /, main/features.c: Merged revisions 107646 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107646 | file | 2008-03-11 16:20:01 -0300 (Tue, 11 Mar 2008) | 4
	  lines Make sure the visible indication is on the right channel so
	  when the masquerade happens the proper indication is enacted.
	  (closes issue #11707) Reported by: iam ........

	* /, apps/app_meetme.c: Merged revisions 107637 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107637 | file | 2008-03-11 15:47:33 -0300 (Tue, 11 Mar 2008) | 4
	  lines Add an additional check for setting conference parameter
	  when using the marked user options. It was possible for it to
	  return to a no listen/no talk state if a masquerade happened.
	  (closes issue #12136) Reported by: aragon ........

2008-03-11 16:28 +0000 [r107551]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_pgsql.c: Whitespace changes only

2008-03-11 15:59 +0000 [r107530]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c: Remove some redundant logic from
	  wait_for_answer. This also let's us get rid of one of those XXX
	  comments from the code. The redundancy occurs because the
	  'single' flag implies that the 'r' and 'm' flags are not set, so
	  there's no need to explicitly check them again.

2008-03-11 15:39 +0000 [r107466-107525]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_vpb.cc: fix another potential bug found by gcc 4.3

	* /: block fix that is already here

	* codecs/Makefile, /, apps/app_sms.c, apps/app_rpt.c,
	  channels/misdn/isdn_lib.c: Merged revisions 107464 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r107464 | kpfleming | 2008-03-11 09:53:03 -0500 (Tue, 11
	  Mar 2008) | 2 lines fix various other problems found by gcc 4.3
	  ........

2008-03-11 15:05 +0000 [r107465]  Joshua Colp <jcolp@digium.com>

	* main/features.c: Clarify comment about masquerading and playback
	  of the parking slot. (closes issue #12180) Reported by: davidw

2008-03-11 14:37 +0000 [r107373-107462]  Kevin P. Fleming <kpfleming@digium.com>

	* /, configure, include/asterisk/autoconfig.h.in, configure.ac,
	  apps/app_sms.c: Merged revisions 107461 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107461 | kpfleming | 2008-03-11 09:33:45 -0500 (Tue, 11 Mar
	  2008) | 2 lines stop checking for mktime() in the configure
	  script... we don't use it, and the test is buggy under gcc 4.3
	  ........

	* /, configure, main/Makefile, configure.ac, makeopts.in: Merged
	  revisions 107408 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107408 | kpfleming | 2008-03-11 09:07:59 -0500 (Tue, 11 Mar
	  2008) | 5 lines check for compiler support for
	  -fno-strict-overflow before using it (tested with Debian's gcc
	  4.3, 4.1 and 3.4) (closes issue #12179) Reported by: Netview
	  ........

	* /, configure, include/asterisk/autoconfig.h.in, configure.ac:
	  Merged revisions 107405 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107405 | kpfleming | 2008-03-11 08:57:08 -0500 (Tue, 11 Mar
	  2008) | 2 lines fix small bug in IMAP toolkit testing ........

	* main/udptl.c, utils/Makefile, /, main/Makefile,
	  main/editline/readline.c, res/Makefile: Merged revisions 107352
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107352 | kpfleming | 2008-03-11 06:04:29 -0500 (Tue, 11 Mar
	  2008) | 11 lines fix up various compiler warnings found with
	  gcc-4.3: - the output of flex includes a static function called
	  'input' that is not used, so for the moment we'll stop having the
	  compiler tell us about unused variables in the flex source files
	  (a better fix would be to improve our flex post-processing to
	  remove the unused function) - main/stdtime/localtime.c makes
	  assumptions about signed integer overflow, and gcc-4.3's improved
	  optimizer tries to take advantage of handling potential overflow
	  conditions at compile time; for now, suppress these optimizations
	  until we can fiure out if the code needs improvement -
	  main/udptl.c has some references to uninitialized variables; in
	  one case there was no bug, but in the other it was certainly
	  possibly for unexpected behavior to occur -
	  main/editline/readline.c had an unused variable ........

2008-03-11 01:09 +0000 [r107292]  Terry Wilson <twilson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 107290 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107290 | twilson | 2008-03-10 19:59:18 -0500 (Mon, 10 Mar 2008)
	  | 2 lines If we fail to alloc a channel, we should re-lock the
	  pvt structure before returning. ........

2008-03-10 21:48 +0000 [r107231]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /, include/asterisk/pbx.h, pbx/pbx_config.c: (closes
	  issue #6019) Reported by: ssokol Patches:
	  20080304__bug6019.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: putnopvut

2008-03-10 20:28 +0000 [r107177]  Jason Parker <jparker@digium.com>

	* channels/chan_zap.c, /: Merged revisions 107173 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107173 | qwell | 2008-03-10 15:27:08 -0500 (Mon, 10 Mar 2008) |
	  5 lines Make sure to reenable echo can after a "failed"
	  (canceled, etc) three-way call. (closes issue #11335) Reported
	  by: rebuild ........

2008-03-10 20:17 +0000 [r107159-107162]  Russell Bryant <russell@digium.com>

	* main/pbx.c, /: Merged revisions 107161 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107161 | russell | 2008-03-10 15:17:11 -0500 (Mon, 10 Mar 2008)
	  | 8 lines Fix another bug specifically related to asynchronous
	  call origination. Once the PBX is started on the channel using
	  ast_pbx_start(), then the ownership of the channel has been
	  passed on to another thread. We can no longer access it in this
	  code. If the channel gets hung up very quickly, it is possible
	  that we could access a channel that has been free'd. (inspired by
	  BE-386) ........

	* main/pbx.c, /: Merged revisions 107158 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107158 | russell | 2008-03-10 15:04:27 -0500 (Mon, 10 Mar 2008)
	  | 9 lines Fix some bugs related to originating calls. If the code
	  failed to start a PBX on the channel (such as if you set a call
	  limit based on the system's load average), then there were cases
	  where a channel that has already been free'd using ast_hangup()
	  got accessed. This caused weird memory corruption and crashes to
	  occur. (fixes issue BE-386) (much debugging credit goes to
	  twilson, final patch written by me) ........

2008-03-10 20:00 +0000 [r107157]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: If we receive a 488 on a T38 request
	  reinvite back to audio. As well reinvite across a bridge back to
	  audio if one side doesn't negotiate to T38. (closes issue #8677)
	  Reported by: alex-911

2008-03-10 17:13 +0000 [r107100-107103]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 107102 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107102 | russell | 2008-03-10 12:13:17 -0500 (Mon, 10 Mar 2008)
	  | 2 lines Resolve a compiler warning. ........

	* main/channel.c, /: Merged revisions 107099 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107099 | russell | 2008-03-10 11:58:57 -0500 (Mon, 10 Mar 2008)
	  | 3 lines Fix a race condition where the generator can go away
	  (closes issue #12175, reported by edantie, patched by me)
	  ........

2008-03-10 15:45 +0000 [r107068]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: app_queue has now been doxygenified thanks to
	  snuffy! The ony thing I changed was the way that locks are
	  referenced, since the old 1.2 names were still used in the
	  comments. (closes issue #11997) Reported by: snuffy Patches:
	  bug_11997_queue_doxy.diff uploaded by snuffy (license 35)

2008-03-10 14:55 +0000 [r107019]  Steve Murphy <murf@digium.com>

	* main/cdr.c: way back in July, in r.75706, a fix was made ot the
	  strftime usages, which was good, but in this case, the check for
	  a nil time was accidentally removed, and now it is restored, to
	  keep timevals like '1969-12-31 17:00:00' from showing up in the
	  cdrs. No idea what databases will do with this. No bugs filed as
	  yet, but it felt like a bug.

2008-03-10 14:36 +0000 [r107017]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, main/cdr.c, /, include/asterisk/cdr.h: Merged
	  revisions 107016 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r107016 | file | 2008-03-10 11:33:02 -0300 (Mon, 10 Mar 2008) | 7
	  lines Move where unanswered CDRs are dropped to the CDR core, not
	  everything uses app_dial. (closes issue #11516) Reported by: ys
	  Patches: branch_1.4_cdr.diff uploaded by ys (license 281) Tested
	  by: anest, jcapp, dartvader ........

2008-03-08 16:03 +0000 [r106946]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c, /: Merged revisions 106945 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106945 | kpfleming | 2008-03-08 09:59:42 -0600 (Sat, 08 Mar
	  2008) | 2 lines don't generate D-Channel "up" and "down" messages
	  unless the channel state is actually changing; also, generate the
	  "up" message when an implicit "up" occurs due to reception of a
	  normal event when we thought the channel was "down" ........

2008-03-07 22:52 +0000 [r106896]  Russell Bryant <russell@digium.com>

	* /, apps/app_meetme.c: Merged revisions 106895 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106895 | russell | 2008-03-07 16:51:23 -0600 (Fri, 07 Mar 2008)
	  | 2 lines Only start the SLA thread if SLA has actually been
	  configured. ........

2008-03-07 22:36 +0000 [r106892]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c: Make sure we don't start a call when we have
	  already done so in response to a COT message

2008-03-07 22:15 +0000 [r106843]  Jason Parker <jparker@digium.com>

	* /, main/editline/Makefile.in: Merged revisions 106842 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106842 | qwell | 2008-03-07 16:14:45 -0600 (Fri, 07 Mar 2008) |
	  5 lines Fix hardcoded grep in editline, were GNU grep is
	  required. (closes issue #12124) Reported by: dmartin ........

2008-03-07 19:33 +0000 [r106789]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, /: Merged revisions 106788 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106788 | file | 2008-03-07 15:32:00 -0400 (Fri, 07 Mar 2008) | 4
	  lines Ignore source update control frame. (closes issue #12168)
	  Reported by: plack ........

2008-03-07 18:57 +0000 [r106757]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, main/pbx.c, include/asterisk/pval.h,
	  channels/chan_sip.c, apps/app_meetme.c, res/ael/ael.y,
	  apps/app_queue.c, channels/chan_iax2.c, utils/conf2ael.c,
	  utils/Makefile, res/ael/pval.c, channels/chan_skinny.c,
	  res/ael/ael.tab.c, main/features.c, pbx/pbx_ael.c,
	  res/ael/ael_lex.c, utils/ael_main.c, res/ael/ael.tab.h,
	  utils/extconf.c, include/asterisk/pbx.h, pbx/pbx_config.c,
	  res/ael/ael.flex: (closes issue #6002) Reported by: rizzo Tested
	  by: murf Proposal of the changes to be made, and then an
	  announcement of how they were accomplished:
	  http://lists.digium.com/pipermail/asterisk-dev/2008-February/032065.html
	  and:
	  http://lists.digium.com/pipermail/asterisk-dev/2008-March/032124.html
	  Here is a recap, file by file, of what I have done:
	  pbx/pbx_config.c pbx/pbx_ael.c All funcs that were passed a ptr
	  to the context list, now will ALSO be passed a hashtab ptr to the
	  same set. Why? because (for the time being), the dialplan is
	  stored in both, to facilitate a quick, low-cost move to
	  hash-tables to speed up dialplan processing. If it was deemed
	  necessary to pass the context LIST, well, it is just as necessary
	  to have the TABLE available. This is because the list/table in
	  question might not be the global one, but temporary ones we would
	  use to stage the dialplan on, and then swap into the global
	  position when things are ready. We now have one external function
	  for apps to use, "ast_context_find_or_create()" instead of the
	  pre-existing "find" and "create", as all existing usages used
	  both in tandem anyway. pbx_config, and pbx_ael, will stage the
	  reloaded dialplan into local lists and tables, and then call
	  merge_contexts_and_delete, which will merge (now) existing
	  contexts and priorities from other registrars into this local set
	  by copying them. Then, merge_contexts_and_delete will lock down
	  the contexts, swap the lists and tables, and unlock (real quick),
	  and then destroy the old dialplan. chan_sip.c chan_iax.c
	  chan_skinny.c All the channel drivers that would add regcontexts
	  now use the ast_context_find_or_create now. chan_sip also
	  includes a small fix to get rid of warnings about removing
	  priorities that never got entered. apps/app_meetme.c
	  apps/app_dial.c apps/app_queue.c All the apps that added a
	  context/exten/priority were also modified to use
	  ast_context_find_or_create instead. include/asterisk/pbx.h
	  ast_context_create() is removed. Find_or_create_ is the new
	  method. ast_context_find_or_create() interface gets the hashtab
	  added. ast_merge_contexts_and_delete() gets the local hashtab arg
	  added. ast_wrlock_contexts_version() is added so you can detect
	  if someone else got a writelock between your readlocking and
	  writelocking. ast_hashtab_compare_contexts was made public for
	  use in pbx_config/pbx_ael ast_hashtab_hash_contexts was in like
	  fashion make public. include/asterisk/pval.h ast_compile_ael2()
	  interface changed to include the local hashtab table ptr.
	  main/features.c For the sake of the parking context, we use
	  ast_context_find_or_create(). main/pbx.c I changed all the "tree"
	  names to "table" instead. That's because the original
	  implementation was based on binary trees. (had a free library).
	  Then I moved to hashtabs. Now, the names move forward too.
	  refcount field added to contexts, so you can keep track of how
	  many modules wanted this context to exist. Some log messages that
	  are warnings were inflated from LOG_NOTICE to LOG_WARNING. Added
	  some calls to ast_verb(3,...) for debug messages Lots of little
	  mods to ast_context_remove_extension2, which is now excersized in
	  ways it was not previously; one definite bug fixed.
	  find_or_create was upgraded to handle both local lists/tables as
	  well as the globals. context_merge() was added to do the
	  per-context merging of the old/present contexts/extens/prios into
	  the new/proposed local list/tables
	  ast_merge_contexts_and_delete() was heavily modified.
	  ast_add_extension2() was also upgraded to handle changes. the
	  context_destroy() code was re-engineered to handle the new way of
	  doing things, by exten/prio instead of by context. res/ael/pval.c
	  res/ael/ael.tab.c res/ael/ael.tab.h res/ael/ael.y
	  res/ael/ael_lex.c res/ael/ael.flex utils/ael_main.c
	  utils/extconf.c utils/conf2ael.c utils/Makefile Had to change the
	  interface to ast_compile_ael2(), to include the hashtab ptr. This
	  ended up involving several external apps. The main gotcha was I
	  had to include lock.h and hashtab.h in several places. As a side
	  note, I tested this stuff pretty thoroughly, I replicated the
	  problems originally reported by Luigi, and made triply sure that
	  reloads worked, and everything worked thru "stop gracefully". I
	  found a and fixed a few bugs as I was merging into trunk, that
	  did not appear in my tests of bug6002. How's this for verbose
	  commit messages?

2008-03-07 17:17 +0000 [r106684-106707]  Russell Bryant <russell@digium.com>

	* /, include/asterisk/sched.h: Merged revisions 106704 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r106704 | russell | 2008-03-07 11:16:58 -0600 (Fri, 07
	  Mar 2008) | 8 lines Change a warning message to a debug message.
	  This is happening quite frequently, and it is not worth spamming
	  users with these messages unless we are pretty confident that it
	  should never happen. As it stands today, it _will_ and _does_
	  happen and until that gets cleaned up a reasonable amount on the
	  development side, let's not spam the logs of everyone else.
	  (closes issue #12154) ........

	* doc/smdi.txt: fix example usage

2008-03-07 16:26 +0000 [r106553-106654]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 106635 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r106635 | tilghman | 2008-03-07 10:22:11 -0600 (Fri, 07
	  Mar 2008) | 3 lines Warn the user when a temporary greeting
	  exists (Closes issue #11409) ........

	* /, main/rtp.c: Merged revisions 106606 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106606 | tilghman | 2008-03-07 09:20:52 -0600 (Fri, 07 Mar 2008)
	  | 3 lines Properly initialize rtp->schedid (Closes issue #12154)
	  ........

	* main/channel.c, funcs/func_enum.c, channels/chan_misdn.c,
	  main/frame.c, /, channels/chan_sip.c, funcs/func_odbc.c,
	  funcs/func_strings.c, utils/extconf.c, apps/app_chanspy.c,
	  apps/app_rpt.c, main/asterisk.c, apps/app_speech_utils.c,
	  apps/app_voicemail.c: Merged revisions 106552 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106552 | tilghman | 2008-03-07 00:36:33 -0600 (Fri, 07 Mar 2008)
	  | 6 lines Safely use the strncat() function. (closes issue
	  #11958) Reported by: norman Patches: 20080209__bug11958.diff.txt
	  uploaded by Corydon76 (license 14) ........

2008-03-07 01:19 +0000 [r106501-106518]  Russell Bryant <russell@digium.com>

	* doc/smdi.txt: minor text changes

	* doc/smdi.txt: Add updated SMDI documentation that I had only
	  sitting in my email ... oops

	* codecs/codec_g722.c, formats/format_pcm.c, main/file.c,
	  main/rtp.c: Merge changes from team/russell/g722-sillyness ...
	  Fix a number of other places where the number of samples in a
	  G722 frame was not properly handled because of various reasons.
	  main/rtp.c: - When a G722 frame is read from the smoother, the
	  number of samples in the frame must be divided by 2 before being
	  sent out over the network. Even though G722 is 16 kHz, an error
	  in some previous spec has made it so that we have to list the
	  number of samples such as if it was 8 kHz. main/file.c: - When
	  scheduling the next time to expect a frame, take into account
	  that the format of the file we're reading from may not be 8 kHz.
	  codecs/codec_g722.c: - When converting from G722 to slinear,
	  g722_decode() expects its samples parameter to be in the silly
	  (real samples / 2) format. Make it so. - When converting from
	  slinear to G722, properly set the number of samples in the frame
	  to be the number of bytes of output * 2. formats/format_pcm.c: -
	  This format module handles G722, among a number of other formats.
	  However, the read() and seek() functions did not account for the
	  fact that G722 has 2 samples per byte. (closes issue #12130,
	  reported by rickross, patched by me)

2008-03-06 22:11 +0000 [r106439]  Jason Parker <jparker@digium.com>

	* main/file.c: Fix file playback in many cases. (closes issue
	  #12115) Reported by: pj Patches: v2-fileexists.patch uploaded by
	  dimas (license 88) (with modifications by me) Tested by: dimas,
	  qwell, russell

2008-03-06 22:11 +0000 [r106438]  Mark Michelson <mmichelson@digium.com>

	* main/pbx.c, /: Merged revisions 106437 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106437 | mmichelson | 2008-03-06 16:10:07 -0600 (Thu, 06 Mar
	  2008) | 8 lines Quell an annoying message that is likely to print
	  every single time that ast_pbx_outgoing_app is called. The reason
	  is that __ast_request_and_dial allocates the cdr for the channel,
	  so it should be expected that the channel will have a cdr on it.
	  Thanks to joetester on IRC for pointing this out ........

2008-03-06 19:31 +0000 [r106399]  Donny Kavanagh <donnyk@gmail.com>

	* res/res_agi.c: trivial fix for an agi error when attempting to
	  use EAGI on a dead/hungup channel, we now print an error that
	  makes sense given our removal of deadagi as an actual
	  application. (closes issue #12161) Reported by: explidous
	  Patches: res_agi_12161.patch uploaded by juggie (license 24)
	  Tested by: juggie

2008-03-06 05:21 +0000 [r106329-106346]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_ldap.c: Missing braces, fix parsing (closes issue
	  #12112) Reported by: cyrenity Patches:
	  res_config_ldap.patch-03-03-2008 uploaded by cyrenity (license
	  416) Tested by: cyrenity, Corydon76

	* /, sounds/sounds.xml, sounds/Makefile: Merged revisions 106328
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106328 | tilghman | 2008-03-05 22:40:06 -0600 (Wed, 05 Mar 2008)
	  | 2 lines Upgrade to the next release of sounds ........

2008-03-05 23:21 +0000 [r106250]  Jason Parker <jparker@digium.com>

	* Makefile: Add a cmenuselect/cmenuconfig, to force curses.

2008-03-05 22:50 +0000 [r106240]  Russell Bryant <russell@digium.com>

	* Makefile, /: Add the nmenuselect makefile targets. This is a newt
	  menuselect interface which was written by seanbright. It is much
	  sexier than my curses one. :) (issue #12139)

2008-03-05 22:43 +0000 [r106239]  Joshua Colp <jcolp@digium.com>

	* channels/chan_unistim.c, apps/app_dial.c, channels/chan_zap.c, /,
	  channels/chan_sip.c, channels/chan_console.c,
	  apps/app_followme.c, channels/chan_oss.c, main/rtp.c,
	  main/channel.c, channels/chan_phone.c, main/dial.c,
	  channels/chan_skinny.c, main/file.c, channels/chan_h323.c,
	  channels/chan_alsa.c, include/asterisk/frame.h,
	  channels/chan_mgcp.c: Merged revisions 106235 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106235 | file | 2008-03-05 18:32:10 -0400 (Wed, 05 Mar 2008) | 4
	  lines Add a control frame to indicate the source of media has
	  changed. Depending on the underlying technology it may need to
	  change some things. (closes issue #12148) Reported by: jcomellas
	  ........

2008-03-05 22:40 +0000 [r106238]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 106237 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r106237 | russell | 2008-03-05 16:37:09 -0600 (Wed, 05
	  Mar 2008) | 3 lines Fix a potential deadlock and a few different
	  potential crashes. (closes issue #12145, reported by thiagarcia,
	  patched by me) ........

2008-03-05 22:33 +0000 [r106236]  Mark Michelson <mmichelson@digium.com>

	* doc/manager_1_1.txt, main/manager.c, CHANGES: Adding the Atxfer
	  manager command. With this, you may initiate an attended transfer
	  over AMI (closes issue #10585) Reported by: ornati Patches:
	  atxfer-trunk-r90428.diff uploaded by ornati (license 210) (with
	  modifications from me) Tested by: putnopvut

2008-03-05 21:19 +0000 [r106186]  Michiel van Baak <michiel@vanbaak.info>

	* doc/tex/realtime.tex: document var_metric usage to prevent
	  bugreports that are actually configuration issues (closes issue
	  #12151) Reported by: caio1982 Patches: DB_metric3.diff uploaded
	  by caio1982 (license 22)

2008-03-05 17:40 +0000 [r106139]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_talkdetect.c: Should check these values for non-NULL
	  before scanning. (Closes issue #12147)

2008-03-05 16:39 +0000 [r106110]  Joshua Colp <jcolp@digium.com>

	* main/dsp.c: Fix code up to what it was meant to be.

2008-03-05 16:23 +0000 [r106072]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c, apps/app_meetme.c, apps/app_waitforsilence.c,
	  apps/app_record.c, UPGRADE.txt, apps/app_followme.c, CHANGES,
	  main/loader.c, configs/dsp.conf.sample (added),
	  apps/app_minivm.c, res/res_agi.c, include/asterisk/dsp.h,
	  main/app.c, apps/app_amd.c, main/asterisk.c, main/dsp.c,
	  apps/app_voicemail.c: Create a centralized configuration option
	  for silencethreshold (closes issue #11236) Reported by: philipps
	  Patches: 20080218__bug11236.diff.txt uploaded by Corydon76
	  (license 14) Tested by: philipps

2008-03-05 15:40 +0000 [r106040]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c, /: Merged revisions 106038 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106038 | kpfleming | 2008-03-05 09:32:35 -0600 (Wed, 05 Mar
	  2008) | 7 lines when a PRI call must be moved to a different B
	  channel at the request of the other endpoint, ensure that any DSP
	  active on the original channel is moved to the new one (closes
	  issue #11917) Reported by: mavetju Tested by: mavetju ........

2008-03-05 15:23 +0000 [r106036]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c, include/asterisk/sched.h: Merged
	  revisions 106015 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r106015 | tilghman | 2008-03-05 09:17:16 -0600 (Wed, 05 Mar 2008)
	  | 7 lines Correctly initialize retransid in SIP, and ensure that
	  the warning when failing to delete a schedule entry can actually
	  hit the log. (closes issue #12140) Reported by: slavon Patches:
	  sch2.patch uploaded by slavon (license 288) (Patch slightly
	  modified by me) ........

2008-03-05 04:34 +0000 [r105899-105984]  Russell Bryant <russell@digium.com>

	* apps/app_queue.c: - simplify a few statements with ARRAY_LEN() -
	  constify the stregy int to string mappings array

	* /, main/translate.c, include/asterisk/frame.h, main/rtp.c: Merged
	  revisions 105932 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r105932 | russell | 2008-03-04 19:52:18 -0600 (Tue, 04 Mar 2008)
	  | 5 lines Fix a bug that I just noticed in the RTP code. The
	  calculation for setting the len field in an ast_frame of audio
	  was wrong when G.722 is in use. The len field represents the
	  number of ms of audio that the frame contains. It would have set
	  the value to be twice what it should be. ........

	* funcs/func_global.c: Fix the SHARED() read callback to properly
	  unlock the channel. This function could not have worked, as it
	  left the channel locked in all cases.

2008-03-04 23:24 +0000 [r105864]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c: There are several places in manager.c where
	  BUFSIZ is used for a buffer which will contain nowhere near that
	  amount of data. This makes these buffers more reasonably sized.

2008-03-04 23:10 +0000 [r105840-105841]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_zap.c, channels/console_gui.c, apps/app_queue.c,
	  main/asterisk.c: Fix minor misuses of snprintf

	* main/frame.c, main/say.c, main/utils.c, main/astobj2.c,
	  main/enum.c, main/fskmodem.c, main/config.c, main/poll.c,
	  main/loader.c, main/term.c, main/cli.c, main/channel.c,
	  main/dial.c, main/manager.c, main/tdd.c, main/strcompat.c,
	  main/features.c, main/logger.c, main/app.c, main/image.c,
	  main/dns.c, main/pbx.c, main/translate.c, main/jitterbuf.c,
	  main/rtp.c, main/netsock.c, main/cryptostub.c, main/callerid.c,
	  main/file.c, main/alaw.c, main/dlfcn.c, main/dsp.c: Whitespace
	  changes only

2008-03-04 22:28 +0000 [r105734-105804]  Russell Bryant <russell@digium.com>

	* main/tcptls.c, main/manager.c, channels/chan_sip.c, main/http.c,
	  include/asterisk/tcptls.h: add a destroy API call for a server
	  instance

	* main/tcptls.c, main/manager.c, channels/chan_sip.c, main/http.c,
	  include/asterisk/tcptls.h: More public API name changes to use an
	  appropriate ast_ prefix

	* include/asterisk/http.h, main/tcptls.c, main/manager.c,
	  channels/chan_sip.c, res/res_phoneprov.c, main/http.c,
	  include/asterisk/tcptls.h: Rename public object server_instance
	  to ast_tcptls_server_instance

	* channels/chan_sip.c: Fix some bugs in the SIP tcp helper thread.
	  - fix a spot where a lock wouldn't get unlocked in an error
	  condition - call ast_mutex_destroy() on the lock before freeing
	  its memory (related to issue #11972)

2008-03-04 20:32 +0000 [r105733]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c: Set username to default to the category name
	  if it isn't overridden by a usernmae= setting in users.conf

2008-03-04 18:11 +0000 [r105675-105677]  Joshua Colp <jcolp@digium.com>

	* /, main/rtp.c: Merged revisions 105676 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r105676 | file | 2008-03-04 14:10:34 -0400 (Tue, 04 Mar 2008) | 2
	  lines In addition to setting the marker bit let's change our ssrc
	  so they know for sure it is a different source. ........

	* /, channels/chan_sip.c, include/asterisk/rtp.h, main/rtp.c:
	  Merged revisions 105674 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r105674 | file | 2008-03-04 14:05:28 -0400 (Tue, 04 Mar 2008) | 8
	  lines When a new source of audio comes in (such as music on hold)
	  make sure the marker bit gets set. (closes issue #10355) Reported
	  by: wdecarne Patches: 10355.diff uploaded by file (license 11)
	  (closes issue #11491) Reported by: kanderson ........

2008-03-04 16:55 +0000 [r105595-105597]  Russell Bryant <russell@digium.com>

	* CHANGES: Update CHANGES heading

	* funcs/func_version.c: Simplify a trivial snprintf() with
	  ast_copy_string()

-----
    * Changes above include everything done for 1.6.1 since 1.6.0 was branched
	  off.
